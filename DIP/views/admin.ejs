<!DOCTYPE html>
<html lang="es">
<%- include ("partes/cabecera") %>

<script>
  function añadirNucleo(input) {
      let inputEjemplar = $(input);
    let id = inputEjemplar.attr('id');

    let tb= "table#tb"+id;;
      if (inputEjemplar.val() >= 1) {
        $(tb).html("");
        for (var i = 1; i <= inputEjemplar.val(); i++) {
          $(tb).append(`
          <tr>
                        <td style="width: 30px; overflow: hidden; border: none;">
                          <input id="${id+i}" name="${id+i}" type="number"  class="material-control material-control-login" 
                            placeholder="${id}.${i}" required="" maxlength="4" data-toggle="tooltip" data-placement="top"
                             value="${i}" redonly>
                          <span class="highlight"></span>
                          <span class="bar"></span>
                          <label> </label>
                        </td>
                        <td style="width: 150px; overflow: hidden; border: none;">
                          <input id="${id}-${i}"  name="${id}_${i}" type="text"
                          class="material-control material-control-login" onkeyup="comp(this)" placeholder="Escribe aquí el ${id}"
                            required="" maxlength="100"
                            pattern="(^([a-zA-Zá-ú]{1,})$)"
                            data-toggle="tooltip" data-placement="top" >
                          <span class="highlight"></span>
                          <span class="bar"></span>
                          <label> </label>
    
                        </td>
                        <td id="imgs-${id}${i}" style="width: 20px; overflow: hidden; border: none;">
                          <div  class="limpiar" id="img-${id}-${i}"></div>
                        </td>
                      </tr>
                      <tr>
                        <td style="width: 30px; overflow: hidden; border: none;"></td>
                        <td id="mensaje-${id}${i}" style="width: 150px; border: none; overflow: hidden;">
                          <div class="limpiar" id="${id}-unica-${i}"></div>
                        </td>
                        <td style="width: 20px; border: none; overflow: hidden;"></td>
                      </tr>
                                
                    `);
          
        }
      } else {
        $(tb).html("");
        $(tb).append(`
        <tr>
                        <td style="width: 40px; overflow: hidden; border: none;">
                          <input id="${id}1" name="${id}1" type="number"  class="material-control material-control-login" 
                            placeholder="${id}.1" required="" maxlength="4" data-toggle="tooltip" data-placement="top"
                             value="1">
                          <span class="highlight"></span>
                          <span class="bar"></span>
                          <label> </label>
                        </td>
                        <td style="width: 150px; overflow: hidden; border: none;">
                          <input id="${id}-1"  name="${id}_1" type="text"
                          class="material-control material-control-login"  placeholder="Escribe aquí el ${id}" onkeyup="comp(this)"
                            required="" maxlength="100"
                            pattern="(^([a-zA-Zá-ú]{1,})$)"
                            data-toggle="tooltip" data-placement="top" >
                          <span class="highlight"></span>
                          <span class="bar"></span>
                          <label> </label>
    
                        </td>
                        <td id="imgs-${id}" style="width: 20px; overflow: hidden; border: none;">
                          <div  class="limpiar" id="img-${id}-1"></div>
                        </td>
                      </tr>
                      <tr>
                        <td style="width: 40px; overflow: hidden; border: none;"></td>
                        <td id="mensaje-${id}" style="width: 150px; border: none; overflow: hidden;">
                          <div class="limpiar" id="${id}-unica-1"></div>
                        </td>
                        <td style="width: 20px; border: none; overflow: hidden;"></td>
                      </tr>
    
                                
                    `);
      }
  }; 
  
      //funcion que comprueba que cada cota sea unica
  
  //comparar
  function comp(input) {
  let id=$(input).attr('id').split("-")[0];
    if ($(input).val()) {
      
      var cota1, cota2, cota, i, m;
      let bandera = 1;
     
      var elementos = document.getElementsByTagName('input');
  
      var tamaño = elementos.length;
    
      
      var elemento1;
      var matrizElementos = new Array();
  
      var matrizIndice = new Array();
  
      
      for (var j = 0; j < tamaño; j++) {
  
       cota1 = elementos[j].value.toLowerCase();
        cota2 = $(input).val().toLowerCase();
     
        let resl = elementos[j].getAttribute('id');
  
        if (resl) {
          elemento1 = elementos[j].getAttribute('id').charAt(0);
        
      
            if (elemento1 === 'n' && id==='nucleo') {
            
                 matrizIndice.push(elementos[j].getAttribute('id').split('-').pop());
            matrizElementos.push(elementos[j].value);
  
              } else if (elemento1 === 'c' && id==='categoria') {
       
                matrizIndice.push(elementos[j].getAttribute('id').split('-').pop());
            matrizElementos.push(elementos[j].value);
              }
           
  
            if (cota1 === cota2) {
              i = elementos[j].getAttribute('id').split('-').pop();
               cota = cota2;

            
             
  
            }
          
        }
      }
  
      var tamañoM = matrizElementos.length;
      for (var f = 0; f <= tamañoM; f++) {
        if (cota === matrizElementos[f] && i !== matrizIndice[f]) {
          bandera = 0;
        
          $(`div#img-${id}-${i}`).html(`<br>
               <img src="/assets/icons/notificacion-error.ico" width= "20" height= "20">
               <br>
               <br>`);
          $(`div#${id}-unica-${i}`).html(`Repetido con ${id} ${matrizIndice[f]}`);
    
        } 
      }

      if (bandera === 1) {

$.ajax({

  url: `/bibliotecario/${id}`,
  type: 'POST',
  data: { dato: cota2 }

})
  .done(function (res) {

    if (res === '') {

      $(`div#${id}-unica-${i}`).html('');
      $(`div#img-${id}-${i}`).html(`
    <img src="/assets/img/satisfactorio.png" width= "20" height= "20">
    `);
    } else {
      $(`div#${id}-unica-${i}`).html(`<p>${res}</p>`);
      $(`div#img-${id}-${i}`).html(`
    <img src="/assets/icons/notificacion-error.ico" width= "20" height= "20">`);
 
  }

  })
  .fail(function (error) {
    manejoErrores(error);
  });
};
  
   
    } else {
      let i =$(input).attr('id').split('-').pop();
      
      $(`div#img-${id}-${i}`).html('');
          $(`div#${id}-unica-${i}`).html('');
    }
    };
 
  </script>
  
<script>
var intervalId = false;
//animacion para la seccion de noticias

  var first = 0;
  var speed = 700;

  function removeFirst() {


    first = $('div#cuadronot li:first').html();
    console.log(first)
    $('div#cuadronot li:first')
      .animate({ opacity: 0 }, speed)
      .fadeOut('slow', function () {
        $(this).remove();
      });

    addLast(first);

  }
  function addLast(first) {

    last = '<li style="display:none;">' + first + '</li>';
    $('div#cuadronot').append(last);
    $('div#cuadronot li:last')
      .animate({ opacity: 1 }, speed)
      .fadeIn('slow')
  }



  //manejo de errores para todas las solicitudes ajax
  function manejoErrores(error) {
    let message;
    if (error.responseJSON) {
      if (error.responseJSON.message) {
        message = error.responseJSON.message

      }
    } else {
      message = 'Sin información'
    }

    let statusCode = error.status || 500;
    let statusText = '';
    switch (statusCode) {
      case 400:
        statusText = 'Bad Request';
        break;
      case 401:
        statusText = 'Unauthorized';
        break;
      case 403:
        statusText = 'Forbidden';
        break;
      case 500:
        statusText = 'Internal Server Error';
        break;
      case 200:
        statusText = 'OK';
        break;
    };
    if (statusCode == 500 || statusCode == 400) {
      $("div#modal-cuerpo").html(`<p class="text-center" style=" font-weight:bold; font-size:30px; "> <img src="/assets/icons/robot-error.ico"width= "180" height= "180" > ¡Error!</p>
 <br>
                
                <p class="text-center" style="font-size:20px; ">
                        ${statusText}   (Error: ${statusCode})
                        <br><p class="text-center" style="font-size:25px;"> ${message}</p> </p>`);
    } else if (statusCode == 403 || statusCode == 401) {
      $("div#modal-cuerpo").html(`<p class="text-center" style=" font-weight:bold; font-size:30px; "> <img src="/assets/icons/peligro.ico"width= "180" height= "180" ></p>
 <br>
                
                <p class="text-center" style="font-size:20px; ">
                        ${statusText}   (Error: ${statusCode})
                        <br><p class="text-center" style="font-size:25px;"> ${message}<button id="login" class="bnt btn-link" href="#">Logeate</button> </p></p>`);
    } else {
      $("div#modal-cuerpo").html(`<p class="text-center" style=" font-weight:bold; font-size:30px; ">!UPS¡ <img src="/assets/icons/robot-roto.ico"width= "180" height= "180" ></p>
      <br>
                
                <p class="text-center" style="font-size:20px; ">
                       Recurso no encontrado  (Error: 404) </p>`);
    }
    $("div#myModal").modal("hide");
    $("div#myModalError").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
    });

  };


</script>
          
<script>
  
 
    function verPDF(input) {
      
    let ext = $(input).attr("data_url").split(".").pop();
    let url2 = $(input).attr("data_url");
   
    if (ext === 'pdf') {
       let url = "/lib/web/viewer.html?file=" + $(input).attr("data_url") + "#zoom=50";
    let titulo = $(input).attr("data_titulo");
    $('#myModalLabel').text(titulo);
    $('#pdfdoc').attr('src', url);
    $('#myModal5').modal("show");
    } else {
     
     $("#myModal4").modal("hide");
    $("#imagenC").attr('src', url2);
    $("#imagenC").attr('data-original', url2);
    $("#myModal8").modal("show");
    }
   
  };


  //funcion consulta de nucleos
  function nucleos(input) {
    let id=`#${input} option`;
    let id2=`#${input}`;
    let contenido = $(id).length;
   
           if (contenido<=1) {
 $.ajax({
          beforeSend: function () {
           $("#img-cargando2").attr("src", "/assets/gif/loading-22.gif");
           $("#img-cargando2").attr("width", 20);
           $("#imga-cargando2").attr("height", 20);
         
           
          },
          url: "/bibliotecario/nucleos",
          type: "GET",
        })
          .done(function (nucleos) {
            $("#img-cargando2").attr("src", "");
           $("#img-cargando2").attr("width", "");
           $("#imga-cargando2").attr("height", "");
           $(id2).html('');
           $(id2).append('<option disabled="" selected="">Selecciona un núcleo</option>');
           for (var i=0; i<nucleos.nucleos.length; i++) {
              $(id2).append(`<option>${nucleos.nucleos[i].nucleo}</option>`);
           }
          
          })
          .fail(function (error) {
            manejoErrores(error);
          });
    

           }
   
  }

  //funcion para la consulta de categorias
  function categorias(input) {
    let id=`#${input} option`;
    let id2=`#${input}`;
    let contenido = $(id).length;
    if (contenido<=1 ) {
       $.ajax({
          beforeSend: function () {
           $("#img-cargando").attr("src", "/assets/gif/loading-22.gif");
           $("#img-cargando").attr("width", 20);
           $("#imga-cargando").attr("height", 20);
         
           
          },
          url: "/categorias",
          type: "GET",
        })
          .done(function (categorias) {
            $("#img-cargando").attr("src", "");
           $("#img-cargando").attr("width", "");
           $("#imga-cargando").attr("height", "");
           $(id2).html('');
           $(id2).append('<option disabled="" selected="">Selecciona una categoría</option>');
           for (var i=0; i<categorias.categorias.length; i++) {
              $(id2).append(`<option>${categorias.categorias[i].categoria}</option>`);
           }
          
          })
          .fail(function (error) {
            manejoErrores(error);
          });
    
    }
   

  }
  function formatoC(id1, id2) {
    $(id1).html("");
    $(id2).html(
      `<img src="/assets/img/satisfactorio.png" width= "20" height= "20">`
    );
  }
  function formatoI(id1, id2) {
    $(id1).html(`<p>Debe ser formato pdf</p>`);
    $(id2).html(
      `<img src="/assets/icons/notificacion-error.ico" width= "20" height= "20">`
    );
  }
  function comprobarF(archivo) {
    var i = $(archivo).attr("id").split("-").pop();
    var ext = $(archivo).val().split(".").pop().toLowerCase();

    var id1 = "p#formato-pdf-" + i;
    var id2 = "td#img-pdf-" + i;
    if ($(archivo).val() != "") {
      if (ext === "pdf") {
        formatoC(id1, id2);
      } else {
        formatoI(id1, id2);
      }
    }
  }

  function tipoTrabajo(trabajo) {
    if ($(trabajo).val().toLowerCase() === "trabajo de grado") {
      $("div#tutorD").html(`
         <input id="tutor" name="tutor" type="text" class="tooltips-general material-control" placeholder="Escribe aquí el tutor del libro" required="" pattern="[a-zA-Zá-ú ]{1,100}" maxlength="100" data-toggle="tooltip" data-placement="top" title="Escribe el nombre del tutor del libro">
                     <span class="highlight"></span>
                     <span class="bar"></span>
                     <label>Autor</label>`);
      $('div#editorialD').html('');
      $('div#volumenD').html('');
    } else if ($(trabajo).val().toLowerCase() === "revista") {
      $('div#autorD').html('');
      $('div#volumenD').html(`<input id="volumen" name="volumen" type="number" class="tooltips-general material-control"
              placeholder="Volumen" maxlength="50" pattern="^[0-9]+" min="1" data-toggle="tooltip"
              data-placement="top" title="Escribe el volumen del libro">
              <label >Volumen</label>`);
      $('div#editorialD').html(`<input id="editorial" name="editorial" type="text" class="material-control tooltips-general"
                    placeholder="Escribe aquí la editorial del libro" required="" pattern="[a-zA-Zá-ú ]{1,100}" maxlength="100"
                    data-toggle="tooltip" data-placement="top" title="Editorial del libro">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Editorial</label>`);
    } else {
      $("div#tutorD").html("");
      $('div#volumenD').html(`<input id="volumen" name="volumen" type="number" class="tooltips-general material-control"
              placeholder="Volumen" maxlength="50" pattern="^[0-9]+" min="1" data-toggle="tooltip"
              data-placement="top" title="Escribe el volumen del libro">
              <label >Volumen</label>`);
      $('div#autorD').html(`<input  name="autor" type="text" class="tooltips-general material-control"
                    placeholder="Escribe aquí el autor del libro" required="" pattern="[a-zA-Zá-ú ]{1,100}" maxlength="100"
                    data-toggle="tooltip" data-placement="top" title="Escribe el nombre del autor del libro">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Autor</label>`);
      $('div#editorialD').html(`<input id="editorial" name="editorial" type="text" class="material-control tooltips-general"
                    placeholder="Escribe aquí la editorial del libro" required="" pattern="[a-zA-Zá-ú ]{1,100}" maxlength="100"
                    data-toggle="tooltip" data-placement="top" title="Editorial del libro">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Editorial</label>`);
    }
  }

  function sobresaltarFecha(res, i) {
    let fechaActual = new Date();
    let fecha_d = res.fichas[i].fecha_d;
    let dia = fecha_d.split('-')[2];
    let mes = fecha_d.split('-')[1] - 1;
    let año = fecha_d.split('-')[0];
    let fecha_devolucion = new Date(año, mes, dia);
 
    let resultado = fechaActual.getTime() > fecha_devolucion.getTime();
    let r = fechaActual.getDay() === fecha_devolucion.getDay();

    if (resultado && !r) {
      let q = "#fecha-d" + res.fichas[i].cota_f;
      $(q).css({ 'color': 'red' });
    }
  };

  function mostrarCampo(check) {
    if (check.checked) {
      $("tr#tr-pdf-1").hide();
      $("tr#tr2-pdf-1").hide();
      $("#pdf-1").removeAttr("required");
    } else {
      $("tr#tr-pdf-1").show();
      $("tr#tr2-pdf-1").show();
      $("#pdf-1").attr("required");

    }
  }

  function mostrarCampo2(check) {
    if (check.checked) {
      $("tr#tr-pdf-1").hide();
      $("tr#tr2-pdf-1").hide();
      $("#pdf-2").removeAttr("required");
    } else {
      $("tr#tr-pdf-1").show();
      $("tr#tr2-pdf-1").show();
      $("#pdf-2").attr("required");

    }
  }

  function añadirC(campo, divImg) {
    $("div#pdfs").append(campo);
    $("div#pdfs").append(`<div class="col-md-2" id="imgs-pdfs"></div>`);
    $("td#imgs-pdfs").append(divImg);
  }

  function removerC(id, id1) {
    $(id).remove();
    $(id1).remove();
  }
  function añadirArchivo(input) {
    var i = $(input).attr("id").split("-").pop();
    var idd = "td#td-pdf-" + i;
    var id2 = "div#img-pdf-" + i;

    if (input.checked) {
      var cambio = `
                 <div class="col-md-10" id="div-pdf-${i}">
                 <input onchange="comprobarF(this)" id="pdf-${i}" type="file" name="pdf-${i}" class="tooltips-general material-control" data-toggle="tooltip" data-placement="top" title="Archivo PDF ${i}">
                        
                        <span class="highlight"></span>
                        <span class="bar"></span>
                        <label>Archivo PDF ${i}</label>
                         <p class="text-center" id="formato-pdf-${i}"> </p>
                 </div>`;
      var camp = `
                 <div  id="img-pdf-${i}"></div>`;
      añadirC(cambio, camp);
    } else {
      removerC(idd, id2);
    }
  }

  function ejemplares() {
    let inputEjemplar = $("input#ejemplar");
    if (inputEjemplar.val() >= 1) {
      $("table#tb").html("");
      $("div#img-cota-1").html("");
      $("div#incluye-pdf").html("");
      $("div#no-incluye-pdf").html("");
      for (var i = 1; i <= inputEjemplar.val(); i++) {
        $("table#tb").append(`
                  <tr>
                                 <td style="width: 30px; overflow: hidden;">
                                  <input  id="ejemplar${i}" name="ejemplar${i}" type="number" class="tooltips-general material-control" placeholder="Ej.${i}" required="" maxlength="4" data-toggle="tooltip" data-placement="top" title="Numero de ejemplar" value="${i}">
                                  <span class="highlight"></span>
                                  <span class="bar"></span>
                                  <label>ejemplar</label>
                                
                                 </td>
                                 <td style="width: 200px; overflow: hidden;">
                                  <input  id="cota-${i}" onkeyup="añadirCampoPdf(this)"  name="cota_${i}" type="text" class="tooltips-general material-control" placeholder="Escribe aquí la cota del libro" required="" maxlength="25" pattern="^([a-zA-Zá-ú0-9]{1,})(_)?([a-zA-Zá-ú0-9]{1,})$|([a-zA-Zá-ú0-9]{1,})$" data-toggle="tooltip" data-placement="top" title="La cota del libro">
                                  <span class="highlight"></span>
                                  <span class="bar"></span>
                                  <label>Cota</label>
                                  
                                 </td>
                                 <td id="imgs-cota" style="width: 20px; overflow: hidden;">
                                  <div id="img-cota-${i}"></div>
                                 </td>
                              </tr>
                              <tr>
                              <td style="width: 30px; overflow: hidden;"></td>
                              <td id="mensaje-cota" style="width: 200px; overflow: hidden;"><div  id="cota-unica-${i}" ></div></td>
                              <td style="width: 20px; overflow: hidden;"></td>
                              </tr>
                              
                  `);
        if (i < inputEjemplar.val()) {
          $("div#incluye-pdf").append(`
                        <br>
                         <input  onchange="añadirArchivo(this)"   id="incluye-pdf-${i}" type="checkbox" name="incluye-pdf-${i}" value="${i}" class="tooltips-general" title="Incluye PDF el Ej. ${i}" >PDF Ej.${i}
                       <br>
                         `);
        } else {
          $("div#incluye-pdf").append(`
                        <br>
                         <input class="tooltips-general"  onchange="añadirArchivo(this)"  title="Incluye PDF el Ej.${i}" id="incluye-pdf-${i}" type="checkbox" name="incluye-pdf-${i}" value="${i}" >PDF Ej.${i}
                         `);
        }
      }
    } else {
      $("table#tb").html("");
      $("div#img-cota-1").html("");
      $("div#incluye-pdf").html("");
      $("div#no-incluye-pdf").html("");
      $("table#tb").append(`
                  <tr>
                                 <td style="width: 30px; overflow: hidden;">
                                  <input  id="ejemplar1" name="ejemplar1" type="number" class="tooltips-general material-control" placeholder="Ej.1" required="" maxlength="4" data-toggle="tooltip" data-placement="top" title="Numero de ejemplar" value="1">
                                  <span class="highlight"></span>
                                  <span class="bar"></span>
                                  <label>ejemplar</label>
                                
                                 </td>
                                 <td style="width: 200px; overflow: hidden;">
                                  <input  id="cota-1" onchange="añadirCampoPdf(this)"  name="cota_1" type="text" class="tooltips-general material-control" placeholder="Escribe aquí la cota del libro" required="" maxlength="25" pattern="^([a-zA-Zá-ú0-9]{1,})(_)?([a-zA-Zá-ú0-9]{1,})$"  data-toggle="tooltip" data-placement="top" title="La cota del libro">
                                  <span class="highlight"></span>
                                  <span class="bar"></span>
                                  <label>Cota</label>
                                  
                                 </td>
                                 <td id="imgs-cota" style="width: 20px; overflow: hidden;">
                                  <div id="img-cota-1"></div>
                                 </td>
                              </tr>
                              <tr>
                              <td style="width: 30px; overflow: hidden;"></td>
                              <td id="mensaje-cota" style="width: 200px; overflow: hidden;"><div  id="cota-unica-1" ></div></td>
                              <td style="width: 20px; overflow: hidden;"></td>
                              </tr>
                              
                  `);
    }
  };
  function showModal() {
    document.getElementById('openModal').style.display = 'block';
  };

  function CloseModal() {
    document.getElementById('openModal').style.display = 'none';
  };
  function min(f) {

        let mes, dia;
      f = new Date(f);
        if ((f.getMonth() + 1) < 10) {
            let  m = f.getMonth() + 1;
             mes = "0" + m ;
        } else if ((f.getMonth() + 1) >= 10) {
            mes = f.getMonth() + 1; 
        }
        if (f.getDate() < 10) {
            let d = f.getDate();
             dia = "0" + d;
        } else if (f.getDate() >= 10) {
            dia = f.getDate();
        }
        return f.getFullYear() + "-" + mes + "-" + dia;
    };

function maxima() {

let mes, dia;
f = new Date();
if ((f.getMonth() + 1) < 10) {
    let  m = f.getMonth() + 1;
     mes = "0" + m ;
} else if ((f.getMonth() + 1) >= 10) {
    mes = f.getMonth() + 1; 
}
if (f.getDate() < 10) {
    let d = f.getDate();
     dia = "0" + d;
} else if (f.getDate() >= 10) {
    dia = f.getDate();
}
return f.getFullYear() + "-" + mes + "-" + dia;
};


  function resetear() {

    $("td#mensaje-cota").html("");
    $("div#estatus").html("");
    $("td#img-pdf-1").html("");
    $("td#imgs-cota").html("");
    $("p#formato-pdf-1").html("");
    $("div#mensaje").html("");
    $("tr#tr2-pdf-1").html("");

    $("button#guardar").html(`<div id="estatus">
                 <i class="zmdi zmdi-floppy"></i>
                    </div> <p id="boton">&nbsp;&nbsp; Guardar</p>`);


    $("table#tb").html("");
    $("table#tb").append(`
                    <tr>
                                   <td style="width: 30px; overflow: hidden;">
                                    <input  id="ejemplar1" name="ejemplar1" type="number" class="tooltips-general material-control" placeholder="Ej.1" required="" maxlength="4" data-toggle="tooltip" data-placement="top" title="Numero de ejemplar" value="1">
                                    <span class="highlight"></span>
                                    <span class="bar"></span>
                                    <label>ejemplar</label>
                                  
                                   </td>
                                   <td style="width: 200px; overflow: hidden;">
                                    <input  id="cota-1"   name="cota_1" type="text" class="tooltips-general material-control" placeholder="Escribe aquí la cota del libro" required="" maxlength="25" data-toggle="tooltip" data-placement="top" title="La cota del libro">
                                    <span class="highlight"></span>
                                    <span class="bar"></span>
                                    <label>Cota</label>
                                    
                                   </td>
                                   <td id="imgs-cota" style="width: 20px; overflow: hidden;">
                                    <div id="img-cota-1"></div>
                                   </td>
                                </tr>
                                <tr>
                                <td style="width: 30px; overflow: hidden;"></td>
                                <td id="mensaje-cota" style="width: 200px; overflow: hidden;"><div  id="cota-unica-1" ></div></td>
                                <td style="width: 20px; overflow: hidden;"></td>
                                </tr>
                                
                    `);


    document.getElementById("suscription").focus({ preventScroll: true });
    document.getElementById("reset").click();

    let isChecked = document.getElementById("mostrar_1").checked;
    if (isChecked) {
      document.getElementById("mostrar_1").click();
    }



  };
  $(function () {
    let formato = $("form#formato");

    let inputEjemplar1 = $("input#ejemplar1");
    let divEjemplares = $("div#ejemplares");
    let divCotas = $("div#cotas");
    let divRow = $("div#row");
    let divImgs = $("div#imgs-cota");
    formato.on("submit", function (e) {
      e.preventDefault();
      let data = new FormData(this);

      var isChecked = document.getElementById("mostrar_1").checked;

      if (isChecked && data.has("pdf")) {
        data.delete("pdf");
      }
      if (data.date) {
        var date = min(data.date);
        data.delete("date");
        data.push(date);
      }
    /*  
      var metadata=$(this).serializeArray()
    .reduce(function(a, z) { a[z.name] = z.value;
       return a;
       }, {});
      
     var dataJson={metadata};  
     var dataXml = json2xml(dataJson);
     console.log(dataXml);
    */

      $.ajax({
        beforeSend: function () {
          $("div#estatus").html(
            '<p class="text-center"><img src="/assets/gif/loading-22.gif"width= "20" height= "20"></p>'
          );
          $("p#boton").html("Guardando...");
        },
        url: "/bibliotecario/insert",
        type: "POST",
        data: data,
        processData: false,
        contentType: false,
      })
        .done(function (res) {
          $("div#estatus").html(
            `<img src="/assets/icons/correcto.ico"width= "20" height= "20">`
          );
          $("div#mensaje").html(`<p class="text-center">${res}</p>`);
          $("p#boton").html("Se ha guardado");
          setTimeout(resetear, 3000);
          $("p#mensaje-final").html(`${res}`);
          showModal();
        })
        .fail(function (error) {
          resetear();
          manejoErrores(error);
        });
    });

  });

  //funcion que comprueba que cada cota sea unica
  function añadirCampoPdf(input) {
    var bandera = 1;
    var cota1, cota2, cota, i, m;


    var elementos = document.getElementsByTagName('input');

    var tamaño = elementos.length;

    var elemento1;
    var matrizElementos = new Array();

    var matrizIndice = new Array();

    for (var j = 0; j < tamaño; j++) {

      cota1 = elementos[j].value;
      cota2 = $(input).val();
      let resl = elementos[j].getAttribute('id');

      if (resl) {
        elemento1 = elementos[j].getAttribute('id').charAt(0);
        if (elemento1 === 'c') {

          matrizIndice.push(elementos[j].getAttribute('id').split('-').pop());
          matrizElementos.push(elementos[j].value);


          if (cota1 === cota2) {
            i = elementos[j].getAttribute('id').split('-').pop();

            cota = cota2;

          }
        }
      }
    }

    var tamañoM = matrizElementos.length;
    for (var f = 0; f <= tamañoM; f++) {
      if (cota === matrizElementos[f] && i !== matrizIndice[f]) {
        bandera = 0;
        $(`div#img-cota-${i}`).html(`<br>
             <img src="/assets/icons/notificacion-error.ico" width= "20" height= "20">
             <br>
             <br>`);
        $(`div#cota-unica-${i}`).html(`Cota repetida con el ejemplar ${matrizIndice[f]}`);
      }
    }

    if (bandera === 1) {

      $.ajax({

        url: '/bibliotecario/ec',
        type: 'POST',
        data: { cota: cota }

      })
        .done(function (res) {

          if (res === '') {

            $(`div#cota-unica-${i}`).html('');
            $(`div#img-cota-${i}`).html(`
          <img src="/assets/img/satisfactorio.png" width= "20" height= "20">
          `);
          } else {
            $(`div#cota-unica-${i}`).html(`<p>${res}</p>`);
            $(`div#img-cota-${i}`).html(`
          <img src="/assets/icons/notificacion-error.ico" width= "20" height= "20">`);
          }

        })
        .fail(function (error) {
          manejoErrores(error);
        });
    };
  };
  //--------------------------------------------------------------------
  function añadirAtt(query) {
    $(query).attr("disabled", true);
  };

  function ver(input) {

    let cota = $(input).attr("id").split('-').pop();
    $.ajax({
      beforeSend: function () {
        $("div#cargando").html(
          '<p class="text-center"><img src="/assets/gif/loading-22.gif"width= "20" height= "20"></p>'
        );

      },
      url: `/ver_libro?cota=${cota}`,
      type: 'POST'

    })
      .done(function (libro, url) {

        $("div#cargando").html('');
        $("div#modal-body-4").html('');
        $("div#tutor").html('');
        $("#myLabel").html('');
        $("div#modal-body-4").append(`
        <form  autocomplete="off" enctype="multipart/form-data" id="actualizar">
                          
                          <div class="container-flat-form">
                             
                              <div class="title-flat-form title-flat-blue">Ver/Editar</div>
                              <div class="row">
                                 
                                  <div class="col-xs-12 col-sm-8 col-sm-offset-2">
                                      <legend><strong>Información básica</strong></legend><br>
                                      <div class="group-material">
                  <span>Categoría de suscripción</span>
                  <select name="suscription" required=""
                    class="tooltips-general material-control" data-toggle="tooltip" data-placement="top"
                    title="Categoría del libro">
                    <option disabled=""  selected="">${libro.libro[0].tipo_s}</option>
                    <option>Basica</option>
                    <option>Estandar</option>
                    <option>Premium</option>

                  </select>
                </div> 
               
                <div class="group-material">
                 
                  <span>Categoría del contenido</span><img id="img-cargando"  >
                  <select  id="type2" onclick="categorias('type2')" name="type" required=""
                    class="tooltips-general material-control" data-toggle="tooltip" data-placement="top"
                    title="Elige la categoria">
                    <option disabled="" selected="">${libro.libro[0].type}</option>

                  </select>
             
                </div>
                <div class="group-material">
                  <span>Núcleo al que pertenece</span><img id="img-cargando2" >
                  <select  id="core2" onclick="nucleos('core2')" name="core" required=""
                    class="tooltips-general material-control" data-toggle="tooltip" data-placement="top"
                    title="Elige el nucleo">
                    <option disabled="" selected="">${libro.libro[0].core}</option>

                  </select>
                </div>
                <div class="group-material">
                  <span>Cota</span>
                      <input id="cota" onchange="añadirCampoPdf(this)" name="cota" type="text"
                        class="tooltips-general material-control" placeholder="Cota del libro"
                        required="" maxlength="25"
                        value="${libro.libro[0].cota}"
                        data-toggle="tooltip" data-placement="top" readonly>
                      <span class="highlight"></span>
                      <span class="bar"></span>
                      <label>Cota</label>
                  </div>
                   

                <div class="group-material">
                  <span>Título</span>
                  <input id="title" name="title" type="text" class="tooltips-general material-control"
                    placeholder="Título" required="" pattern="[a-zA-Zá-ú ]{1,200}" value="${libro.libro[0].title}"
                    maxlength="200" data-toggle="tooltip" data-placement="top"
                    title="Título">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Título</label>
                </div>
                <div class="group-material" id="autorD">
                  <span>Autor</span>
                  <input name="creator" type="text" id="creator" class="tooltips-general material-control"
                    placeholder="Autor" required="" pattern="[a-zA-Zá-ú ]{1,100}" value="${libro.libro[0].creator}"
                    maxlength="100" data-toggle="tooltip" data-placement="top"
                    title="Autor">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Autor</label>
                </div>
                <div  class="group-material">
                  <span>Colaboradores</span>
                  <input name="contributor" type="text" id="contributor" class="tooltips-general material-control"
                  placeholder="Escribe aquí el nombre de colaboradores" required="" pattern="[a-zA-Zá-ú ]{1,100}" value="${libro.libro[0].contributor}"
                  maxlength="100" data-toggle="tooltip" data-placement="top"
                  title="Colaboradores">
                <span class="highlight"></span>
                <span class="bar"></span>
                <label>Colaborador</label>
                </div>
                
                <div class="group-material">
                  <span>Fecha de publicación</span>
                  <input id="date" name="date" type="date" value="${libro.libro[0].date}"class="material-control tooltips-general"
                     required=""   data-toggle="tooltip" data-placement="top" title="Fecha de publicación" >
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Fecha</label>
                </div>
                <div class="group-material" id="editorialD">
                  <span>Editorial</span>
                  <input id="publisher" name="publisher" type="text" class="material-control tooltips-general" value="${libro.libro[0].publisher}"
                    placeholder="Editorial del libro" required="" pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Editorial del libro">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Editorial</label>
                </div>
                <div class="group-material" >
                  <span>Fuente del material</span>
                  <input id="source" name="source" type="text" class="material-control tooltips-general" value="${libro.libro[0].source}"
                    placeholder="Fuente del material" required="" pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Fuente del material">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Fuente</label>
                </div>
                <div class="group-material" >
                  <span>Lenguaje</span>
                  <input id="language" name="language" type="text" class="material-control tooltips-general" value="${libro.libro[0].language}"
                    placeholder="Lenguaje del material" required="" pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Lenguaje del material">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Lenguaje</label>
                </div>
                <div class="group-material" >
                  <span>Ámbito del contenido</span>
                  <input id="coverage" name="coverage" type="text" class="material-control tooltips-general" value="${libro.libro[0].coverage}"
                    placeholder="Ámbito del contenido" required="" pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Ámbito del contenido">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Ámbito del contenido</label>
                </div>
                <div class="group-material" >
                  <span>Recurso relacionado</span>
                  <input id="relation" name="relation" type="text" class="material-control tooltips-general" value="${libro.libro[0].relation}"
                    placeholder="Referencia a un recurso relacionado" required="" pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Referencia a otro recurso">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Referencia</label>
                </div>
                <div class="group-material" >
                  <span>Palabras relacionadas</span>
                  <input id="subject" name="subject" type="text" class="material-control tooltips-general" value="${libro.libro[0].subject}"
                    placeholder="Palabras relaionadas" required="" pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Palabras relacionadas">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Palabras relacionadas</label>
                </div>
                <div class="group-material" >
                  <span>Descripción</span>
                  <textarea id="description" name="description" type="text" class="tooltips-general material-control form-control rounded-0" 
                  placeholder="Descripción del recurso" required="" pattern="[a-zA-Zá-ú ]{1,100}"
                  maxlength="100" data-toggle="tooltip" data-placement="top" title="Descripción del material"
                  style="border-color: rgb(0, 0, 255);"  min="20"  cols="86" rows="3" wrap="hard" spellcheck="true">${libro.libro[0].description}</textarea>                
                   <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Descripción del material</label>
                </div> 
                <div class="group-material" >
                  <span>Derechos del material</span>
                  <input id="rights" name="rights" type="text" class="material-control tooltips-general"
                    placeholder="Derechos" required="" pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" value="${libro.libro[0].rights}" data-placement="top" title="Derechos del material">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Derechos del material</label>
                </div>
                <div class="group-material" >
                  <span>Derechos del material</span>
                  <input id="statusBook" name="statusBook" type="text" class="material-control tooltips-general"
                    placeholder="Derechos" required="" pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" value="${libro.libro[0].statusBook}" data-placement="top" title="Disponiobilidad" readonly>
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Derechos del material</label>
                </div>
                                                
                                      <p class="text-center"> <a onclick="verPDF(this)" role="button" class="btn btn-large btn-primary"  style="background:rgb(45, 101, 206);" id="a${libro.libro[0].cota}" data_url="${libro.libro[0].url}" data_titulo=${libro.libro[0].title}">Ver Pdf del libro </a></p>
                           
                       <table class="table table-responsive " style="table-layout: fixed; border: none;" id="table-pdf" >      
                 <tr id="tr-pdf-1" style="border: none;">
                    <td  style="width: 80%;  border: none;" >
                        <input onchange="comprobarF(this)" id="pdf-2" name="pdf" type="file" required="" class="material-control tooltips-general" data-toggle="tooltip" data-placement="top" title="Archivo PDF">
                                <span class="highlight"></span>
                                <span class="bar"></span>
                                <label >Archivo PDF</label>

                    </td>
                    <td  style="width: 30%;  border: none;" id="img-pdf-1">

                    </td>
                </tr>
                <tr id="tr2-pdf-1">
                    <td style="width: 80%; border: none;"><p class="text-center" id="formato-pdf-1"></p></td>
                    <td style="width: 30%;  border: none;">
                    </td>
                </tr>
                      </table>
                   
                                  <div  class="group-material" >
                                     <p class="text-center"> <input onchange="mostrarCampo2(this)" id="mostrar" name="mostrar" type="checkbox"  value="1" class="tooltips-general" title="Incluye PDF">Mantener archivo ${libro.libro[0].format}</p>
                                  </div>
                                      
                                      <p class="text-center">
                                          
                              <button id="guardar"  type="submit" class="btn btn-primary" ><div id="estatus"><i class="zmdi zmdi-floppy"></i></div> <p id="boton">&nbsp;&nbsp; Guardar</p> </button>
                                          
                                         <div id="mensaje"></div>
                                     </p>
                                  
                                  </div>
                                  
                              </div>
                              
                          </div>
                      </form>
                      
        `);

        if (libro.libro[0].format !== 'pdf') {

          let q = "a#a" + libro.libro[0].cota;
          añadirAtt(q);
        }

        if (libro.libro[0].tipo_l === 'trabajo de grado') {
          $("div#tutor").append(`
           <input id="tutor" name="tutor_t" type="text" class="tooltips-general material-control" placeholder="Tutor del libro" required="" pattern="[Áa-z- -ñ]{1,}" maxlength="70" value="${libro.libro[0].tutor}" data-toggle="tooltip" data-placement="top" title="Escribe el nombre del tutor del libro">
                       <span class="highlight"></span>
                       <span class="bar"></span>
                       <label>Autor</label>`);
        };
        $("div#myModal4").modal('show');
        //  window.open('/hola','_target');

      })
      .fail(function (error) {
        $("div#cargando").html(
          `<img src="/assets/icons/notificacion-error.ico"width= "20" height= "20">`
        );
      });
  };


  function removerCampo(campo) {
    $(campo).remove();
  };
  function eliminarLibro(input) {
    let r = confirm('¿Estas seguro que deseas eliminar este libro?');
    if (r) {
      let cota = $(input).attr("id");
      let c = "div#" + cota + 0;
      $.ajax({
        beforeSend: function () {
          $("div#cargando").html(
            '<p class="text-center"><img src="/assets/gif/loading-22.gif"width= "20" height= "20"></p>'
          );
          $("p#modal-p-center").html(
            '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
          );
          $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });

        },
        url: `/bibliotecario/eliminar_libro?cota=${cota}`,
        type: 'DELETE'
      })
        .done(function (librosEliminados) {
          $("#myModal").modal("hide");
          $("#modal-body-3").html(`<p class="text-center">Se ha eliminado ${librosEliminados.librosEliminados} libros</p>`);
          $("#myModal3").modal("show");
          
          $("div#cargando").html('');
          removerCampo(c);
          $("div#cargando").html(`<h3 class="text-center">Se ha eliminado ${librosEliminados.librosEliminados} libro</h>`);
          let j = $("#container button").size();
          $("div#myModal3").on("hidden.bs.modal", function () {

            if (j === 0) {
              $("div#container").html('');
              $("div#cargando").html(`<h3 class="text-center">No hay resultados para mostrar</h3>`);

            }
          });

        })
        .fail(function (error) {
          $("div#cargando").html(
            `<p class="text-center"><img src="/assets/icons/robot.ico"width= "20" height= "20">Ha ocurrido un error</p>`
          );
          manejoErrores(error);
        });
    };
  };
  function añadirTutor(input) {
    if ($(input).val() === 'Trabajo de grado') {

      $('div#div-contenedor').show();
    } else {
      $('div#div-contenedor').hide();

    }
  };
 
 //funcion conversion de xml a json
function parseXml(xml) {
   var dom = null;
   if (window.DOMParser) {
      try { 
         dom = (new DOMParser()).parseFromString(xml, "text/xml"); 
      } 
      catch (e) { dom = null; }
   }
   else if (window.ActiveXObject) {
      try {
         dom = new ActiveXObject('Microsoft.XMLDOM');
         dom.async = false;
         if (!dom.loadXML(xml)) // parse error ..

            window.alert(dom.parseError.reason + dom.parseError.srcText);
      } 
      catch (e) { dom = null; }
   }
   else
      alert("cannot parse xml string!");
   return dom;
}
 //
 
  //Realiza una consulta completa de todos los libros
  function ocultarCampos(check) {
    var limpiarButton = document.getElementById("limpiarButton");
    limpiarButton.click();
    var isChecked = document.getElementById("ocultar").checked;
    if (isChecked) {
      $('form#formato-enlinea').hide();
      $.ajax({
        beforeSend: function () {
          $("div#cargando").html(
            '<p class="text-center"><img src="/assets/gif/loading-22.gif"width= "20" height= "20"></p>'
          );

        },
        url: '/todos-libros',
        type: 'POST'
      })
      .done(function (libros) {
          limpiarButton.click();
          let resultados = libros.libros.length;
          if (resultados > 0) {
            cargando.innerHTML = `<h3 class="text-center">Se obtuvieron ${resultados} resultados de tu busqueda</h3>`;
            container.innerHTML = ` 
              <h2 class="text-center all-tittles">Resultados</h2>
              <div class="table-responsive">
                  <div class="div-table" style="margin:0 !important;">
                      <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                        <div class="div-table-cell" style="width: 6%;">#</div>
                        <div class="div-table-cell" style="width: 10%;">Cota</div>
                        
                        <div class="div-table-cell" style="width: 8%;">Titulo</div>
                        
                        <div class="div-table-cell" style="width: 6%;">Ver/Editar</div>
                        <div class="div-table-cell" style="width: 6%;"> 
                        Eliminar</div>
                      </div>
              </div>`;


            for (var i = 0; i < libros.libros.length; i++) {

              container.insertAdjacentHTML('beforeend', `
          <div class="table-responsive" id="${libros.libros[i].cota}0">
                  <div class="div-table" style="margin:0 !important;">
                      <div class="div-table-row div-table-row-list">
                          <div  class="div-table-cell" style="width: 6%;">${i + 1}</div>
                          <div  class="div-table-cell" id="${libros.libros[i].cota}_cota" style="width: 10%;">${libros.libros[i].cota}</div>
                         
                          
                          <div class="div-table-cell" id="${libros.libros[i].cota}_titulo" style="width: 8%;">${libros.libros[i].title}</div>
                          
                         
                          <div class="div-table-cell" style="width: 6%;">
                              
                              <button class="btn btn-info"  id="id-${libros.libros[i].cota}" onclick="javascript:ver(this)" if ><i class="zmdi zmdi-file-text"></i></button>
                          
                          </div>
                          <div class="div-table-cell" style="width: 6%;">
                              
                            <button class="btn btn-danger" id="${libros.libros[i].cota}" onclick="javascript:eliminarLibro(this)"><i class="zmdi zmdi-delete"></i></button>
  
                           
                          </div>
                      </div>
                  </div>
              </div>`);


            }

            document.getElementsByTagName("button")[1].focus({ preventScroll: true });
          } else {
            cargando.innerHTML = '<h3 class="text-center">No se obtuvieron resultados</h3>';
            container.innerHTML = '';


          }
        })
        .fail(function (error) {
          limpiarButton.click();
          cargando.innerHTML = '<img src="/assets/icons/notificacion-error.ico"width= "20" height= "20">';
        });
  

    } else {

      $('form#formato-enlinea').show();
      $("div#container").html('');
      $("div#cargando").html('');
    }
  };
  function actualizarFormato(t, libro) {
    $(t).html(`${libro.title}`);
  }
  $(function () {
    
   

    $(document).on('click', '.modal', function () {
      $("button#login").on("click", function (e) {
        e.preventDefault();
        window.location = "/login"
      });
      $("form#noticiaEditada").on('submit', function (e) {

        e.preventDefault();
        var limpiarButton = document.getElementById("reset1");

        let data = new FormData(this);

        var isChecked = document.getElementById("mostrarImg").checked;
        if (isChecked && data.has("img-1")) {
          data.delete("img-1");
        }
        $.ajax({
          beforeSend: function () {
            $("p#modal-p-center").html(
              '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
            );
            $("div#myModal2").modal("hide");
            $("div#myModal").modal({
             backdrop: 'static',
             keyboard: false,
             show:true
            });
          },
          url: "/bibliotecario/editar-noticia",
          type: "POST",
          data: data,
          processData: false,
          contentType: false,
        })
          .done(function (res) {
            $("#myModal").modal("hide");
            if (res !== '') {
              limpiarButton.click();
              $("#modal-body-3").html(`<p class="text-center">${res}</p>`);
          $("#myModal3").modal("show");
       let bandera = 2;
              $("div#myModal3").on("hidden.bs.modal", function () {
                if (bandera == 2) {
                  bandera = 0;
                  mostrarNoticias();
                }
              });
            } else {
              manejoErrores(error);
            }

          })
          .fail(function (error) {
            manejoErrores(error);
          });

      });
      $("form#preguntaEditada").on('submit', function (e) {
        e.preventDefault();
        var limpiarButton = document.getElementById("reset4");

        let data = $(this).serialize();


        $.ajax({
          beforeSend: function () {
            $("p#modal-p-center").html(
              '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
            );
            $("div#myModal2").modal("hide");
            $("div#myModal").modal({
             backdrop: 'static',
             keyboard: false,
             show:true
            });
          },
          url: "/bibliotecario/editar-pregunta",
          type: "PUT",
          data: data,
        })
          .done(function (res) {
            $("#myModal").modal("hide");
            if (res !== '') {
              limpiarButton.click();
              $("#modal-body-3").html(`<p class="text-center">${res}</p>`);
          $("#myModal3").modal("show");
      
              let bandera = 1;
              $("div#myModal3").on("hidden.bs.modal", function () {
                if (bandera == 1) {
                  bandera = 0;
                  mostrarPreguntas();
                }

              });
            } else {
              manejoErrores(error);
            }

          })
          .fail(function (error) {
            manejoErrores(error);
          });

      });
      $("form#actualizar").on('submit', function (e) {
        e.preventDefault();
        var limpiarButton = document.getElementById("limpiarButton");

        let data = new FormData(this);

        var isChecked = document.getElementById("mostrar").checked;

        if (isChecked && data.has("pdf")) {
          data.delete("pdf");
        }
        if (data.date) {
        var date = min(data.date);
        data.delete("date");
        data.push(date);
      }
        $.ajax({
          beforeSend: function () {

            $("p#boton").html("Guardando...");
          },
          url: "/bibliotecario/actualizar",
          type: "POST",
          data: data,
          processData: false,
          contentType: false,
        })
          .done(function (res) {
            limpiarButton.click();
            $("div#estatus").html(
              `<img src="/assets/icons/correcto.ico"width= "20" height= "20">`
            );
            $("div#mensaje").html(`<p class="text-center">${res.mensaje}</p>`);
            $("p#boton").html("Se ha actualizado");
            let titulo = `div#${res.libro.cota}_titulo`;
            actualizarFormato(titulo,  res.libro);

            $("p#mensaje-final").html(`${res.mensaje}`);
            if (res.mensaje == "Actualizado con éxito") {

              $("div#myModal4")
                .modal("hide")
                .on('hidden.bs.modal', function (e) {
                  if (res.mensaje == "Actualizado con éxito") {
                    res.mensaje = '';
                    showModal();

                  }

                });

            }


          })
          .fail(function (error) {
            resetear();
            manejoErrores(error);
          });

      });
      $("form#editarC").on('submit', function (e) {
        e.preventDefault();
       let data = $(this).serialize();

        $.ajax({
          beforeSend: function () {
            $("p#modal-p-center").html(
              '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
            );
            $("div#myModal4").modal("hide");
            $("div#myModal").modal({
             backdrop: 'static',
             keyboard: false,
             show:true
            });
          },
          url: "/bibliotecario/actualizarCategoria",
          type: "PUT",
          data: data,
        })
          .done(function (res) {
            $("div#myModal").modal("hide");
            if (res === 'Actualizada con éxito') {
              $("#modal-body-3").html(`<p class="text-center">${res}</p>`);
          $("#myModal3").modal("show");
          editarCategorias();
            }
          })
          .fail(function (error) {
            manejoErrores(error);
          });
      })
    $("form#editarN").on('submit', function (e) {
        e.preventDefault();
       let data = $(this).serialize();

        $.ajax({
          beforeSend: function () {
            $("p#modal-p-center").html(
              '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
            );
            $("div#myModal4").modal("hide");
            $("div#myModal").modal({
             backdrop: 'static',
             keyboard: false,
             show:true
            });
          },
          url: "/bibliotecario/actualizarNucleo",
          type: "PUT",
          data: data,
        })
          .done(function (res) {
            $("div#myModal").modal("hide");
            if (res === 'Actualizada con éxito') {
              $("#modal-body-3").html(`<p class="text-center">${res}</p>`);
          $("#myModal3").modal("show");
          editarNucleos();
            }
          })
          .fail(function (error) {
            manejoErrores(error);
          });
      });
      $("form#editarS").on('submit', function (e) {
        e.preventDefault();
       let data = $(this).serialize();

        $.ajax({
          beforeSend: function () {
            $("p#modal-p-center").html(
              '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
            );
            $("div#myModal4").modal("hide");
            $("div#myModal").modal({
             backdrop: 'static',
             keyboard: false,
             show:true
            });
          },
          url: "/bibliotecario/actualizarSus",
          type: "PUT",
          data: data,
        })
          .done(function (res) {
            $("div#myModal").modal("hide");
            if (res === 'Actualizada con éxito') {
              $("#modal-body-3").html(`<p class="text-center">${res}</p>`);
          $("#myModal3").modal("show");
          editarSuscripiones();
            }
          })
          .fail(function (error) {
            manejoErrores(error);
          });
      })
  
      $("#type2").on("click", function (e) {
      categorias('type2');
    });
    $("#core2").on("click", function(e) {
      nucleos('core2');
     });
    });
    


    $('form#formato-enlinea').on("submit", function (e) {
      e.preventDefault();
      var limpiarButton = document.getElementById("limpiarButton");
      let data = $(this).serialize();

      $.ajax({
        beforeSend: function () {
          $("div#cargando").html(
            '<p class="text-center"><img src="/assets/gif/loading-22.gif"width= "20" height= "20"></p>'
          );

        },
        url: '/busqueda-especifica',
        type: 'POST',
        data: data
      })
        .done(function (libros) {
          limpiarButton.click();
          let resultados = libros.libros[0].length;
          if (resultados > 0) {
            cargando.innerHTML = `<h3 class="text-center">Se obtuvieron ${resultados} resultados de tu busqueda</h3>`;
            container.innerHTML = ` 
              <h2 class="text-center all-tittles">Resultados</h2>
              <div class="table-responsive">
                  <div class="div-table" style="margin:0 !important;">
                      <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                        <div class="div-table-cell" style="width: 6%;">#</div>
                        <div class="div-table-cell" style="width: 10%;">Cota</div>
                        
                        <div class="div-table-cell" style="width: 8%;">Titulo</div>
                        
                        <div class="div-table-cell" style="width: 6%;">Ver/Editar</div>
                        <div class="div-table-cell" style="width: 6%;"> 
                        Eliminar</div>
                      </div>
              </div>`;


            for (var i = 0; i < libros.libros[0].length; i++) {

              container.insertAdjacentHTML('beforeend', `
          <div class="table-responsive" id="${libros.libros[0][i].cota}0">
                  <div class="div-table" style="margin:0 !important;">
                      <div class="div-table-row div-table-row-list">
                          <div  class="div-table-cell" style="width: 6%;">${i + 1}</div>
                          <div  class="div-table-cell" id="${libros.libros[0][i].cota}_cota" style="width: 10%;">${libros.libros[0][i].cota}</div>
                         
                          
                          <div class="div-table-cell" id="${libros.libros[0][i].cota}_titulo" style="width: 8%;">${libros.libros[0][i].title}</div>
                          
                         
                          <div class="div-table-cell" style="width: 6%;">
                              
                              <button class="btn btn-info"  id="id-${libros.libros[0][i].cota}" onclick="javascript:ver(this)" if ><i class="zmdi zmdi-file-text"></i></button>
                          
                          </div>
                          <div class="div-table-cell" style="width: 6%;">
                              
                            <button class="btn btn-danger" id="${libros.libros[0][i].cota}" onclick="javascript:eliminarLibro(this)"><i class="zmdi zmdi-delete"></i></button>
  
                           
                          </div>
                      </div>
                  </div>
              </div>`);


            }

            document.getElementsByTagName("button")[1].focus({ preventScroll: true });
          } else {
            cargando.innerHTML = '<h3 class="text-center">No se obtuvieron resultados</h3>';
            container.innerHTML = '';


          }
        })
        .fail(function (error) {
          limpiarButton.click();
          cargando.innerHTML = '<img src="/assets/icons/notificacion-error.ico"width= "20" height= "20">';
        });
    });

  });
</script>
<script>
  //ocultar o mostrar el campo de ingresar una nueva imagen al momento de editar una noticia
  function mostrarCampoImg(check) {
    if (check.checked) {
      $("table#table-img").html('');
    } else {
      $("table#table-img").html(` <tr id="tr-img-1" style="border: none;">
                      <td style="width: 200px;  border: none;">
                        <input onchange="comprobarFI(this)" id="img-1" name="img" type="file" required=""
                          class="material-control tooltips-general" data-toggle="tooltip" data-placement="top"
                          title="Imagen">
                        <span class="highlight"></span>
                        <span class="bar"></span>
                        <label>Imagen</label>
                     
                      </td>
                      <td style="width: 30px;  border: none;"  id="ico-1">

                      </td>
                    </tr>
                    <tr id="tr2-img-1">
                      <td style="width: 200px; border: none;">
                          <p class="text-center" id="formato-img-1"></p>
                     
                      </td>
                      <td style="width: 30px;  border: none;">
                      </td>
                    </tr>`);
    }
  }
  //elimina una noticia
  function eliminarUnaNoticia(id) {

    let id_n = id;
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: `/bibliotecario/eliminar?id_n=${id_n}`,
      type: "POST",
    })
      .done(function (res) {
        $("#myModal").modal("hide");
        if (res == 'ok') {
          let msj = 'noticia eliminada'
          $("#modal-body-3").html(`<p class="text-center">Eliminado con exito</p>`);
          $("#myModal3").modal("show");
          $("div#myModal3").on('hidden.bs.modal', function (e) {
            if (msj === 'noticia eliminada') {
              msj = '';
              mostrarNoticias();

            }

          });
        }
      })
      .fail(function (error) {
        manejoErrores(error);
      });

  }
  //ver la noticia en una ventana modal estatica
  function verUnaNoticia(id) {
    let id_n = id;
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: `/noticia?id_n=${id_n}`,
      type: "POST",
    })
      .done(function (noticia) {
        $("div#modal-body-2").html(`
         <div id="cuadro">
   <div class="container-fluid" >
  
          <img src="${noticia.url_imagen}" alt="">
          <a class="news-title" href="#">${noticia.titulo_noticia}</a>
          <span class="news-text text-center">${noticia.text_noticia}</span> </div>
        </div>
        `);
        $("div#myModal").modal("hide");
        $("div#myModal2").modal("show");

      })
      .fail(function (error) {
        manejoErrores(error);
      });
  }
  //solicitas y muestras las noticias
  function mostrarNoticias() {

    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/noticias",
      type: "GET",
    })
      .done(function (noticias) {
        $("div#accordion").html('');
        $("div#cuadronot").html('');
        if (noticias.length > 0) {

          for (var i = 0; i < noticias.length; i++) {

            $('div#cuadronot').append(`<li>
   <div class="container-fluid" style="background-color: rgb(223, 231, 253);"   >
 
   <p style="text-align: right;"> <button class="btn btn-circle btn-sm btn-danger" onclick="javascript: eliminarUnaNoticia('${noticias[i].id_n}')">X</button>&nbsp;<button class="btn btn-circle btn-sm btn-info" onclick="javascript: editarUnaNoticia('${noticias[i].id_n}')"><i class="zmdi zmdi-edit"></i></button></p>
   <div onclick="javascript: verUnaNoticia('${noticias[i].id_n}')">   
         
         <img src="${noticias[i].url_imagen}" alt="">
         <a class="news-title" href="#">${noticias[i].titulo_noticia}</a>
         <span class="news-text text-center">${noticias[i].text_noticia}</span> </div>
        </div>
     </li>
     `);
          }
          if (noticias.length == 1) {
            if (!intervalId) {

         $("div#myModal").modal("hide");
     } else {
        clearInterval(intervalId)
        intervalId = false;
   $("div#myModal").modal("hide"); 
     } 
          } else if (noticias.length > 1) {


            $("div#myModal").modal("hide");
            let bandera = 2;
            $("div#myModal").on("hidden.bs.modal", function () {
              if (bandera == 2) {

                bandera = 0;
                intervalId = true;
                intervalId = setInterval(removeFirst, 7500);
              }
            });

          }



        } else {
         
           $("div#cuadronot").html(`
                            <div class="container-fluid">
                    <h3 class="text-center all-tittles">No hay noticias recientes </h3>
                </div>
          
                            `);
                            if (!intervalId) {

         $("div#myModal").modal("hide");
     } else {
        clearInterval(intervalId)
        intervalId = false;
   $("div#myModal").modal("hide"); 
     } 
        }



      })
      .fail(function (error) {
        manejoErrores(error);
      });

  };
  //actualizas una noticia 
  function editarUnaNoticia(input) {
    let data = input;
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: `/noticia?id_n=${data}`,
      type: "POST",
    })
      .done(function (noticia) {
        $("div#modal-body-2").html('');
        if (noticia) {
          $("div#modal-body-2").html(`
        <div class="container-fluid"> <form autocomplete="off" enctype="multipart/form-data" id="noticiaEditada">
            <div class="container-flat-form">

              <div class="title-flat-form title-flat-blue">Edita la noticia</div>
              <div class="row">

                <div class="col-xs-12 col-sm-8 col-sm-offset-2">
                  <legend><strong>Información básica</strong></legend><br>
                  <div class="group-material">
                    <input id="titulo" name="titulo" type="text" class="tooltips-general material-control"
                      placeholder="Escribe aquí el título de la noticia" required="" maxlength="200"
                      data-toggle="tooltip" pattern="[a-zA-Zá-ú ]{1,200}" min="1" data-placement="top" value="${noticia.titulo_noticia}"
                      title="Título de la noticia">
                    <span class="highlight"></span>
                    <span class="bar"></span>
                    <label>Título</label>
                  </div>

                  <div class="group-material">
                    <input id="id_n" name="id_n" type="text"  value="${noticia.id_n}" hidden>
                  </div>
                  <div class="group-material">
                    <input id="destino" name="destino" type="text"  value="${noticia.url_imagen}" hidden>
                  </div>

                  <div class="group-material">
                    <textarea id="textNoticia" name="textNoticia" type="text"
                      class="tooltips-general material-control form-control rounded-0" style="border-color: rgb(0, 0, 255);"
                      placeholder="Escribe aquí la noticia" required="" data-toggle="tooltip" min="20"
                      data-placement="top" title="Texto de la noticia" value="${noticia.text_noticia}" cols="78" rows="5" wrap="hard"
                      spellcheck="true">${noticia.text_noticia}</textarea>

                  </div>
                  <div  class="group-material" >
                                     <p class="text-center"> <input onchange="mostrarCampoImg(this)" id="mostrarImg" name="mostrarImg" type="checkbox"  value="1" class="tooltips-general" title="Selecciona si usaras la imagen actual">Mantener la imagen almacenada</p>
                  </div>
                  <table class="table table-responsive " style="table-layout: fixed; border: none;" id="table-img">
                    <tr id="tr-img-1" style="border: none;">
                      <td style="width: 200px;  border: none;">
                        <input onchange="comprobarFI(this)" id="img-1" name="img" type="file" required=""
                          class="material-control tooltips-general" data-toggle="tooltip" data-placement="top"
                          title="Imagen">
                        <span class="highlight"></span>
                        <span class="bar"></span>
                        <label>Imagen</label>
                     
                      </td>
                      <td style="width: 30px;  border: none;"  id="ico-1">

                      </td>
                    </tr>
                    <tr id="tr2-img-1">
                      <td style="width: 200px; border: none;">
                          <p class="text-center" id="formato-img-1"></p>
                     
                      </td>
                      <td style="width: 30px;  border: none;">
                      </td>
                    </tr>
                  </table>
                  <p class="text-center">
                    <button id="reset1" onclick="limpiarFN()"  type="reset" class="btn btn-info" style="margin-right: 20px;"><i
                        class="zmdi zmdi-roller"></i>
                
                <p>&nbsp;&nbsp; Limpiar</p> </button>
                <button  type="submit" class="btn btn-primary">
              <i class="zmdi zmdi-floppy"></i>
              <p >&nbsp;&nbsp; Guardar</p> </button>
            </div>
        </div>
      </div>
      </form>
      </div>`);

        } else {
          $("div#modal-body-2").html(`
                            <div class="container-fluid">
                    <h3 class="text-center all-tittles">No hay información sobre esta noticia </h3>
                </div> `);

        }
        //  let msj = 'actualizar';
        $("div#myModal").modal("hide");
        
        $("div#myModal2").modal("show");
        
      })
      .fail(function (error) {
        manejoErrores(error);
      });
  }
  //limpiar el formato de la noticia
  function limpiarFN() {
    $("p#formato-img-1").html('');
    $("td#ico-1").html('');
    $("td#ico-2").html('');
  }
  //boton añadir noticia muestra y oculta el formulario  
  function añadirNoticia(input) {
    let boton = $(input).html();
    if (boton == "Añadir noticia") {
      $("div#cuadronot").hide();
      $("div#infNoticia").show();
      $(input).html('Volver');
    } else {

      $("div#cuadronot").show();
      $("div#infNoticia").hide();
      mostrarNoticias();
      $(input).html('Añadir noticia');
    }

  }
  //el boton azul de lapiz abre una ventana modal con la informacion de la noticia a editar
  function editarNoticia(input) {
    let boton = $(input).html();
    if (boton === "Editar/Eliminar noticia") {
      $("div#cuadronot").hide();
      $("div#infNoticia").show();
      $(input).html('Volver');
    } else {
      $("div#cuadronot").show();
      $("div#infNoticia").hide();
      $(input).html('Editar/Eliminar noticia');
    }

  }
  //se muestra el icono formato correcto
  function formatoCI(id1, id2) {
    $(id1).html("");
    $(id2).html(
      `<img src="/assets/img/satisfactorio.png" width= "20" height= "20">`
    );
  }
  //se muestra el icono de formato incorrecto
  function formatoII(id1, id2) {
    $(id1).html(`<p>Debe ser formato jpg, png ó jpeg</p>`);
    $(id2).html(
      `<img src="/assets/icons/notificacion-error.ico" width= "20" height= "20">`
    );
  }
  //se evalua el formato de la img de la noticia
  function comprobarFI(img) {
    var i = $(img).attr("id").split("-").pop();
    var ext = $(img).val().split(".").pop().toLowerCase();

    var id1 = "p#formato-img-" + i;
    var id2 = "td#ico-" + i;
    if ($(img).val() != "") {
      if (ext === "png" || ext === "jpg" || ext === "jpeg") {
        formatoCI(id1, id2);
      } else {
        formatoII(id1, id2);
      }
    }
  }

  function cambiarF(input) {
    let id = $(input).attr("id").split('-').pop();
    let nId = "fe-" + id;
  }
  //eliminar una ficha entregada
  //eliminar ficha reservada
  function eliminarFichaEntregada(input) {

    let cota = input;
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });

      },
      url: `/bibliotecario/eliminarFichaEntregada?cota=${cota}`,
      type: 'delete'
    })
      .done(function (res) {
        $("#myModal").modal("hide");
        prestamosE();
        $("#modal-body-3").html(`<p class="text-center">${res}</p>`);
        $("#myModal3").modal("show");
      })
      .fail(function (error) {
        manejoErrores(error);
      });

  };
  //ver una ficha entregada
  function verFichaE(input) {
    let cota = input;
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });

      },
      url: `/ver_ficha_e?cota=${cota}`,
      type: 'post'
    })
      .done(function (res) {
        $("#myModal").modal("hide");

        $("div#modal-body-4").html('');
        $("div#tutor").html('');
        $("#myLabel").html('Información del préstamo');
        $("div#modal-body-4").html(`
           <form>
             <div style="height:50px;">
             <div class="form-group row">
             <label for="id1" class="col-sm-2 col-form-label">Tipo de libro</label>
             <div class="col-sm-10">
             <input value="${res.libro.tipo_l}"  type="text" class="tooltips-general material-control"  class="form-control " id="id1" readonly>
             </div>
             </div>
             <div class="form-group row">
             <label for="id2" class="col-sm-2 col-form-label">Cota</label>
             <div class="col-sm-10">
             <input value="${res.libro.cota}" type="text" class="tooltips-general material-control" class="form-control" id="id2" readonly>
             </div>
             </div>
             <div class="form-group row">
             <label for="id3" class="col-sm-2 col-form-label">Título</label>
             <div class="col-sm-10">
             <input value="${res.libro.titulo}" type="text" class="tooltips-general material-control" class="form-control" id="id3" readonly>
             </div>
             </div>
             <div class="form-group row">
             <label for="id4" class="col-sm-2 col-form-label">Fecha de emisión</label>
             <div class="col-sm-10">
             <input value="${res.ficha.fecha_e}" type="text" class="tooltips-general material-control" class="form-control" id="id4" readonly>
             </div>
             </div>
   
             <div class="form-group row">
             <label for="id5" class="col-sm-2 col-form-label">Fecha de culminación</label>
             <div class="col-sm-10">
             <input value="${res.ficha.fecha_c}" type="text" class="tooltips-general material-control" class="form-control" id="id5" readonly>
             </div>
             </div>
             
             
   
            
           </div>
           <br>
         
             
             </form>
   
           `);

        $("div#myModal4").modal('show');
      })
      .fail(function (error) {
        manejoErrores(error);
      });
  }
  //ver una ficha
  function verFicha(input) { 
    let cota = input;
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });

      },
      url: `/ver_ficha?cota=${cota}`,
      type: 'post'
    })
      .done(function (res) {
        $("#myModal").modal("hide");

        $("div#modal-body-4").html('');
        $("div#tutor").html('');
        $("#myLabel").html('Información del préstamo');
        $("div#modal-body-4").html(`
           <form>
             <div style="height:50px;">
              <div class="form-group row">
             <label for="id1" class="col-sm-2 col-form-label">Correo electrónico del usuario</label>
             <div class="col-sm-10">
             <input value="${res.ficha.correo_f}"  type="text" class="tooltips-general material-control"  class="form-control " id="id1" readonly>
             </div>
             </div>
             <div class="form-group row">
             <label for="id1" class="col-sm-2 col-form-label">Tipo de libro</label>
             <div class="col-sm-10">
             <input value="${res.libro.tipo_l}"  type="text" class="tooltips-general material-control"  class="form-control " id="id1" readonly>
             </div>
             </div>
             <div class="form-group row">
             <label for="id2" class="col-sm-2 col-form-label">Cota</label>
             <div class="col-sm-10">
             <input value="${res.libro.cota}" type="text" class="tooltips-general material-control" class="form-control" id="id2" readonly>
             </div>
             </div>
             <div class="form-group row">
             <label for="id3" class="col-sm-2 col-form-label">Título</label>
             <div class="col-sm-10">
             <input value="${res.libro.titulo}" type="text" class="tooltips-general material-control" class="form-control" id="id3" readonly>
             </div>
             </div>
             <div class="form-group row">
             <label for="id3" class="col-sm-2 col-form-label">Autor</label>
             <div class="col-sm-10">
             <input value="${res.libro.autor}" type="text" class="tooltips-general material-control" class="form-control" id="id3" readonly>
             </div>
             </div>
             <div class="form-group row">
             <label for="id4" class="col-sm-2 col-form-label">Fecha de emisión</label>
             <div class="col-sm-10">
             <input value="${res.ficha.fecha_e}" type="text" class="tooltips-general material-control" class="form-control" id="id4" readonly>
             </div>
             </div>
   
             <div class="form-group row">
             <label for="id5" class="col-sm-2 col-form-label">Fecha de devolución</label>
             <div class="col-sm-10">
             <input value="${res.ficha.fecha_d}" type="text" class="tooltips-general material-control" class="form-control" id="id5" readonly>
             </div>
             </div>
             <div class="form-group row">
             <label for="id6" class="col-sm-2 col-form-label">Multa</label>
             <div class="col-sm-10">
             <input value="${res.ficha.multa} ${res.conf.unidad}" type="text" class="tooltips-general material-control" class="form-control" id="id6" readonly>
             </div>
             </div>
             
             
   
            
           </div>
           <br>
         
             
             </form>
   
           `);
   if (res.ficha.multa > 0) {
      $('#id6').css({ 'color': 'red' });
}
        $("div#myModal4").modal('show');
        })
       .fail(function (error) {
         manejoErrores(error);
       });
  }
   //se aprueba una reserva
  function aprobar(c,f) {
   ;
    let cota = c;
    let fechaActual = new Date();
        let fecha_d = f;
        let dia = fecha_d.split('-')[2];
        let mes = fecha_d.split('-')[1] - 1;
        let año = fecha_d.split('-')[0];
        let fecha_e = new Date(año, mes, dia);
        let resultado = fechaActual.getTime() >= fecha_e.getTime();
       
    if (resultado) {
       $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/bibliotecario/aprobar",
      type: "POST",
      data: {
        cota: cota,
      },
    })
      .done(function (res) {
        if (res === "Préstamo aprobado exitosamente") {
          let q = "table_" + cota;
          $("#myModal").modal("hide");
          
          $("#modal-body-3").html(`<p class="text-center">${res}</p>`);
          $("#myModal3").modal("show");
       $("div#myModal3").on('hidden.bs.modal', function (e) {
            if (res === "Préstamo aprobado exitosamente") {
              res = '';
               $(q).remove();
               prestamosP();
            }
              
          });
        }
      })
      .fail(function (error) {
        manejoErrores(error);
      });
 
    } else {
      $("#modal-body-3").html(`<p class="text-center">No puedes aprobar un préstamo antes de la fecha de petición</p>`);
          $("#myModal3").modal("show");
    }
    }
  //remueve un campo
  function removeCampo(query) {
    $(query).remove();
  }
  // se recibe un libro
  function recibir(input, multa) {
  
    let cota = input;
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/bibliotecario/recibir",
      type: "POST",
      data: {
        cota: cota,
      },
    })
      .done(function (res) {
        $("div#myModal").modal("hide");
        if (res == "Libro entregado exitosamente") {
          let q = "#table_" + cota;
          $("div#modal-body-3").html(`<p class="text-center">${res}</p>`)
          $("div#myModal3").modal("show");
          
          $("div#myModal3").on('hidden.bs.modal', function (e) {
            if (res == "Libro entregado exitosamente") {
           
               $(q).remove();
            }
              
          });
        }
      })
      .fail(function (error) {
        manejoErrores(error);
      });
  }
  //eliminar prestamos entregados no usado
  function eliminarP(cota) {
    let cota_f = cota;
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/bibliotecario/eliminar",
      type: "delete",
      data: {
        cota: cota,
      },
    })
      .done(function (res) {
        $("div#myModal").modal("hide");
        if (res == "Libro eliminado exitosamente") {
          let q = "div#table_" + cota;
          removeCampo(q);

          $("div#modal-body-3").html(`<p class="text-center">${res}</p>`)
          $("div#myModal3").modal("show");
          limpiar();
        }
      })
      .fail(function (error) {
        manejoErrores(error);
      });
  }
  //se limpian formularios
  function limpiar() {
    let filas = document.getElementsByClassName("table-responsive");

    if (filas.length == 1) {
      $("div#tabla").html(`
                        <div class="container-fluid">
                    <h3 class="text-center all-tittles">No hay tramites para mostrar </h3>
                </div>`);
    }
  }
  //solicitas y muestras las noticias
  function mostrarPreguntas() {
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/preguntas-frecuentes",
      type: "GET",
    })
      .done(function (preguntas) {
        $("div#accordion").html('');

        if (preguntas.length > 0) {
          var j = 0;
          for (var i = 0; i < preguntas.length; i++) {

            $('div#accordion').append(`
        <div class="panel panel-default">
          <p style="text-align: right;"> <button class="btn btn-circle btn-sm btn-danger" onclick="javascript: eliminarUnaPregunta('${preguntas[i].id_pf}')">X</button>&nbsp;<button class="btn btn-circle btn-sm btn-info" onclick="javascript: editarUnaPregunta('${preguntas[i].id_pf}')"><i class="zmdi zmdi-edit"></i></button></p>
          <div class="panel-heading p-3 mb-3"  role="tab" id="heading${i}">
            <h3 class="panel-title">
              <a class="collapsed" role="button" title="" data-toggle="collapse" data-parent="#accordion" href="#collapse${i}" aria-expanded="true" aria-controls="collapse${i}">
                ${preguntas[i].titulo_pregunta} 
              </a>
            </h3> 
          </div> 
          <div id="collapse${i}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading0">
            <div class="panel-body px-3 mb-4">
              ${preguntas[i].text_respuesta}
             </div> 
          </div> 
        </div>
        
     `);


          }


        } else {
          $("div#accordion").append(`
                            <div class="container-fluid">
                    <h3 class="text-center all-tittles">No hay preguntas frecuentes guardadas </h3>
                </div>
          
                            `);
        }

        $("div#myModal").modal("hide");
      })
      .fail(function (error) {
        manejoErrores(error);
      });

  };

  //boton añadir pregunta muestra y oculta el formulario  
  function añadirPregunta(input) {
    let boton = $(input).html();
    if (boton === "Añadir pregunta") {
      $("div#accordion").hide();
      $("form#preguntasFrecuentes").show();
      $(input).html('Volver');
    } else {

      $("div#accordion").show();
      $("form#preguntasFrecuentes").hide();
      mostrarPreguntas();
      $(input).html('Añadir pregunta');
    }

  }

  //elimina una pregunta
  function eliminarUnaPregunta(id) {

    let id_pf = id;
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: `/bibliotecario/eliminar/p_f?id_pf=${id_pf}`,
      type: "DELETE",
    })
      .done(function (res) {
        $("#myModal").modal("hide");
        if (res == 'ok') {
          let msj = 'pregunta eliminada'
          $("#modal-body-3").html(`<p class="text-center">Eliminado con éxito</p>`);
          $("#myModal3").modal("show");
      
          $("div#myModal3").on('hidden.bs.modal', function (e) {
            if (msj === 'pregunta eliminada') {
              msj = '';
              mostrarPreguntas();

            }

          });
        }
      })
      .fail(function (error) {
        manejoErrores(error);
      });

  }

  //actualizas una pregunta 
  function editarUnaPregunta(input) {
    let data = input;
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: `/pregunta?id_pf=${data}`,
      type: "POST",
    })
      .done(function (pregunta) {
        $("div#modal-body-2").html('');
        if (pregunta) {
          $("div#modal-body-2").html(`
        <div class="container-fluid"> <form autocomplete="off" enctype="multipart/form-data" id="preguntaEditada">
            <div class="container-flat-form">

              <div class="title-flat-form title-flat-blue">Edita la pregunta</div>
              <div class="row">

                <div class="col-xs-12 col-sm-8 col-sm-offset-2">
                  <legend><strong>Información básica</strong></legend><br>
                  <div class="group-material">
                    <input id="titulo" name="titulo" type="text" class="tooltips-general material-control"
                      placeholder="Escribe aquí el título de la pregunta" required=""
                      data-toggle="tooltip" pattern="[Áa-z- -ñ]{1,}" min="1" data-placement="top" value="${pregunta.titulo_pregunta}"
                      title="Título de la pregunta">
                    <span class="highlight"></span>
                    <span class="bar"></span>
                    <label>Título</label>
                  </div>

                  <div class="group-material">
                    <input id="id_pf" name="id_pf" type="text"  value="${pregunta.id_pf}" hidden>
                  </div>

                  <div class="group-material">
                    <textarea id="textPregunta" name="texto" type="text"
                      class="tooltips-general material-control form-control rounded-0" style="border-color: rgb(0, 0, 255);"
                      placeholder="Escribe aquí la repuesta" required="" data-toggle="tooltip" min="20"
                      data-placement="top" title="Texto respuesta a la pregunta" value="${pregunta.text_respuesta}" cols="78" rows="5" wrap="hard"
                      spellcheck="true">${pregunta.text_respuesta}</textarea>

                  </div>
                  
                  <p class="text-center">
                    <button id="reset4"   type="reset" class="btn btn-info" style="margin-right: 20px;"><i
                        class="zmdi zmdi-roller"></i>
                
                <p>&nbsp;&nbsp; Limpiar</p> </button>
                <button  type="submit" class="btn btn-primary">
              <i class="zmdi zmdi-floppy"></i>
              <p >&nbsp;&nbsp; Guardar</p> </button>
            </div>
        </div>
      </div>
      </form>
      </div>`);

        } else {
          $("div#modal-body-2").html(`
                            <div class="container-fluid">
                    <h3 class="text-center all-tittles">No hay información sobre esta noticia </h3>
                </div> `);

        }
        //  let msj = 'actualizar';
        $("div#myModal").modal("hide");
        $("div#myModal2").modal("show");
        /*  $("div#myModal2").on('hidden.bs.modal', function (e) {
            if (msj === 'actualizar') {
              msj = '';
              mostrarNoticias(); 
            }
              
          });*/
      })
      .fail(function (error) {
        manejoErrores(error);
      });
  }

  //muestra un icono y mensaje respectivamente sea correcto o incorrecto el mensaje
  function formatoCE(id1, id2) {
    $(id1).html("");
    $(id2).html(
      `<img src="/assets/img/satisfactorio.png" width= "20" height= "20">`
    );
  }
  function formatoIE(id1, id2) {
    $(id1).html(`<p>Debe ser formato xlsx</p>`);
    $(id2).html(
      `<img src="/assets/icons/notificacion-error.ico" width= "20" height= "20">`
    );
  }

  //comprobar formato excel
  function comprobarFE(excel) {
    var i = $(excel).attr("id").split("-").pop();

    var ext = $(excel).val().split(".").pop().toLowerCase();

    var id1 = "p#formato-excel-" + i;
    var id2 = "td#ico-" + i;
    if ($(excel).val() != "") {
      if (ext === "xlsx") {
        formatoCE(id1, id2);
      } else {
        formatoIE(id1, id2);
      }
    }
  }
  ///
//seccion configuracion de seguridad
function seccionConfS() {
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/mis-preguntas",
      type: "GET",
    })
      .done(function (obj) {
        $("#myModal").modal("hide");
        $("div#confDias").hide();
        $("div#preguntasF").hide();
        $("#container").show();
        $("div#explicacion").show();
        $("form#nuevaBaseE").hide();
        $("div#editarLibro").hide();
        $("div#enlaces").hide();
        $("form#nuevaBaseD").hide();
        $("form#conf-nucleos").hide();
    $("form#conf-categorias").hide();
        $("div#inicio").hide();
        $("div#cargando").html('');
        $("form#ingresarLibro").hide();
        $("form#formato").hide();
        $("div#seccion").html(` 
                <div class="page-header">
                <h1 class="all-tittles">UNEXPO SBDIP <small>Mi configuración</small></h1>
               </div>`);
       $("div#explicacion").html(`
          <div class="row">
                <div class="col-xs-12 col-sm-4 col-md-3">
                    <img src="/assets/img/candado.png" alt="seguridad" class="img-responsive center-box"
                        style="max-width: 130px;">
                </div>
                <div class="col-xs-12 col-sm-8 col-md-8 text-justify lead">
                    Bienvenido a esta sección, aquí se muestran todas tus preguntas y respuestas de seguridad, solo podrás verlas. No podrás editarlas o eliminarlas.
                </div>
          </div>`);
        $("div#container").html('');
        if (obj.length > 0) {
          $("div#container").append(`
                 
                <h2 class="text-center all-tittles">Listado de núcleos</h2>
                <div class="table-responsive">
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                            <div class="div-table-cell" style="width: 3%;">#</div>
                            <div class="div-table-cell" style="width: 15%;">Pregunta</div>
                           
                            <div class="div-table-cell" style="width: 15%;">Respuesta</div>
                        </div>
                    </div>
                </div>
                `);

          for (var i = 0; i < obj.length; i++) {
            $("div#container").append(`
                        <div class="table-responsive">
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list">
                            <div class="div-table-cell" style="width: 3%;">${1 + i
              }</div>
                            <div class="div-table-cell" style="width: 15%;">${obj[i].pregunta
              }</div>
                            
                                <div class="div-table-cell" style="width: 15%;">${obj[i].respuesta}    
                            </div>
                                                    </div>
                    </div>
                </div>
            
                        `);
          }
        } else {
          $("div#container").append(`
                            <div class="container-fluid">
                    <h3 class="text-center all-tittles">No hay preguntas registradas </h3>
                </div>
          
                            `);

        }

        $("div#myModal").modal("hide");
      })
      .fail(function (error) {
        manejoErrores(error)
      });
  }


  //seccion editar categorias
function editarCategorias() {
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/categorias",
      type: "GET",
    })
      .done(function (categorias) {
        $("#myModal").modal("hide");
        $("div#confDias").hide();
        $("div#preguntasF").hide();
        $("#container").show();
        $("div#explicacion").show();
        $("form#nuevaBaseE").hide();
        $("div#editarLibro").hide();
        $("div#enlaces").hide();
        $("form#nuevaBaseD").hide();
        $("form#conf-nucleos").hide();
        $("form#conf-categorias").hide();
        $("div#inicio").hide();
        $("div#cargando").html('');
        $("form#ingresarLibro").hide();
        $("form#formato").hide();
        $("div#seccion").html(` 
                <div class="page-header">
                <h1 class="all-tittles">UNEXPO SBDIP <small>Categorías</small></h1>
               </div>`);
       $("div#explicacion").html(`
          <div class="row">
                <div class="col-xs-12 col-sm-4 col-md-3">
                    <img src="/assets/img/carpeta-azul.png" alt="categoria" class="img-responsive center-box"
                        style="max-width: 110px;">
                </div>
                <div class="col-xs-12 col-sm-8 col-md-8 text-justify lead">
                    Bienvenido a esta sección, aquí se muestran todas las categorías anteriormente registrados
                </div>
          </div>`);
        $("div#container").html('');
        if (categorias.categorias.length > 0) {
          $("div#container").append(`
                <h2 class="text-center all-tittles">Listado de categorías</h2>
                <div class="table-responsive">
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                            <div class="div-table-cell" style="width: 3%;">#</div>
                            <div class="div-table-cell" style="width: 15%;">Categorías</div>
                           
                            <div class="div-table-cell" style="width: 8%;">Editar</div>
                            <div class="div-table-cell" style="width: 8%;">Eliminar</div>
                        </div>
                    </div>
                </div>
                `);

          for (var i = 0; i < categorias.categorias.length; i++) {
            $("div#container").append(`
                        <div class="table-responsive" id='c_${categorias.categorias[i].categoria}'>
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list">
                            <div class="div-table-cell" style="width: 3%;">${1 + i
              }</div>
                            <div class="div-table-cell" style="width: 15%;">${categorias.categorias[i].categoria
              }</div>
                            
                                <div class="div-table-cell" style="width: 8%;">
                                <button onclick="editarUnaCategoria('${categorias.categorias[i].categoria}')" class="btn btn-info"><i class="zmdi zmdi-file-text"></i></button>
    
                            </div>
                            <div class="div-table-cell"  style="width: 8%;">
                            <button onclick="eliminarCategoria('${categorias.categorias[i].categoria}')" class="btn btn-danger"><i
                                    class="zmdi zmdi-delete"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
            
                        `);
          }
        } else {
          $("div#container").append(`
                            <div class="container-fluid">
                    <h3 class="text-center all-tittles">No hay categorías registradas </h3>
                </div>
          
                            `);

        }

        $("div#myModal").modal("hide");
      })
      .fail(function (error) {
        manejoErrores(error)
      });
  };

   //seccion editar suscripciones
function editarSuscripiones() {
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/suscripciones",
      type: "GET",
    })
      .done(function (suscripciones) {
        $("#myModal").modal("hide");
        $("div#confDias").hide();
        $("div#preguntasF").hide();
        $("#container").show();
        $("div#explicacion").show();
        $("form#nuevaBaseE").hide();
        $("div#editarLibro").hide();
        $("div#enlaces").hide();
        $("form#nuevaBaseD").hide();
        $("form#conf-nucleos").hide();
        $("form#conf-categorias").hide();
        $("div#inicio").hide();
        $("div#cargando").html('');
        $("form#ingresarLibro").hide();
        $("form#formato").hide();
        $("div#seccion").html(` 
                <div class="page-header">
                <h1 class="all-tittles">UNEXPO SBDIP <small>Suscripciones</small></h1>
               </div>`);
       $("div#explicacion").html(`
          <div class="row">
                <div class="col-xs-12 col-sm-4 col-md-3">
                    <img src="/assets/img/identificacion.png" alt="suscripcion" class="img-responsive center-box"
                        style="max-width: 110px;">
                </div>
                <div class="col-xs-12 col-sm-8 col-md-8 text-justify lead">
                    Bienvenido a esta sección, aquí se muestran todas las suscripciones.
                </div>
          </div>`);
        $("div#container").html('');
        if (suscripciones.suscripciones.length > 0) {
          $("div#container").append(`
                <h2 class="text-center all-tittles">Listado de categorías</h2>
                <div class="table-responsive">
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                            <div class="div-table-cell" style="width: 3%;">#</div>
                            <div class="div-table-cell" style="width: 15%;">Suscripción</div>
                            <div class="div-table-cell" style="width: 15%;">Costo</div>
                            <div class="div-table-cell" style="width: 15%;">Vigencia en días</div>
                           
                            <div class="div-table-cell" style="width: 8%;">Editar</div>
                        </div>
                    </div>
                </div>
                `);

          for (var i = 0; i < suscripciones.suscripciones.length; i++) {
            $("div#container").append(`
                        <div class="table-responsive" id='n_${suscripciones.suscripciones[i].tipo_ts}'>
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list">
                            <div class="div-table-cell" style="width: 3%;">${1 + i
              }</div>
                            <div class="div-table-cell" style="width: 15%;">${suscripciones.suscripciones[i].tipo_ts}</div>
                            <div class="div-table-cell" style="width: 15%;">${suscripciones.suscripciones[i].costo}</div>
                            <div class="div-table-cell" style="width: 15%;">${suscripciones.suscripciones[i].vigencia}</div>
                            
                                <div class="div-table-cell" style="width: 8%;">
                                <button onclick="editarUnaSus('${suscripciones.suscripciones[i].tipo_ts}')" class="btn btn-info"><i class="zmdi zmdi-file-text"></i></button>
    
                            </div>
                           
                        </div>
                    </div>
                </div>
            
                        `);
          }
        } else {
          $("div#container").append(`
                            <div class="container-fluid">
                    <h3 class="text-center all-tittles">No hay suscripciones registrados </h3>
                </div>
          
                            `);

        }

        $("div#myModal").modal("hide");
      })
      .fail(function (error) {
        manejoErrores(error)
      });
  };



//seccion editar nucleos
function editarNucleos() {
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/bibliotecario/nucleos",
      type: "GET",
    })
      .done(function (nucleos) {
        $("#myModal").modal("hide");
        $("div#confDias").hide();
        $("div#preguntasF").hide();
        $("#container").show();
        $("div#explicacion").show();
        $("form#nuevaBaseE").hide();
        $("div#editarLibro").hide();
        $("div#enlaces").hide();
        $("form#nuevaBaseD").hide();
        $("form#conf-nucleos").hide();
    $("form#conf-categorias").hide();
        $("div#inicio").hide();
        $("div#cargando").html('');
        $("form#ingresarLibro").hide();
        $("form#formato").hide();
        $("div#seccion").html(` 
                <div class="page-header">
                <h1 class="all-tittles">UNEXPO SBDIP <small>Núcleos</small></h1>
               </div>`);
       $("div#explicacion").html(`
          <div class="row">
                <div class="col-xs-12 col-sm-4 col-md-3">
                    <img src="/assets/img/institucion.png" alt="institucion" class="img-responsive center-box"
                        style="max-width: 130px;">
                </div>
                <div class="col-xs-12 col-sm-8 col-md-8 text-justify lead">
                    Bienvenido a esta sección, aquí se muestran todos los núcleos anteriormente registrados
                </div>
          </div>`);
        $("div#container").html('');
        if (nucleos.nucleos.length > 0) {
          $("div#container").append(`
                 
                <h2 class="text-center all-tittles">Listado de núcleos</h2>
                <div class="table-responsive">
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                            <div class="div-table-cell" style="width: 3%;">#</div>
                            <div class="div-table-cell" style="width: 15%;">Núcleo</div>
                           
                            <div class="div-table-cell" style="width: 8%;">Editar</div>
                            <div class="div-table-cell" style="width: 8%;">Eliminar</div>
                        </div>
                    </div>
                </div>
                `);

          for (var i = 0; i < nucleos.nucleos.length; i++) {
            $("div#container").append(`
                        <div class="table-responsive" id='n_${nucleos.nucleos[i].nucleo}'>
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list">
                            <div class="div-table-cell" style="width: 3%;">${1 + i
              }</div>
                            <div class="div-table-cell" style="width: 15%;">${nucleos.nucleos[i].nucleo
              }</div>
                            
                                <div class="div-table-cell" style="width: 8%;">
                                <button onclick="editarUnNucleo('${nucleos.nucleos[i].nucleo}')" class="btn btn-info"><i class="zmdi zmdi-file-text"></i></button>
    
                            </div>
                            <div class="div-table-cell"  style="width: 8%;">
                            <button onclick="eliminarNucleo('${nucleos.nucleos[i].nucleo}')" class="btn btn-danger"><i
                                    class="zmdi zmdi-delete"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
            
                        `);
          }
        } else {
          $("div#container").append(`
                            <div class="container-fluid">
                    <h3 class="text-center all-tittles">No hay núcleos registrados </h3>
                </div>
          
                            `);

        }

        $("div#myModal").modal("hide");
      })
      .fail(function (error) {
        manejoErrores(error)
      });
  }
//eliminacion de un categoria
function eliminarCategoria(input) {
  
  let categoria= input;
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });

      },
      url: `/bibliotecario/eliminarCategoria?c=${categoria}`,
      type: 'delete'
    })
      .done(function (res) {
        $("#myModal").modal("hide");
        $("#modal-body-3").html(`<p class="text-center">${res}</p>`);
          $("#myModal3").modal("show");
          $("#myModal3").on("hidden.bs.modal", function () {
          editarCategorias();
          
        });
        
      })
      .fail(function (error) {
        manejoErrores(error);
      });
}
//editar una categoria
function editarUnaCategoria(input) {
  let categoria= input;
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });

      },
      url: `/bibliotecario/editarCategoria?c=${categoria}`,
      type: 'post'
    })
      .done(function (res) {
        $("#myModal").modal("hide"); 
        if (res!=='ok') {
        $("#modal-body-3").html(`<p class="text-center">${res}</p>`);
          $("#myModal3").modal("show");
         
        }else {
           $("#myLabel").html('');
        $("#modal-body-4").html(`
  
        <form  method="post" id="editarC" autocomplete="off">
      <div class="container-flat-form">
        <div class="title-flat-form title-flat-blue">Nueva configuración</div>
        <div class="row">
  
          <div class="col-xs-12 col-sm-8 col-sm-offset-2">
  
          
            <h4 class="text-center all-tittles" style="margin-bottom: 10px;">Configuración de categorías</h4>
  <br>
                  
  <input id="viejaCategoria"  name="categoriaV" type="text"
                  class="material-control material-control-login"  placeholder="Escribe aquí la categoría"
                   maxlength="100"
                    pattern="(^([a-zA-Zá-ú]{1,})$)" value="${categoria}"
                    data-toggle="tooltip" data-placement="top" readonly>
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>            Nombre actual</label>

                  <input id="categoria-1"  onkeyup="comp(this)" name="categoria" type="text"
                  class="material-control material-control-login"  placeholder="Escribe aquí la categoría con los cambios"
                    required="" maxlength="100"
                    pattern="(^([a-zA-Zá-ú]{1,})$)"
                    data-toggle="tooltip" data-placement="top" >
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label></label>
  
              
           <p class="text-center">
             <button type="reset" id="resetCategoria" class="btn btn-info">Limpiar</button>
             <button type="submit" class="btn btn-primary">Configurar</button>
             
           </p>
           
          </div>
        </div>   
      </div>        
       </form> 
  `);
        $("#myModal4").modal("show");
        }
       
       
        
      })
      .fail(function (error) {
        manejoErrores(error);
      });

       

   


}
//editar una categoria
function editarUnaSus(input) {
  let suscripcion= input;
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });

      },
      url: `/bibliotecario/editarSuscripcion?s=${suscripcion}`,
      type: 'post'
    })
      .done(function (res) {
        $("#myModal").modal("hide"); 
        if (res) {
           $("#myLabel").html('');
        $("#modal-body-4").html(`
  
        <form  method="post" id="editarS" autocomplete="off">
      <div class="container-flat-form">
        <div class="title-flat-form title-flat-blue">Nueva configuración</div>
        <div class="row">
  
          <div class="col-xs-12 col-sm-8 col-sm-offset-2">
  
          
            <h4 class="text-center all-tittles" style="margin-bottom: 10px;">Configuración de suscripciones</h4>
  <br>
                  
  

                  <input id="suscripcion"   name="suscripcion" type="text"
                  class="material-control material-control-login"  
                    required="" maxlength="100"
                    pattern="(^([a-zA-Zá-ú]{1,})$)" value="${res.tipo_ts}"
                    data-toggle="tooltip" data-placement="top" readonly>
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label></label>

                  <input id="costo"   name="costo" type="number"
                  class="material-control material-control-login"  placeholder="Escribe aquí el costo de la suscripción"
                    required="" maxlength="100" min="0" value="${res.costo}"
                    data-toggle="tooltip" data-placement="top">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label></label>

                  <input id="vigencia"   name="vigencia" type="number"
                  class="material-control material-control-login"  placeholder="Escribe aquí la vigencia en días" value="${res.vigencia}" min="1"
                    required="" maxlength="100"
                    data-toggle="tooltip" data-placement="top">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label></label>
  
              
           <p class="text-center">
             <button type="reset" id="resetSus" class="btn btn-info">Limpiar</button>
             <button type="submit" class="btn btn-primary">Configurar</button>
             
           </p>
           
          </div>
        </div>   
      </div>        
       </form> 
  `);
        $("#myModal4").modal("show");
        }
       
       
        
      })
      .fail(function (error) {
        manejoErrores(error);
      });

}


//eliminacion de un nucleo
//editar una categoria
function editarUnNucleo(input) {
  let nucleo= input;
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });

      },
      url: `/bibliotecario/editarNucleo?n=${nucleo}`,
      type: 'post'
    })
      .done(function (res) {
        $("#myModal").modal("hide"); 
        if (res!=='ok') {
        $("#modal-body-3").html(`<p class="text-center">${res}</p>`);
          $("#myModal3").modal("show");
         
        }else {
           $("#myLabel").html('');
        $("#modal-body-4").html(`
  
        <form  method="post" id="editarN" autocomplete="off">
      <div class="container-flat-form">
        <div class="title-flat-form title-flat-blue">Configuración de núcleos</div>
        <div class="row">
  
          <div class="col-xs-12 col-sm-8 col-sm-offset-2">
  
          
                  
  <input id="viejoNucleo"  name="nucleoV" type="text"
                  class="material-control material-control-login"  placeholder="Escribe aquí la categoría"
                   maxlength="100"
                    pattern="(^([a-zA-Zá-ú]{1,})$)" value="${nucleo}"
                    data-toggle="tooltip" data-placement="top" readonly>
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>            Nombre actual</label>

                  <table class="table table-responsive " style="table-layout: fixed; border: none;" id="tbnucleo">
            <tr>
              <td style="width: 40px; overflow: hidden; border: none;">
                <input id="nucleo1" name="nucleo1" type="number"  class="material-control material-control-login" 
                  placeholder="Núcleo.1" required="" maxlength="4" data-toggle="tooltip" data-placement="top"
                   value="1">
                <span class="highlight"></span>
                <span class="bar"></span>
                <label>Núcleo</label>
              </td>
              <td style="width: 150px; overflow: hidden; border: none;">
                <input id="nucleo-1"  name="nucleo_1" type="text"
                class="material-control material-control-login"  placeholder="Escribe aquí el núcleo"
                  required="" maxlength="100" onkeyup="comp(this)"
                  pattern="(^([a-zA-Zá-ú]{1,})$)"
                  data-toggle="tooltip" data-placement="top" >
                <span class="highlight"></span>
                <span class="bar"></span>
                <label></label>

              </td>
              <td id="imgs-nucleo" style="width: 20px; overflow: hidden; border: none;">
                <div  class="limpiar" id="img-nucleo-1"></div>
              </td>
            </tr>
            <tr>
              <td style="width: 30px; overflow: hidden; border: none;"></td>
              <td id="mensaje-nucleo" style="width: 200px; border: none; overflow: hidden;">
                <div class="limpiar" id="nucleo-unica-1"></div>
              </td>
              <td style="width: 20px; border: none; overflow: hidden;"></td>
            </tr>

          </table>
              
           <p class="text-center">
             <button type="reset" id="resetNucleo" class="btn btn-info">Limpiar</button>
             <button type="submit" class="btn btn-primary">Configurar</button>
             
           </p>
           
          </div>
        </div>   
      </div>        
       </form> 
  `);
        $("#myModal4").modal("show");
        }
       
       
        
      })
      .fail(function (error) {
        manejoErrores(error);
      });
    };
     //eliminacion de un nucleo
function eliminarNucleo(input) {
  
  let nucleo= input;
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });

      },
      url: `/bibliotecario/eliminarNucleo?n=${nucleo}`,
      type: 'delete'
    })
      .done(function (res) {
        $("#myModal").modal("hide");
        $("#modal-body-3").html(`<p class="text-center">${res}</p>`);
          $("#myModal3").modal("show");
          $("#myModal3").on("hidden.bs.modal", function () {
          editarNucleos();
          
        });
        
      })
      .fail(function (error) {
        manejoErrores(error);
      });
  
} 
//ver informacion de la suscripcion
function verInf(input) { 
    let id = input;
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });

      },
      url: `/ver_inf?id=${id}`,
      type: 'post'
    })
      .done(function (suscripciones) {
        $("#myModal").modal("hide");

        $("div#modal-body-4").html('');
        $("div#tutor").html('');
        $("#myLabel").html('Información de la suscripción');
        $("div#modal-body-4").html(`
           <form>
             <div style="height:50px;">
              <div class="form-group row">
             <label for="id1" class="col-sm-2 col-form-label">Tipo</label>
             <div class="col-sm-10">
             <input value="${suscripciones.suscripciones.tipo}"  type="text" class="tooltips-general material-control"  class="form-control " id="id1" readonly>
             </div>
             </div>
             <div class="form-group row">
             <label for="id1" class="col-sm-2 col-form-label">Correo electrónico</label>
             <div class="col-sm-10">
             <input value="${suscripciones.suscripciones.correo_s}"  type="text" class="tooltips-general material-control"  class="form-control " id="id1" readonly>
             </div>
             </div>
             <div class="form-group row">
             <label for="id2" class="col-sm-2 col-form-label">Fecha de vencimiento</label>
             <div class="col-sm-10">
             <input value="${suscripciones.suscripciones.fecha_c}" type="text" class="tooltips-general material-control" class="form-control" id="id2" readonly>
             </div>
             </div>
             
             <p class="text-center"> <a onclick="verPDF(this)" role="button" class="btn btn-large btn-primary"  style="background:rgb(45, 101, 206);" id="comprobante${suscripciones.suscripciones.id}" data_url="${suscripciones.suscripciones.comprobante}" data_titulo=${suscripciones.suscripciones.tipo}">Ver comprobante </a></p>
           </div>
           <br>
           <br>
           <br>
         
             
             </form>
   
           `);
   
        $("div#myModal4").modal('show');
        })
       .fail(function (error) {
         manejoErrores(error);
       });
  }
   //se aprueba una reserva
 //funcion para eliminar una suscripcion
 function eliminarSolicitud(input) {
  
  let id= input;
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });

      },
      url: `/bibliotecario/eliminarSus?id=${id}`,
      type: 'delete'
    })
      .done(function (res) {
        $("#myModal").modal("hide");
        $("#modal-body-3").html(`<p class="text-center">${res}</p>`);
          $("#myModal3").modal("show");
          if (res === 'Eliminada con éxito') {
         $("#myModal3").on("hidden.bs.modal", function () {
          suscripcionesV();
          
         });
          } 
        
      })
      .fail(function (error) {
        manejoErrores(error);
      });
  
} 

///función para aprobar una suscripción
function aprobarS(input) {
  
  let id= input;
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });

      },
      url: `/bibliotecario/aprobarS?id=${id}`,
      type: 'post'
    })
      .done(function (res) {
        $("#myModal").modal("hide");
        $("#modal-body-3").html(`<p class="text-center">${res}</p>`);
          $("#myModal3").modal("show");
          if (res === 'Se ha aprobado con éxito') {
         $("#myModal3").on("hidden.bs.modal", function () {
          suscripcionesP();
          
         });
          } 
        
      })
      .fail(function (error) {
        manejoErrores(error);
      });
  
} 



///
function eliminarSolicitudP(input) {
  
  let id= input;
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });

      },
      url: `/bibliotecario/eliminarSusP?id=${id}`,
      type: 'delete'
    })
      .done(function (res) {
        $("#myModal").modal("hide");
        $("#modal-body-3").html(`<p class="text-center">${res}</p>`);
          $("#myModal3").modal("show");
          if (res === 'Eliminada con éxito') {
         $("#myModal3").on("hidden.bs.modal", function () {
          suscripcionesP();
          
         });
          } 
          
        
      })
      .fail(function (error) {
        manejoErrores(error);
      });
  
} 



//suscripciones pendientes
function suscripcionesP() {
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/bibliotecario/suscripcionesP",
      type: "GET",
    })
      .done(function (suscripciones) {
        $("#myModal").modal("hide");
        $("div#confDias").hide();
        $("div#preguntasF").hide();
        $("#container").show();
        $("div#explicacion").show();
        $("form#nuevaBaseE").hide();

        $("div#editarLibro").hide();
        $("div#enlaces").show();
        $("form#nuevaBaseD").hide();
        $("form#conf-nucleos").hide();
    $("form#conf-categorias").hide();
   
        $("div#inicio").hide();
        $("div#cargando").html('');
        $("form#ingresarLibro").hide();
        $("form#formato").hide();
        $("div#seccion").html(` 
                <div class="page-header">
                <h1 class="all-tittles">UNEXPO SBDIP <small>Suscripciones pendientes</small></h1>
               </div>`);
        $("div#enlaces").html(`
            <ul class="nav nav-tabs nav-justified" style="font-size: 17px;">
                <li id="susP" class="active"><a href="javascript:suscripcionesP()">Suscripciones pendientes</a></li>
                <li id="susA"><a href="javascript:suscripcionesV()">Suscripciones vigentes</a></li>
            </ul>`);
        $("li#susA").removeClass("active");
        $("li#susP").addClass("active");
        $("div#explicacion").html(`
          <div class="row">
                <div class="col-xs-12 col-sm-4 col-md-3">
                  <img src="/assets/img/calendar_book.png" alt="calendar" class="img-responsive center-box"
                        style="max-width: 110px;">
                </div>
                <div class="col-xs-12 col-sm-8 col-md-8 text-justify lead">
                    Bienvenido a esta sección, aquí deberás revisar cada solicitud de suscripción para posteriormente ser aprobada.
                </div>
          </div>`);
        $("div#container").html('');
        if (suscripciones.suscripciones.length > 0) {
          $("div#container").append(`
                 
                <h2 class="text-center all-tittles">Suscripciones pendientes</h2>
                <div class="table-responsive">
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                            <div class="div-table-cell" style="width: 3%;">#</div>
                            <div class="div-table-cell" style="width: 15%;">Suscripción</div>
                            <div class="div-table-cell" style="width: 22%;">Correo</div>
    
                            <div class="div-table-cell" style="width: 8%;">Ver info.</div>
                            <div class="div-table-cell" style="width: 8%;">Aprobar</div>
                            <div class="div-table-cell" style="width: 8%;">Eliminar</div>
                        </div>
                    </div>
                </div>
                `);

          for (var i = 0; i < suscripciones.suscripciones.length; i++) {
            $("div#container").append(`
                        <div class="table-responsive" id='s_${suscripciones.suscripciones[i].id
              }'>
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list">
                            <div class="div-table-cell" style="width: 3%;">${1 + i
              }</div>
                            <div class="div-table-cell" style="width: 15%;">${suscripciones.suscripciones[i].tipo
              }</div>
                            <div class="div-table-cell" style="width: 22%;">${suscripciones.suscripciones[i].correo_s
              }</div>
                            <div class="div-table-cell" style="width: 8%;"><button onclick="verInf('${suscripciones.suscripciones[i].id}')" class="btn btn-info"><i class="zmdi zmdi-file-text"></i></button></div>
                            
                            
    
                                <div class="div-table-cell" style="width: 8%;">
                                <button onclick="aprobarS('${suscripciones.suscripciones[i].id}')" class="btn btn-success" ><i class="zmdi zmdi-time-restore"></i></button>

    
                            </div>
                            <div class="div-table-cell"  style="width: 8%;">
                            <button onclick="eliminarSolicitudP('${suscripciones.suscripciones[i].id
              }')" class="btn btn-danger"><i
                                    class="zmdi zmdi-delete"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
            
                        `);
          }
        } else {
          $("div#container").append(`
                            <div class="container-fluid">
                    <h3 class="text-center all-tittles">No hay solicitudes pendientes</h3>
                </div>
          
                            `);

        }

        $("div#myModal").modal("hide");
      })
      .fail(function (error) {
        manejoErrores(error)
      });
  }

//suscripciones activas

function suscripcionesV() {
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/bibliotecario/suscripcionesV",
      type: "GET",
    })
      .done(function (suscripciones) {
        let container = document.getElementById("container");
        $("#myModal").modal("hide");
        $("div#confDias").hide();
        $("div#preguntasF").hide();
        $("#container").show();
        $("div#explicacion").show();
        $("form#nuevaBaseE").hide();

        $("div#editarLibro").hide();
        $("div#enlaces").show();
        $("form#nuevaBaseD").hide();
        $("form#conf-nucleos").hide();
    $("form#conf-categorias").hide();
   
        $("div#inicio").hide();
        $("div#cargando").html('');
        $("form#ingresarLibro").hide();
        $("form#formato").hide();
        $("div#seccion").html(` 
                <div class="page-header">
                <h1 class="all-tittles">UNEXPO SBDIP <small>Suscripciones vigentes</small></h1>
               </div>`);
        $("div#enlaces").html(`
            <ul class="nav nav-tabs nav-justified" style="font-size: 17px;">
                <li id="susP" class="active"><a href="javascript:suscripcionesP()">Suscripciones pendientes</a></li>
                <li id="susA"><a href="javascript:suscripcionesV()">Suscripciones vigentes</a></li>
            </ul>`);
        $("li#susP").removeClass("active");
        $("li#susA").addClass("active");
        $("div#explicacion").html(`
          <div class="row">
                <div class="col-xs-12 col-sm-4 col-md-3">
                  <img src="/assets/img/calendar_book.png" alt="calendar" class="img-responsive center-box"
                        style="max-width: 110px;">
                </div>
                <div class="col-xs-12 col-sm-8 col-md-8 text-justify lead">
                    Bienvenido a esta sección, aquí se encuentran las suscripciones actualmente vigentes.
                </div>
          </div>`);
        container.innerHTML = '';
        if (suscripciones.suscripciones.length > 0) {
          container.innerHTML = `
                 
                <h2 class="text-center all-tittles">Suscripciones vigentes</h2>
                <div class="table-responsive">
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                            <div class="div-table-cell" style="width: 3%;">#</div>
                            <div class="div-table-cell" style="width: 15%;">Suscripción</div>
                            <div class="div-table-cell" style="width: 22%;">F. Vencimiento</div>
                           
    
                            <div class="div-table-cell" style="width: 8%;">Ver info.</div>
                            <div class="div-table-cell" style="width: 8%;">Eliminar</div>
                        </div>
                    </div>
                </div>
                `;

          for (var i = 0; i < suscripciones.suscripciones.length; i++) {
            $("#container").append(`
                        <div class="table-responsive" id='s_${suscripciones.suscripciones[i].id
              }'>
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list">
                            <div class="div-table-cell" style="width: 3%;">${1 + i
              }</div>
                            <div class="div-table-cell" style="width: 15%;">${suscripciones.suscripciones[i].tipo
              }</div>
                            <div class="div-table-cell" style="width: 22%;">${suscripciones.suscripciones[i].fecha_c
              }</div>
                           
              
    
                                <div class="div-table-cell" style="width: 8%;">
                                <button onclick="verInf('${suscripciones.suscripciones[i].id}')" class="btn btn-info"><i class="zmdi zmdi-file-text"></i></button>
    
                            </div>
                            <div class="div-table-cell"  style="width: 8%;">
                            <button onclick="eliminarSolicitud('${suscripciones.suscripciones[i].id
              }')" class="btn btn-danger"><i
                                    class="zmdi zmdi-delete"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
            
                        `);
          }
        } else {
          $("div#container").append(`
                            <div class="container-fluid">
                    <h3 class="text-center all-tittles">No hay solicitudes pendientes</h3>
                </div>
          
                            `);

        }

        $("div#myModal").modal("hide");
      })
      .fail(function (error) {
        manejoErrores(error)
      });
  }



  function seccionInicio() {
   
    var seccion = document.getElementById("seccion");
    var explicacion = document.getElementById("explicacion");
    var enlaces = document.getElementById("enlaces");
    var inicio = document.getElementById("inicio");
    var container = document.getElementById("container");
    var cargando = document.getElementById("cargando");
    var confDias = document.getElementById("confDias");
    var formNoticias = document.getElementById("infNoticia");
    var formato = document.getElementById("formato");
    formato.style.display = 'none';
    enlaces.style.display = 'none';
    formNoticias.style.display = 'none';
    $("div#editarLibro").hide();
    $("form#preguntasFrecuentes").hide();
    $("form#nuevaBaseE").hide();
    $("form#nuevaBaseD").hide();
    $("button#opcion2").hide();
    $("form#conf-nucleos").hide();
    $("form#conf-categorias").hide();
   
    seccion.innerHTML = ` <div class="page-header">
                <h1 class="all-tittles">
                    UNEXPO SBDIP <small>Inicio</small>
                </h1>
            </div>`;
    explicacion.style.display = 'none';
    cargando.innerHTML = '';
    // formatoEnLinea.style.display = 'none';
    confDias.style.display = 'none';
    inicio.style.display = 'block';

    //busquedaC.style.display = 'none';
    cargando.innerHTML = '';
    container.innerHTML = '';
    let boton = $("#opcion1").html();
    if (boton == 'Volver') {
      $("#opcion1").click;
    }
    mostrarNoticias();

  };

  function prestamosVV() {
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/bibliotecario/prestamosVVAjax",
      type: "GET",
    })
      .done(function (fichas) {
        $("div#myModal").modal("hide");
        $("div#confDias").hide();
        $("div#preguntasF").hide();
        $("#container").show();
        $("div#editarLibro").hide();
        $("div#enlaces").show();
        $("div#explicacion").show();
        $("form#nuevaBaseE").hide();
        $("form#conf-nucleos").hide();
    $("form#conf-categorias").hide();
   
        $("form#nuevaBaseD").hide();
        $("div#inicio").hide();
        $("div#cargando").html('');
        $("form#ingresarLibro").hide();
        $("div#editarLibro").hide();
        $("form#formato").hide();
        $("div#seccion").html(` 
                <div class="page-header">
                <h1 class="all-tittles">UNEXPO SBDIP <small>Préstamos pendientes</small></h1>
               </div>`);
        $("div#enlaces").html(`
            <ul class="nav nav-tabs nav-justified" style="font-size: 17px;">
                <li id="prestamosE" class="active"><a href="javascript:prestamosE()">Préstamos
                        entregados</a></li>
                <li id="prestamosVV"><a href="javascript:prestamosVV()">Préstamos pendientes</a></li>
                <li id="prestamosP"><a href="javascript:prestamosP()">Reservaciones</a></li>
            </ul>`);
        $("li#prestamosP").removeClass("active");
        $("li#prestamosVV").addClass("active");
        $("li#prestamosE").removeClass("active");
        $("div#explicacion").html(`
          <div class="row">
                <div class="col-xs-12 col-sm-4 col-md-3">
                    <img src="/assets/img/calendar_book.png" alt="calendar" class="img-responsive center-box"
                        style="max-width: 110px;">
                </div>
                <div class="col-xs-12 col-sm-8 col-md-8 text-justify lead">
                    Bienvenido a esta sección, aquí se muestran todos los préstamos de libros realizados hasta la
                    fecha y que ya se entregaron satisfactoriamente
                </div>
          </div>`);
        $("div#container").html("");
        if (fichas.fichas.length > 0) {
          $("div#container").append(`
                 
                <h2 class="text-center all-tittles">Listado de préstamos</h2>
                <div class="table-responsive">
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                            <div class="div-table-cell" style="width: 3%;">#</div>
                            <div class="div-table-cell" style="width: 15%;">Cota</div>
                            <div class="div-table-cell" style="width: 22%;">Correo</div>
    
                            <div class="div-table-cell" style="width: 15%;">F. Solicitud</div>
                            <div class="div-table-cell" style="width: 15%;">F. Entrega</div>
                            <div class="div-table-cell" style="width: 8%;">Ver Ficha</div>
                            <div class="div-table-cell" style="width: 8%;">Recibir</div>
                        </div>
                    </div>
                </div>
                `);

          for (var i = 0; i < fichas.fichas.length; i++) {
            $("div#container").append(`
                        <div class="table-responsive" id='table_${fichas.fichas[i].cota_f
              }'>
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list">
                            <div class="div-table-cell" style="width: 3%;">${1 + i
              }</div>
                            <div class="div-table-cell" style="width: 15%;">${fichas.fichas[i].cota_f
              }</div>
                            <div class="div-table-cell" style="width: 22%;">${fichas.fichas[i].correo_f
              }</div>
                            <div class="div-table-cell" style="width: 15%;">${fichas.fichas[i].fecha_e
              }</div>
                            <div class="div-table-cell" style="width: 15%;" id="fecha-d${fichas.fichas[i].cota_f}">${fichas.fichas[i].fecha_d
              }</div>
                           
                            <div class="div-table-cell" style="width: 8%;">
                                <button onclick="verFicha('${fichas.fichas[i].cota_f}')" class="btn btn-info"><i class="zmdi zmdi-file-text"></i></button>
                            </div>
                             <div class="div-table-cell" id='button_${fichas.fichas[i].cota_f
              }' style="width: 8%;">
    
                                <button id='${fichas.fichas[i].cota_f
              }' onclick="recibir('${fichas.fichas[i].cota_f
              }', '${fichas.fichas[i].multa
              }')" class="btn btn-success"><i
                                        class="zmdi zmdi-time-restore"></i></button>
    
                            </div>
                        </div>
                    </div>
                </div>
            
                        `);

            sobresaltarFecha(fichas, i);
          }
        } else {
          $("div#container").append(`
                            <div class="container-fluid">
                    <h3 class="text-center all-tittles">No hay préstamos pendientes</h3>
                </div>
          
                            `);
        }


      })

      .fail(function (error) {
        manejoErrores(error)
      });
  }

  function prestamosE() {
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/bibliotecario/prestamosAjax",
      type: "GET",
    })
      .done(function (fichas) {
        $("#myModal").modal("hide");
        $("div#confDias").hide();
        $("div#preguntasF").hide();
        $("#container").show();
        $("div#explicacion").show();
        $("form#nuevaBaseE").hide();

        $("div#editarLibro").hide();
        $("div#enlaces").show();
        $("form#nuevaBaseD").hide();
        $("form#conf-nucleos").hide();
    $("form#conf-categorias").hide();
   
        $("div#inicio").hide();
        $("div#cargando").html('');
        $("form#ingresarLibro").hide();
        $("form#formato").hide();
        $("div#seccion").html(` 
                <div class="page-header">
                <h1 class="all-tittles">UNEXPO SBDIP <small>Préstamos entregados</small></h1>
               </div>`);
        $("div#enlaces").html(`
            <ul class="nav nav-tabs nav-justified" style="font-size: 17px;">
                <li id="prestamosE" class="active"><a href="javascript:prestamosE()">Préstamos
                        entregados</a></li>
                <li id="prestamosVV"><a href="javascript:prestamosVV()">Préstamos pendientes</a></li>
                <li id="prestamosP"><a href="javascript:prestamosP()">Reservaciones</a></li>
            </ul>`);
        $("li#prestamosP").removeClass("active");
        $("li#prestamosVV").removeClass("active");
        $("li#prestamosE").addClass("active");
        $("div#explicacion").html(`
          <div class="row">
                <div class="col-xs-12 col-sm-4 col-md-3">
                    <img src="/assets/img/calendar_book.png" alt="calendar" class="img-responsive center-box"
                        style="max-width: 110px;">
                </div>
                <div class="col-xs-12 col-sm-8 col-md-8 text-justify lead">
                    Bienvenido a esta sección, aquí se muestran todos los préstamos de libros realizados hasta la
                    fecha y que ya se entregaron satisfactoriamente
                </div>
          </div>`);
        $("div#container").html('');
        if (fichas.fichas.length > 0) {
          $("div#container").append(`
                 
                <h2 class="text-center all-tittles">Listado de préstamos</h2>
                <div class="table-responsive">
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                            <div class="div-table-cell" style="width: 3%;">#</div>
                            <div class="div-table-cell" style="width: 15%;">Cota</div>
                            <div class="div-table-cell" style="width: 22%;">Correo</div>
    
                            <div class="div-table-cell" style="width: 15%;">F. Solicitud</div>
                            <div class="div-table-cell" style="width: 15%;">F. Entrega</div>
                            <div class="div-table-cell" style="width: 8%;">Ver Ficha</div>
                            <div class="div-table-cell" style="width: 8%;">Eliminar</div>
                        </div>
                    </div>
                </div>
                `);

          for (var i = 0; i < fichas.fichas.length; i++) {
            $("div#container").append(`
                        <div class="table-responsive" id='t_${fichas.fichas[i].cota_f
              }'>
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list">
                            <div class="div-table-cell" style="width: 3%;">${1 + i
              }</div>
                            <div class="div-table-cell" style="width: 15%;">${fichas.fichas[i].cota_f
              }</div>
                            <div class="div-table-cell" style="width: 22%;">${fichas.fichas[i].correo_f
              }</div>
                            <div class="div-table-cell" style="width: 15%;">${fichas.fichas[i].fecha_e
              }</div>
                            <div class="div-table-cell" style="width: 15%;">${fichas.fichas[i].fecha_c
              }</div>
                            
    
                                <div class="div-table-cell" style="width: 8%;">
                                <button onclick="verFichaE('${fichas.fichas[i].cota_f}')" class="btn btn-info"><i class="zmdi zmdi-file-text"></i></button>
    
                            </div>
                            <div class="div-table-cell" id='button_${fichas.fichas[i].cota_f
              }' style="width: 8%;">
                            <button onclick="eliminarFichaEntregada('${fichas.fichas[i].cota_f
              }')" class="btn btn-danger"><i
                                    class="zmdi zmdi-delete"></i></button>
                            </div>
                        </div>
                    </div>
                </div>
            
                        `);
            sobresaltarFecha(fichas, i);
          }
        } else {
          $("div#container").append(`
                            <div class="container-fluid">
                    <h3 class="text-center all-tittles">No hay préstamos entregados </h3>
                </div>
          
                            `);

        }

        $("div#myModal").modal("hide");
      })
      .fail(function (error) {
        manejoErrores(error)
      });
  }

  function prestamosP() {
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/bibliotecario/prestamosPAjax",
      type: "GET",
    })
      .done(function (fichas) {
        $("div#confDias").hide();
        $("form#nuevaBaseE").hide();
        $("form#conf-nucleos").hide();
    $("form#conf-categorias").hide();
   
        $("form#nuevaBaseD").hide();
        $("div#preguntasF").hide();
        $("div#editarLibro").hide();
        $("div#cargando").html('');
        $("div#inicio").hide();
        $("form#ingresarLibro").hide();
        $("div#enlaces").show();
        $("form#formato").hide();
        $("div#editarLibro").hide();
        $("div#explicacion").show();
        $("div#seccion").html(` 
                <div class="page-header">
                <h1 class="all-tittles">UNEXPO SBDIP <small>Reservaciones</small></h1>
               </div>`);
        $("div#enlaces").html(`
            <ul class="nav nav-tabs nav-justified" style="font-size: 17px;">
                <li id="prestamosE" class="active"><a href="javascript:prestamosE()">Préstamos
                        entregados</a></li>
                <li id="prestamosVV"><a href="javascript:prestamosVV()">Préstamos pendientes</a></li>
                <li id="prestamosP"><a href="javascript:prestamosP()">Reservaciones</a></li>
            </ul>`);
        $("div#explicacion").html(`
          <div class="row">
                <div class="col-xs-12 col-sm-4 col-md-3">
                    <img src="/assets/img/calendar_book.png" alt="calendar" class="img-responsive center-box"
                        style="max-width: 110px;">
                </div>
                <div class="col-xs-12 col-sm-8 col-md-8 text-justify lead">
                    Bienvenido a esta sección, aquí se muestran todos los préstamos de libros realizados hasta la
                    fecha y que ya se entregaron satisfactoriamente
                </div>
          </div>`);
        $("li#prestamosP").addClass("active");
        $("li#prestamosVV").removeClass("active");
        $("li#prestamosE").removeClass("active");
        $("div#container").html('');
        $("div#myModal").modal("hide");
        $("#container").show();
        if (fichas.fichas.length > 0) {
          $("div#container").append(`
                 
                <h2 class="text-center all-tittles">Listado de reservaciones</h2>
                <div class="table-responsive">
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                            <div class="div-table-cell" style="width: 3%;">#</div>
                            <div class="div-table-cell" style="width: 15%;">Cota</div>
                            <div class="div-table-cell" style="width: 22%;">Correo</div>
    
                            <div class="div-table-cell" style="width: 15%;">F. Solicitud</div>
                            <div class="div-table-cell" style="width: 15%;">F. Entrega</div>
                            <div class="div-table-cell" style="width: 8%;">Ver Ficha</div>
                            <div class="div-table-cell" style="width: 8%;">Aprobar</div>
                            
                        </div>
                    </div>
                </div>
                `);

          for (var i = 0; i < fichas.fichas.length; i++) {
            $("div#container").append(`
                        <div class="table-responsive" id='table_${fichas.fichas[i].cota_f
              }'>
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list">
                            <div class="div-table-cell" style="width: 3%;">${1 + i
              }</div>
                            <div class="div-table-cell" style="width: 15%;">${fichas.fichas[i].cota_f
              }</div>
                            <div class="div-table-cell" style="width: 22%;">${fichas.fichas[i].correo_f
              }</div>
                            <div id="fe-${fichas.fichas[i].cota_f
              }" class="div-table-cell"  style="width: 15%;">${fichas.fichas[i].fecha_e
              } </div>
                            <div class="div-table-cell" style="width: 15%;">${fichas.fichas[i].fecha_d
              }</div>
                          <div class="div-table-cell" style="width: 8%;">
                                <button onclick="verFicha('${fichas.fichas[i].cota_f}')" class="btn btn-info"><i class="zmdi zmdi-file-text"></i></button>
                            </div> 
                              <div class="div-table-cell" id='button_${fichas.fichas[i].cota_f
              }' style="width: 8%;">
    
                                <button id='${fichas.fichas[i].cota_f
              }' onclick="aprobar('${fichas.fichas[i].cota_f}', '${fichas.fichas[i].fecha_e}')" class="btn btn-success"><i
                                        class="zmdi zmdi-time-restore"></i></button>
    
                            </div>
                           
                        </div>
                    </div>
                </div>
            
                        `);
            sobresaltarFecha(fichas, i);
          }
        } else {
          $("div#container").append(`
                            <div class="container-fluid">
                    <h3 class="text-center all-tittles">No hay reservaciones </h3>
                </div>
          
                            `);
        }

        $("div#myModal").modal("hide");
      })
      .fail(function (error) {
        manejoErrores(error);
      });
  }
  function seccionConfDias() {

    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(` <img src="/assets/gif/loading-22.gif" width="100" height="100" />`);
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/bibliotecario/conf-dias",
      type: "GET",
    })
      .done(function (res) {
        $("div#myModal").modal("hide");
        $("form#nuevaBaseE").hide();
        $("form#nuevaBaseD").hide();
        $("form#conf-nucleos").hide();
    $("form#conf-categorias").hide();
   
        $("#container").html('');

        $("div#explicacion").show();
        $("div#preguntasF").hide();

        $("div#seccion").html(`<div class="page-header">
                <h1  class="all-tittles">UNEXPO SBDIP <small>Límite de días y libros</small></h1>
            </div>`);
        $("div#enlaces").hide();
        $("div#cargando").html('');
        $("div#explicacion").html(`<div class="row">
                 
                 <div class="col-xs-12 col-sm-4 col-md-3">
                     <img src="/assets/icons/libro-lomo.ico" alt="pdf" class="img-responsive center-box" style="max-width: 110px;">
                 </div>
                 <div class="col-xs-12 col-sm-8 col-md-8 text-justify lead" >
                     Bienvenido en esta sección podrás configurar el límite para la cantidad de libros a retirar, días del préstamo y vigencia de cada suscripción en días. Si existen valores guardados actualmente, se mostrarán por defecto.
                 </div>
             </div>`);
        $("div#inicio").hide();
        $("div#cargando").html('');
        $("form#formato").hide();
        $("div#container").hide();;
        $("div#editarLibro").hide();
        if (res.objeto) {
          $("input#input-cantidad").attr("value", res.objeto.cantidad_libros);
          $("input#input-dias").attr("value", res.objeto.dias_prestamo);
          $("input#input-multa").attr("value", res.objeto.multa);
          $("input#input-unidad").attr("value", res.objeto.unidad);
          $("input#input-tiempo").attr("value", res.objeto.tiempo);
        }
        $("div#confDias").show();
        $("form#Dias").show();
      })
      .fail(function (error) {
        manejoErrores(error)
      })
  }
 
  function añadirCategorias() {

    $("div#myModal").modal("hide");
    
    $("form#nuevaBaseE").hide();
    $("form#nuevaBaseD").hide();
    $("#container").html('');

    $("div#explicacion").show();
    $("div#preguntasF").hide();

    $("div#seccion").html(`<div class="page-header">
            <h1  class="all-tittles">UNEXPO SBDIP <small>Opciones</small></h1>
        </div>`);
    $("div#enlaces").hide();
    $("div#cargando").html('');
    $("div#explicacion").html(`<div class="row">
             
             <div class="col-xs-12 col-sm-4 col-md-3">
                 <img src="/assets/icons/libro-lomo.ico" alt="pdf" class="img-responsive center-box" style="max-width: 110px;">
             </div>
             <div class="col-xs-12 col-sm-8 col-md-8 text-justify lead" >
                 Bienvenido, en esta sección podrás añadir nuevas categorías para material bibliográfico, una vez creadas estan no son editables ni eliminables.
             </div>
         </div>`);
    $("div#inicio").hide();
    $("div#cargando").html('');
    $("form#formato").hide();
    $("div#container").hide();;
    $("div#editarLibro").hide();
  
    $("div#confDias").hide();
    $("form#Dias").hide();
    $("form#conf-nucleos").hide();
    $("form#conf-categorias").show();
  
}
function añadirNucleos() {

$("div#myModal").modal("hide");

$("form#nuevaBaseE").hide();
$("form#nuevaBaseD").hide();
$("#container").html('');

$("div#explicacion").show();
$("div#preguntasF").hide();

$("div#seccion").html(`<div class="page-header">
        <h1  class="all-tittles">UNEXPO SBDIP <small>Opciones</small></h1>
    </div>`);
$("div#enlaces").hide();
$("div#cargando").html('');
$("div#explicacion").html(`<div class="row">
         
         <div class="col-xs-12 col-sm-4 col-md-3">
             <img src="/assets/icons/libro-lomo.ico" alt="pdf" class="img-responsive center-box" style="max-width: 110px;">
         </div>
         <div class="col-xs-12 col-sm-8 col-md-8 text-justify lead" >
             Bienvenido en esta sección podrás añadir nuevos núcleos, los nucleos que existen no son eliminables ni editables.
         </div>
     </div>`);
$("div#inicio").hide();
$("div#cargando").html('');
$("form#formato").hide();
$("div#container").hide();;
$("div#editarLibro").hide();

$("div#confDias").hide();
$("form#Dias").hide();
$("form#conf-nucleos").show();
$("form#conf-categorias").hide();

}

  function añadirMaterial() {
    var formato = document.getElementById("formato");
    formato.style.display = 'block';
    resetear();
    $("div#confDias").hide();
    $("form#conf-nucleos").hide();
    $("form#conf-categorias").hide();
   
    $("form#nuevaBaseE").hide();
    $("form#nuevaBaseD").hide();
    $("#enlaces").hide();
    $("div#explicacion").show();
    $("div#preguntasF").hide();
    $("div#cargando").html('');
    $("div#inicio").hide();
    $("div#explicacion").html(`
          <div class="row">
                <div class="col-xs-12 col-sm-4 col-md-3">
                  <img src="/assets/icons/libros.ico" alt="pdf" class="img-responsive center-box" style="max-width: 110px;">
                </div>
                <div class="col-xs-12 col-sm-8 col-md-8 text-justify lead">
                  Bienvenido a la sección para agregar nuevos libros a la biblioteca, deberas de llenar todos los campos para poder registrar el libro. Puedes registrar uno o varios libros con el mismo archivo PDF.
                </div>
          </div>`);
    $("div#container").html("");
    $("div#seccion").html(` 
                <div class="page-header">
                  <h1  class="all-tittles">UNEXPO SBDIP <small>Libros</small></h1>
               </div>`);
    $("div#editarLibro").hide();

  }
  function editarLibro() {
    var ocultar = document.getElementById("ocultar");
    var isChecked = ocultar.checked;
    if (isChecked) {
      ocultar.click();
    }
    $("form#formato").hide();
    $("form#nuevaBaseE").hide();
    $("#enlaces").hide();
    $("#container").show();
    $("div#explicacion").show();
    $("form#nuevaBaseD").hide();
    $("div#preguntasF").hide();
    $("div#confDias").hide();
    $("div#inicio").hide();
    $("div#explicacion").html(`
          <div class="row">
            <div class="col-xs-12 col-sm-4 col-md-3">
                    <img src="/assets/icons/busqueda.ico" alt="pdf" class="img-responsive center-box" style="max-width: 110px;">
                </div>
                <div class="col-xs-12 col-sm-8 col-md-8 text-justify lead" >
                    Bienvenido en esta sección podrás ver, editar y eliminar libros. Así como también, realizar una busqueda en especifico o verlos todos.
                </div>
          </div>`);
    $("div#container").html("");
    $("form#formato-enlinea").show();
    $("div#seccion").html(` 
                <div class="page-header">
                  <h1  class="all-tittles">UNEXPO SBDIP <small>Libros</small></h1>
               </div>`);
    $("div#cargando").html('');
    $("div#editarLibro").show();

  }
  function seccionPreguntas() {
    $("form#formato").hide();
    
    $("form#conf-nucleos").hide();
    $("form#conf-categorias").hide();
    $("form#nuevaBaseE").hide();
    $("form#nuevaBaseD").hide();
    $("div#confDias").hide();
    $("div#inicio").hide();
    $("button#opcion2").show();
    $("form#preguntasFrecuentes").hide();
    $("div#cargando").html('');
    $("div#enlaces").html('');
    $("div#seccion").html(` 
            <div class="page-header">
        <h1 class="all-tittles">UNEXPO SBDIP <small>Preguntas frecuentes</small></h1>
      </div>`);
    $("div#explicacion").hide();
    $("form#formato-enlinea").hide();
    $("div#busquedaC").hide();
    $("div#editarLibro").hide();
    $("div#accordion").show();
    $("div#container").html('');
    $("div#preguntasF").show();

    mostrarPreguntas();

  }
  function seccionPreguntas2() {
    $("form#formato").hide();
    
    $("form#conf-nucleos").hide();
    $("form#conf-categorias").hide();
    $("form#nuevaBaseE").hide();
    $("form#nuevaBaseD").hide();
    $("div#confDias").hide();
    $("div#inicio").hide();
    $("button#opcion2").hide();
    $("form#preguntasFrecuentes").hide();
    $("div#cargando").html('');
    $("div#enlaces").html('');
    $("div#seccion").html(` 
            <div class="page-header">
        <h1 class="all-tittles">UNEXPO SBDIP <small>Preguntas frecuentes</small></h1>
      </div>`);
    $("div#explicacion").hide();
    $("form#formato-enlinea").hide();
    $("div#busquedaC").hide();
    $("div#editarLibro").hide();
    $("div#accordion").show();
    $("div#container").html('');
    $("div#preguntasF").show();

    mostrarPreguntas();

  }
  function actualizarBaseE() {
    $("form#formato").hide();
    
    $("form#conf-nucleos").hide();
    $("form#conf-categorias").hide();
    $("form#nuevaBaseE").show();
    $("div#accordion").html('');

    $("div#explicacion").show();

    $("form#nuevaBaseD").hide();
    $("div#confDias").hide();
    $("div#inicio").hide();
    $("button#opcion2").hide();
    $("form#preguntasFrecuentes").hide();
    $("div#cargando").html('');
    $("div#enlaces").html('');
    $("div#seccion").html(` 
            <div class="page-header">
        <h1 class="all-tittles">UNEXPO SBDIP <small>Actualiza la base de datos</small></h1>
      </div>`);
    $("div#explicacion").html(`
          <div class="row">
                <div class="col-xs-12 col-sm-4 col-md-3">
                    <img src="/assets/icons/user.ico" alt="calendar" class="img-responsive center-box"
                        style="max-width: 110px;">
                </div>
                <div class="col-xs-12 col-sm-8 col-md-8 text-justify lead">
                    Bienvenido, en esta sección podrás actualizar la base de datos de los estudiantes. Recuerda que el sistema está diseñado para registrar las columnas en el orden en que se encuntran en la base de datos.
                </div>
          </div>`);
    $("form#formato-enlinea").hide();
    $("div#busquedaC").hide();
    $("div#editarLibro").hide();

    $("div#container").html('')
  }

  function actualizarBaseD() {
    $("form#formato").hide();
    $("form#nuevaBaseD").show();
    $("form#conf-nucleos").hide();
    $("form#conf-categorias").hide();

    $("div#accordion").html('');
    $("form#nuevaBaseE").hide();
    $("div#confDias").hide();
    $("div#inicio").hide();
    $("div#explicacion").show();
    $("button#opcion2").hide();
    $("form#preguntasFrecuentes").hide();
    $("div#cargando").html('');
    $("div#enlaces").html('');
    $("div#seccion").html(` 
            <div class="page-header">
        <h1 class="all-tittles">UNEXPO SBDIP <small>Actualiza la base de datos</small></h1>
      </div>`);
    $("div#explicacion").html(`
          <div class="row">
                <div class="col-xs-12 col-sm-4 col-md-3">
                    <img src="/assets/icons/user.ico" alt="calendar" class="img-responsive center-box"
                        style="max-width: 110px;">
                </div>
                <div class="col-xs-12 col-sm-8 col-md-8 text-justify lead">
                    Bienvenido, en esta sección podrás actualizar la base de datos de los docentes. Recuerda que el sistema está diseñado para registrar las columnas en el orden en que se encuntran en la base de datos.
                </div>
          </div>`);

    $("form#formato-enlinea").hide();
    $("div#busquedaC").hide();
    $("div#editarLibro").hide();

    $("div#container").html('')
  }

</script>

<script>

  $(function () {
    seccionInicio();
    $("#resetNucleo").on('click', function () {
      $(".limpiar").html('');
          let id ='nucleo';
      let tb = `table#tb${id}`;
      $(tb).html("");
        $(tb).append(`
        <tr>
                        <td style="width: 40px; overflow: hidden; border: none;">
                          <input id="${id}1" name="${id}1" type="number"  class="material-control material-control-login" 
                            placeholder="${id}.1" required="" maxlength="4" data-toggle="tooltip" data-placement="top"
                             value="1">
                          <span class="highlight"></span>
                          <span class="bar"></span>
                          <label> </label>
                        </td>
                        <td style="width: 150px; overflow: hidden; border: none;">
                          <input id="${id}-1"  name="${id}_1" type="text"
                          class="material-control material-control-login"  placeholder="Escribe aquí el ${id}" onkeyup="comp(this)"
                            required="" maxlength="100"
                            pattern="(^([a-zA-Zá-ú]{1,})$)"
                            data-toggle="tooltip" data-placement="top" >
                          <span class="highlight"></span>
                          <span class="bar"></span>
                          <label> </label>
    
                        </td>
                        <td id="imgs-${id}" style="width: 20px; overflow: hidden; border: none;">
                          <div  class="limpiar" id="img-${id}-1"></div>
                        </td>
                      </tr>
                      <tr>
                        <td style="width: 40px; overflow: hidden; border: none;"></td>
                        <td id="mensaje-${id}" style="width: 150px; border: none; overflow: hidden;">
                          <div class="limpiar" id="${id}-unica-1"></div>
                        </td>
                        <td style="width: 20px; border: none; overflow: hidden;"></td>
                      </tr>
    
                                
                    `);
     
    });
    $("#resetCategoria").on('click', function () {
      $(".limpiar").html('');
      let id='categoria';
      let tb = `table#tb${id}`
      $(tb).html("");
        $(tb).append(`
        <tr>
                        <td style="width: 40px; overflow: hidden; border: none;">
                          <input id="${id}1" name="${id}1" type="number"  class="material-control material-control-login" 
                            placeholder="${id}.1" required="" maxlength="4" data-toggle="tooltip" data-placement="top"
                             value="1">
                          <span class="highlight"></span>
                          <span class="bar"></span>
                          <label> </label>
                        </td>
                        <td style="width: 150px; overflow: hidden; border: none;">
                          <input id="${id}-1"  name="${id}_1" type="text"
                          class="material-control material-control-login"  placeholder="Escribe aquí el ${id}" onkeyup="comp(this)"
                            required="" maxlength="100"
                            pattern="(^([a-zA-Zá-ú]{1,})$)"
                            data-toggle="tooltip" data-placement="top" >
                          <span class="highlight"></span>
                          <span class="bar"></span>
                          <label> </label>
    
                        </td>
                        <td id="imgs-${id}" style="width: 20px; overflow: hidden; border: none;">
                          <div  class="limpiar" id="img-${id}-1"></div>
                        </td>
                      </tr>
                      <tr>
                        <td style="width: 40px; overflow: hidden; border: none;"></td>
                        <td id="mensaje-${id}" style="width: 150px; border: none; overflow: hidden;">
                          <div class="limpiar" id="${id}-unica-1"></div>
                        </td>
                        <td style="width: 20px; border: none; overflow: hidden;"></td>
                      </tr>
    
                                
                    `);
     
    });
    $("input#date").attr("max", maxima());
    $("input#date_unico").attr("max", maxima());
    $("form#formDias").on('change', function () {
      $("div#cargando").html('');
    });
    //funcion para enviar el documento excel a la ruta por medio de ajax
    $("form#nuevaBaseE").on('submit', function (e) {
      e.preventDefault();//al ejecutarse el evento submit el formulario se limpia, esta linea de codigo evita este proceso. sino se realiza el formulario se limpia antes de enviarse la informacion
      let data = new FormData(this);//Se toma la informacion del fomulario y se crea un objeto formData, para que este sea enviado en forma de formato y pueda ser procesado por multer

      $.ajax({
        beforeSend: function () {//funcion que se ejecuta mientras que se obtiene respuesta
          $("p#modal-p-center").html(
            '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
          );
          $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });//Se abre ventana modal
        },
        url: "/bibliotecario/nuevaBaseE",//url
        type: "POST",//tipo de ruta
        data: data,//data
        processData: false,
        contentType: false,
      })
        .done(function (res) {
          $("#myModal").modal("hide");
          if (res.message == 'Actualizada con éxito') {//mensaje de respuesta
            $("#modal-body-3").html(`<p class="text-center">${res.message}</p>`);
          $("#myModal3").modal("show");
       $("#reset3").click();//limpieza del formulario
          }
        })
        .fail(function (error) {
          $("#reset3").click();//limpieza del formulario
          manejoErrores(error);//Funcion para manejar el error

        });
    })
    $("form#nuevaBaseD").on('submit', function (e) {
      e.preventDefault();//evita que el formulario se limpie antes de enviar la informacion, el cual es un proceso normal al activarse el evento submit
      let data = new FormData(this);//Se crea un objeto formData, el cual tiene la forma del formato de html, esto es importante porque sino no es reconocido por el middleware multer.js

      $.ajax({
        beforeSend: function () {//funcion que se ejecuta antes de recibir respuesta
          $("p#modal-p-center").html(
            '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
          );
          $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });//se abre ventana modal
        },
        url: "/bibliotecario/nuevaBaseD",//url
        type: "POST",//tipo de ruta
        data: data,//data
        processData: false,
        contentType: false,
      })
        .done(function (res) {
          $("#myModal").modal("hide");
          if (res.message == 'Actualizada con éxito') {//respuesta
            $("#modal-body-3").html(`<p class="text-center">${res.message}</p>`);
          $("#myModal3").modal("show");
         $("#reset4").click();//se limpia el formulario
          }


        })
        .fail(function (error) {
          $("#reset4").click();//se limpia el formulario
          manejoErrores(error);

        });
    })

    $("form#formDias").on('submit', function (e) {
      e.preventDefault();
      let data = new FormData(this);

      $.ajax({
        beforeSend: function () {
          $("div#cargando").html(
            '<p class="text-center"><img src="/assets/gif/loading-22.gif"width= "20" height= "20"></p>'
          );
          $("p#modal-p-center").html(
            '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
          );
          $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });//se abre ventana modal
        },
        url: "/bibliotecario/conf-dias",
        type: "POST",
        data: data,
        processData: false,
        contentType: false,
      })
        .done(function (res) {
          $("div#myModal").modal("hide");
          if (res != '') {
            $("div#cargando").html('<p class="text-center">Se ha configurado con éxito<p>');
          } else {
            $("div#cargando").html(
              `<p class="text-center> Ha ocurrido un error<img src="/assets/icons/notificacion-error.ico"width= "20" height= "20"><p>`
            );
          }
        })
        .fail(function (error) {
          $("div#cargando").html(
            `<p class="text-center> Ha ocurrido un error<img src="/assets/icons/notificacion-error.ico"width= "20" height= "20"><p>`
          );
          manejoErrores(error);
        });
    });
    $("form#nuevaNoticia").on('submit', function (e) {
      e.preventDefault();
      let data = new FormData(this);

      $.ajax({
        beforeSend: function () {
          $("p#modal-p-center").html(
            '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
          );
          $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
        },
        url: "/bibliotecario/nuevaNoticia",
        type: "POST",
        data: data,
        processData: false,
        contentType: false,
      })
        .done(function (res) {
          $("#myModal").modal("hide");
          if (res != '') {
            $("#modal-body-3").html(`<p class="text-center">${res}</p>`);
          $("#myModal3").modal("show");
          
            $("#reset1").click();
          } else if (res == '') {
            $("#modal-body-3").html(`<p class="text-center"><img src="/assets/icons/notificacion-error.ico" width= "100" height= "100"></p>`);
          $("#myModal3").modal("show");
          }
          $("div#myModal3").on('hidden.bs.modal', function () {
            $('button#reset1').click;
            // $('button#opcion1').click;
          });

        })
        .fail(function (error) {
          manejoErrores(error);

        });
    })
    $("form#preguntasFrecuentes").on('submit', function (e) {
      e.preventDefault();
      let data = $(this).serialize();

      $.ajax({
        beforeSend: function () {
          $("p#modal-p-center").html(
            '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
          );
          $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
        },
        url: "/bibliotecario/nueva-p-f",
        type: "POST",
        data: data,
      })
        .done(function (res) {
          $("#myModal").modal("hide");
          if (res != '') {
            $("#modal-body-3").html(`<p class="text-center">${res}</p>`);
          $("#myModal3").modal("show");
      
            $("#reset2").click();
          } else if (res == '') {
            $("#modal-body-3").html(`<p class="text-center"><img src="/assets/icons/notificacion-error.ico" width= "100" height= "100"></p>`);
            $("#myModal3").modal("show");
          }
          $("div#myModal3").on('hidden.bs.modal', function () {
            $('button#reset2').click;
            $('button#opcion2').click;
          });

        })
        .fail(function (error) {
          manejoErrores(error);

        });
    })
    $("form#conf-nucleos").on('submit', function (e) {
      e.preventDefault();
      let data = $(this).serialize();

      $.ajax({
        beforeSend: function () {
          $("p#modal-p-center").html(
            '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
          );
          $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
        },
        url: "/conf-nuevos",
        type: "POST",
        data: data,
      })
        .done(function (res) {
          if (res==='Carga satisfactoria') {
            $("#myModal").modal("hide");
            $("#modal-body-3").html(`<p class="text-center">${res}</p>`);
          $("#myModal3").modal("show");
          $("#myModal3").on("hidden.bs.modal", function () {
            $("#resetNucleo").click();
          
        });

      }
        })
        .fail(function (error) {
          manejoErrores(error);

        });
    })
    $("form#conf-categorias").on('submit', function (e) {
      e.preventDefault();
      let data = $(this).serialize();

      $.ajax({
        beforeSend: function () {
          $("p#modal-p-center").html(
            '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
          );
          $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
        },
        url: "/conf-categorias",
        type: "POST",
        data: data,
      })
        .done(function (res) {
          if (res==='Carga satisfactoria') {
            $("#myModal").modal("hide");
            $("#modal-body-3").html(`<p class="text-center">${res}</p>`);
          $("#myModal3").modal("show");
          $("#myModal3").on("hidden.bs.modal", function () {
          $("#resetCategoria").click();
          
        });

      }
        })
        .fail(function (error) {
          manejoErrores(error);

        });
});

  });
</script>


<body>
  <div id="myModal" class="modal fade"  >
    <div class="modal-dialog modal-sm modal-recarga">
      <div class="modal-content" style="background-color: transparent">
        <div id="modal-contenido">
          <br>
          <p class="text-center" id="modal-p-center">
            <img src="/assets/gif/loading-22.gif" width="100" height="100" />
          </p>
        </div>
      </div>
    </div>
  </div>
  <div id="myModal2" class="modal fade">
    <div class="modal-dialog">
      <div class="modal-content">
        <div class="modal-header">
          <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
        </div>
        <div id="modal-body-2" class="modal-body">

        </div>
      </div>
    </div>
  </div>
  <div id="myModal3" class="modal fade">
    <div class="modal-dialog">
      <div class="container-fluid">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
              &times;
            </button>
          </div>
          <div class="modal-body" id="modal-body-3">

          </div>
        </div>
      </div>
    </div>
  </div>

  <div id="myModal4" class="modal fade">
    <div class="modal-dialog">
      <div class="container-fluid">
        <div class="modal-content">
          <div class="modal-header-sm" style="background:rgb(45, 101, 206);">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            <h4 class="modal-title" id="myLabel"
              style="font-size: 25px; font-weight:900; text-align: center; color: white;">Modal title</h4>
          </div>
          <div class="modal-body" id="modal-body-4" >






          </div>

        </div>



      </div>

    </div>
  </div>

  <div id="myModal5" class="modal fade">
    <div class="modal-dialog">
      <div class="container-fluid">
        <div class="modal-content">
          <div>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                aria-hidden="true">&times;</span></button>
             </div>
          <div>
            <iframe id="pdfdoc" height="400" width="100%" src=''></iframe>


          </div>

        </div>



      </div>

    </div>
  </div>

  

  <div id="myModal8" class="modal fullscreen-modal fade">
    <div class="modal-dialog">
      <div class="container-fluid">
        <div class="modal-content">
          <div>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                aria-hidden="true">&times;</span></button>
             </div>
          <div class="modal-body">
            <br>
            <br>
            <br>
            <p class="text-center">Pulsa en la imagen para verla mejor</p>
            <ul id="jqhtml" >
            
    <li><img id="imagenC" data-original="/assets/img/tibet-1.jpg" src="/assets/img/tibet-1.jpg" alt="Comprobante de pago"></li>
  </ul>
  <br>
            <br>
            <br><br>
            <br>
            <br><br>
            <br>
            <br><br>
            <br>
            <br>
          </div>
          
 
          
          
          

        </div>



      </div>

    </div>
  </div>

  <div id="myModalError" class="modal fade">
    <div class="modal-dialog">
      <div class="container-fluid">
        <div class="modal-content">
          <div class="modal-header">
            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
              &times;
            </button>
          </div>
          <div id="modal-cuerpo">




          </div>
        </div>

      </div>
    </div>
  </div>



  <div id="openModal" class=" modalDialog">
    <div>
      <a href="#close" title="Close" class="close" onclick="javascript:CloseModal();">X</a>
      <p class="text-center" id="mensaje-final"></p>
    </div>
  </div>

  <%- include ("partes/navegacionB") %>
  <div class="content-page-container full-reset custom-scroll-containers">
    <%- include ("partes/navegacionSuperiorB") %>
    <div class="container" id="seccion">
      <div class="page-header">
        <h1 class="all-tittles">
          Sistema bibliotecario <small>Inicio</small>
        </h1>
      </div>
    </div>
    <div class="container-fluid" id="enlaces"></div>
    <div class="container-fluid" id="explicacion"></div>


    <div class="container-fluid" id="tabla">

      <div class="container-fluid" id="inicio">
        <button class="btn btn-primary btn-block" id="opcion1" onclick="javascript:añadirNoticia(this)">Añadir
          noticia</button>

        <div class="container-fluid" id="infNoticia">
          <form autocomplete="off" enctype="multipart/form-data" id="nuevaNoticia">
            <div class="container-flat-form">

              <div class="title-flat-form title-flat-blue">Nueva noticia</div>
              <div class="row">

                <div class="col-xs-12 col-sm-8 col-sm-offset-2">
                  <legend><strong>Información básica</strong></legend><br>
                  <div class="group-material">
                    <input name="titulo" type="text" class="tooltips-general material-control"
                      placeholder="Escribe aquí el título de la noticia" required="" maxlength="200"
                      data-toggle="tooltip" pattern="[a-zA-Zá-ú ]{1,200}" data-placement="top"
                      title="Título de la noticia">
                    <span class="highlight"></span>
                    <span class="bar"></span>
                    <label>Título</label>
                  </div>

                  <div class="group-material">
                    <textarea id="textNoticia" name="textNoticia" type="text"
                      class="tooltips-general material-control form-control rounded-0"
                      style="border-color: rgb(0, 0, 255);" placeholder="Escribe aquí la noticia" required=""
                      pattern="[a-zA-Zá-ú ]{1,30}" data-toggle="tooltip" min="20" data-placement="top"
                      title="Texto de la noticia" cols="78" rows="5" wrap="hard" spellcheck="true"></textarea>

                  </div>

                  <table class="table table-responsive " style="table-layout: fixed; border: none;">
                    <tr id="tr-img-1" style="border: none;">
                      <td style="width: 200px;  border: none;">
                        <input onchange="comprobarFI(this)" id="img-1" name="img" type="file" required=""
                          class="material-control tooltips-general" data-toggle="tooltip" data-placement="top"
                          title="Imagen">
                        <span class="highlight"></span>
                        <span class="bar"></span>
                        <label>Imagen</label>

                      </td>
                      <td style="width: 30px;  border: none;" id="ico-1">

                      </td>
                    </tr>
                    <tr id="tr2-img-1">
                      <td style="width: 200px; border: none;">
                        <p class="text-center" id="formato-img-1"></p>

                      </td>
                      <td style="width: 30px;  border: none;">
                      </td>
                    </tr>
                  </table>
                  <p class="text-center">
                    <button id="reset1" onclick="limpiarFN()" type="reset" class="btn btn-info"
                      style="margin-right: 20px;"><i class="zmdi zmdi-roller"></i>

                      <p>&nbsp;&nbsp; Limpiar</p>
                    </button>
                    <button type="submit" class="btn btn-primary">
                      <i class="zmdi zmdi-floppy"></i>
                      <p>&nbsp;&nbsp; Guardar</p>
                    </button>
                </div>
              </div>
            </div>
          </form>
        </div>

        <div id="cuadronot">



        </div>

      </div>

      <form class="form-inline" id="formDias">
        <div class="container-flat-form" id="confDias">

          <div class="title-flat-form title-flat-blue">Nueva configuración</div>
          <div class="row">

            <div class="col-xs-12 col-sm-8 col-sm-offset-2">


              <div class="form-group  mx-sm-3" id="dias">
                <label for="dias">Días de préstamo</label>
                <input type="number" required="" name="dias" id="input-dias" class="material-control" minlength="1"
                  placeholder="Días de préstamos" >

              </div>
              <div class="form-group mx-sm-3" id="libros">
                <label for="libros">Límite de libros</label>
                <input type="number" required="" id="input-cantidad" class=" material-control" name="libros"
                  minlength="1" placeholder="Límite de libros">
              </div>
              
              <div class="form-group mx-sm-3" id="multa">
                <label for="multa">Multa por día vencido</label>
                <input type="number" required="" id="input-multa" class=" material-control" name="multa" minlength="1"
                  placeholder="Multa por día vencido">
              </div>
              <div class="form-group mx-sm-3" id="unidad">
                <label for="unidad">Unidad</label>
                <input type="text" required="" id="input-unidad" class=" material-control" name="libros" minlength="1"
                pattern="[a-zA-ZáéíóúÁÉÍÓÚñÑ ]{1,70}" placeholder="Unidad">
              </div>

              <div class="form-group mx-sm-3" id="datos">
                <label for="unidad">Datos bancarios</label>
                  <table class="table table-responsive " style="table-layout: fixed; border: none;">
                <tr id="tr-img-1" style="border: none;">
                  <td style="width: 200px;  border: none;">
                    <input onchange="comprobarFI(this)" id="img-1" name="img" type="file" 
                      class="material-control tooltips-general" data-toggle="tooltip" data-placement="top"
                      title="Imagen">
                    <span class="highlight"></span>
                    <span class="bar"></span>
                    <label>Imagen</label>

                  </td>
                  <td style="width: 30px;  border: none;" id="ico-1">

                  </td>
                </tr>
                <tr id="tr2-img-1">
                  <td style="width: 200px; border: none;">
                    <p class="text-center" id="formato-img-1"></p>

                  </td>
                  <td style="width: 30px;  border: none;">
                  </td>
                </tr>
              </table>

              </div>
             
           

              <div class="form-group mx-sm-3">
                <button type="submit" class="btn btn-primary">Configurar</button>

              </div>


            </div>

          </div>
        </div>
      </form>

  <form  id="conf-nucleos" autocomplete="off">
    <div class="container-flat-form">
      <div class="title-flat-form title-flat-blue">Nueva configuración</div>
      <div class="row">

        <div class="col-xs-12 col-sm-8 col-sm-offset-2">

        
          <h4 class="text-center all-tittles" style="margin-bottom: 10px;">Configuración de núcleos</h4>
<br>
          <div class="group-material">
            <input  onchange="añadirNucleo(this)" id="nucleo" name="nucleos" type="number"
            class="material-control material-control-login" placeholder="Escribe aquí el numero de nucleos"
              required="" maxlength="4"  pattern="^[0-9]+" min="1" data-toggle="tooltip" data-placement="top" title="Sólo números">
            <span class="highlight"></span>
            <span class="bar"></span>
            <label>Cantidad de núcleos</label>

          </div>

          
          <table class="table table-responsive " style="table-layout: fixed; border: none;" id="tbnucleo">
            <tr>
              <td style="width: 40px; overflow: hidden; border: none;">
                <input id="nucleo1" name="nucleo1" type="number"  class="material-control material-control-login" 
                  placeholder="Núcleo.1" required="" maxlength="4" data-toggle="tooltip" data-placement="top"
                   value="1">
                <span class="highlight"></span>
                <span class="bar"></span>
                <label>Núcleo</label>
              </td>
              <td style="width: 150px; overflow: hidden; border: none;">
                <input id="nucleo-1"  name="nucleo_1" type="text"
                class="material-control material-control-login"  placeholder="Escribe aquí el núcleo"
                  required="" maxlength="100" onkeyup="comp(this)"
                  pattern="(^([a-zA-Zá-ú]{1,})$)"
                  data-toggle="tooltip" data-placement="top" >
                <span class="highlight"></span>
                <span class="bar"></span>
                <label></label>

              </td>
              <td id="imgs-nucleo" style="width: 20px; overflow: hidden; border: none;">
                <div  class="limpiar" id="img-nucleo-1"></div>
              </td>
            </tr>
            <tr>
              <td style="width: 30px; overflow: hidden; border: none;"></td>
              <td id="mensaje-nucleo" style="width: 200px; border: none; overflow: hidden;">
                <div class="limpiar" id="nucleo-unica-1"></div>
              </td>
              <td style="width: 20px; border: none; overflow: hidden;"></td>
            </tr>

          </table>
          <p class="text-center">
           <button type="reset" id="resetNucleo" class="btn btn-info">Limpiar</button>
            <button type="submit" class="btn btn-primary">Configurar</button>
            
          </p>
        </div>
      </div>  
    </div>         
  </form> 
  <form id="conf-categorias" autocomplete="off">
      <div class="container-flat-form">
        <div class="title-flat-form title-flat-blue">Nueva configuración</div>
        <div class="row">
  
          <div class="col-xs-12 col-sm-8 col-sm-offset-2">
  
          
            <h4 class="text-center all-tittles" style="margin-bottom: 10px;">Configuración de categorías</h4>
  <br>
            <div class="group-material">
              <input onchange="añadirNucleo(this)" id="categoria" type="number" name="categorias"
              class="material-control material-control-login" placeholder="Escribe aquí el numero de categorías"
                required="" maxlength="4"  pattern="^[0-9]+" min="1" data-toggle="tooltip" data-placement="top" title="Sólo números">
              <span class="highlight"></span>
              <span class="bar"></span>
              <label>Cantidad de categorías</label>
  
            </div>
  
            
            <table class="table table-responsive " style="table-layout: fixed; border: none;" id="tbcategoria">
              <tr>
                <td style="width: 40px; overflow: hidden; border: none;">
                  <input id="categoria1" name="categoria1" type="number"  class="material-control material-control-login" 
                    placeholder="Categoria.1" required="" maxlength="4" data-toggle="tooltip" data-placement="top"
                     value="1">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Categoría</label>
                </td>
                <td style="width: 150px; overflow: hidden; border: none;">
                  <input id="categoria-1"  onkeyup="comp(this)" name="categoria_1" type="text"
                  class="material-control material-control-login"  placeholder="Escribe aquí la categoría"
                    required="" maxlength="100"
                    pattern="(^([a-zA-Zá-ú]{1,})$)"
                    data-toggle="tooltip" data-placement="top" >
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label></label>
  
                </td>
                <td id="imgs-categoria" style="width: 20px; overflow: hidden; border: none;">
                 <div class="limpiar" id="img-categoria-1"></div>
                </td>
              </tr>
              <tr>
                <td style="width: 30px; overflow: hidden; border: none;"></td>
                <td id="mensaje-categoria" style="width: 200px; border: none; overflow: hidden;">
                  <div class="limpiar" id="categoria-unica-1"></div>
                </td>
                <td style="width: 20px; border: none; overflow: hidden;"></td>
              </tr>
  
            </table>
           <p class="text-center">
             <button type="reset" id="resetCategoria" class="btn btn-info">Limpiar</button>
             <button type="submit" class="btn btn-primary">Configurar</button>
             
           </p>
           
          </div>
        </div>   
      </div>        
  </form> 

  
 
  <script src="/js/viewer.min.js"></script>
  <script>
  var viewer = new Viewer(document.getElementById('jqhtml'), {
    url: 'data-original'
  });
 
 </script>
 


  
  <div class="container-fluid">
        <form autocomplete="off" enctype="multipart/form-data" id="formato">

          <div class="container-flat-form">

            <div class="title-flat-form title-flat-blue">Nuevo libro</div>
            <div class="row">

              <div class="col-xs-12 col-sm-8 col-sm-offset-2">
                <legend><strong>Información básica</strong></legend><br>

                <div class="group-material">
                  <span>Categoría de suscripción</span>
                  <select  id="suscription" name="suscription" required=""
                    class="tooltips-general material-control" data-toggle="tooltip" data-placement="top"
                    title="Elige la categoría del libro">
                    <option disabled="" selected="">Selecciona una categoría</option>
                    <option>Basica</option>
                    <option>Estandar</option>
                    <option>Premium</option>

                  </select>
                </div> 
               
                <div class="group-material">
                 
                  <span>Categoría del contenido</span><img id="img-cargando"  >
                  <select onclick="categorias('type')" id="type" name="type" required=""
                    class="tooltips-general material-control" data-toggle="tooltip" data-placement="top"
                    title="Elige la categoría del libro">
                    <option disabled="" selected="">Selecciona una categoría</option>

                  </select>
             
                </div>
                <div class="group-material">
                  <span>Núcleo al que pertenece</span><img id="img-cargando2" >
                  <select  id="core" onclick="nucleos('core')" name="core" required=""
                    class="tooltips-general material-control" data-toggle="tooltip" data-placement="top"
                    title="Elige el nucleo">
                    <option disabled="" selected="">Selecciona un nucleo</option>

                  </select>
                </div>
                <div class="group-material">
                  <input id="ejemplar" onchange="ejemplares()" name="ejemplar" type="number"
                    class="tooltips-general material-control" placeholder="Escribe aquí el numero de ejemplares"
                    required="" maxlength="4" data-toggle="tooltip" pattern="^[0-9]+" min="1" data-placement="top"
                    title="Numero de ejemplares">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>ejemplares</label>

                </div>
                <table class="table table-responsive " style="table-layout: fixed; border: none;" id="tb">
                  <tr>
                    <td style="width: 30px; overflow: hidden; border: none;">
                      <input id="ejemplar1" name="ejemplar1" type="number" class="tooltips-general material-control"
                        placeholder="Ej.1" required="" maxlength="4" data-toggle="tooltip" data-placement="top"
                        title="Número de ejemplar, sólo números" value="1">
                      <span class="highlight"></span>
                      <span class="bar"></span>
                      <label>ejemplar</label>
                    </td>
                    <td style="width: 200px; overflow: hidden; border: none;">
                      <input id="cota-1" onkeyup="añadirCampoPdf(this)" name="cota_1" type="text"
                        class="tooltips-general material-control" placeholder="Escribe aquí la cota del libro"
                        required="" maxlength="25" 
                        pattern="(^([a-zA-Zá-ú0-9]{1,})(_)?([a-zA-Zá-ú0-9]{1,})$)|^([a-zA-Zá-ú0-9]{1,})$"
                        data-toggle="tooltip" data-placement="top" title="Ej. cota_1 sin espacios">
                      <span class="highlight"></span>
                      <span class="bar"></span>
                      <label>Cota</label>

                    </td>
                    <td id="imgs-cota" style="width: 20px; overflow: hidden; border: none;">
                      <div class="tooltips-general material-control" id="img-cota-1"></div>
                    </td>
                  </tr>
                  <tr>
                    <td style="width: 30px; overflow: hidden; border: none;"></td>
                    <td id="mensaje-cota" style="width: 200px; border: none; overflow: hidden;">
                      <div id="cota-unica-1"></div>
                    </td>
                    <td style="width: 20px; border: none; overflow: hidden;"></td>
                  </tr>

                </table>

                <div class="group-material">
                  <input id="title" name="title" type="text" class="tooltips-general material-control"
                    placeholder="Escribe aquí el título o nombre del libro" required="" pattern="[a-zA-Zá-ú ]{1,200}"
                    maxlength="200" data-toggle="tooltip" data-placement="top"
                    title="Escribe el título o nombre del libro, sólo letras">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Título</label>
                </div>
                <div class="group-material" id="autorD">
                  <input name="creator" type="text" id="creator" class="tooltips-general material-control"
                    placeholder="Escribe aquí el autor del libro" required="" pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top"
                    title="Escribe el nombre del autor del libro">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Autor</label>
                </div>
                <div  class="group-material">
                  <input name="contributor" type="text" id="contributor" class="tooltips-general material-control"
                  placeholder="Escribe aquí el nombre de colaboradores" required="" pattern="[a-zA-Zá-ú ]{1,100}"
                  maxlength="100" data-toggle="tooltip" data-placement="top"
                  title="Escribe el nombre de los colaboradores">
                <span class="highlight"></span>
                <span class="bar"></span>
                <label>Colaborador</label>
                </div>
                
                <div class="group-material">
                  <input id="date" name="date" type="date" class="material-control tooltips-general"
                     required=""   data-toggle="tooltip" data-placement="top" title="Fecha de publicación"  placeholder="Escribe aquí la fecha relacionada" >
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Fecha</label>
                </div>
                <div class="group-material" id="editorialD">
                  <input id="publisher" name="publisher" type="text" class="material-control tooltips-general"
                    placeholder="Escribe aquí la editorial del libro" required="" pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Editorial del libro">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Editorial</label>
                </div>
                <div class="group-material" >
                  <input id="source" name="source" type="text" class="material-control tooltips-general"
                    placeholder="Escribe aquí la fuente del material" required="" pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Fuente del material">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Fuente</label>
                </div>
                <div class="group-material" >
                  <input id="language" name="language" type="text" class="material-control tooltips-general"
                    placeholder="Escribe aquí el lenguaje del material" required="" pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Lenguaje del material">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Lenguaje</label>
                </div>
                <div class="group-material" >
                  <input id="coverage" name="coverage" type="text" class="material-control tooltips-general"
                    placeholder="Escribe aquí el ámbito del contenido" required="" pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Ámbito del contenido">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Ámbito del contenido</label>
                </div>
                <div class="group-material" >
                  <input id="relation" name="relation" type="text" class="material-control tooltips-general"
                    placeholder="Escribe aquí la referencia a un recurso relacionado" required="" pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Referencia a otro recurso">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Referencia</label>
                </div>
                <div class="group-material" >
                  <input id="subject" name="subject" type="text" class="material-control tooltips-general"
                    placeholder="Escribe aquí palabras relaionadas" required="" pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Palabras relacionadas">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Palabras relacionadas</label>
                </div>
                <div class="group-material" >
                 
                  <textarea id="description" name="description" type="text" class="tooltips-general material-control form-control rounded-0"
                  placeholder="Escribe aquí la descripción del recurso" required="" pattern="[a-zA-Zá-ú ]{1,100}"
                  maxlength="100" data-toggle="tooltip" data-placement="top" 
                  style="border-color: rgb(0, 0, 255);"  min="20"  cols="86" rows="3" wrap="hard" spellcheck="true"></textarea>                
                   <span class="highlight"></span>
                  <span class="bar"></span>
                  <label> </label>
                </div> 
                <div class="group-material" >
                  <input id="rights" name="rights" type="text" class="material-control tooltips-general"
                    placeholder="Escribe aquí los derechos" required="" pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Derechos del material">
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label>Derechos del material</label>
                </div>
                <table class="table table-responsive " style="table-layout: fixed; border: none;" id="table-pdf">
                  <tr id="tr-pdf-1" style="border: none;">
                    <td style="width: 200px;  border: none;">
                      <input onchange="comprobarF(this)" id="pdf-1" name="pdf" type="file" required=""
                        class="material-control tooltips-general" data-toggle="tooltip" data-placement="top"
                        title="Archivo PDF">
                      <span class="highlight"></span>
                      <span class="bar"></span>
                      <label>Archivo PDF</label>

                    </td>
                    <td style="width: 30px;  border: none;" id="img-pdf-1">

                    </td>
                  </tr>
                  <tr id="tr2-pdf-1">
                    <td style="width: 200px; border: none;">
                      <p class="text-center" id="formato-pdf-1"></p>
                    </td>
                    <td style="width: 30px;  border: none;">
                    </td>
                  </tr>
                </table>

                <div class="group-material">
                  <p class="text-center"> <input onchange="mostrarCampo(this)" id="mostrar_1" name="mostrar_1"
                      type="checkbox" value="1" class="tooltips-general" title="Incluye PDF">No incluye archivo PDF</p>
                </div>

                <p class="text-center">
                  <button onclick="resetear()" id="reset" type="reset" class="btn btn-info" style="margin-right: 20px;">
                    <div><i class="zmdi zmdi-roller"></i></div>
                    <p>&nbsp;&nbsp; Limpiar</p>
                  </button>
                  <button id="guardar" type="submit" class="btn btn-primary">
                    <div id="estatus"><i class="zmdi zmdi-floppy"></i></div>
                    <p id="boton">&nbsp;&nbsp; Guardar</p>
                  </button>

                <div id="mensaje"></div>
                </p>

              </div>

            </div>

          </div>
        </form>
      </div>
      <div class="container-fluid" style="margin: 0px;" id="editarLibro">
        <div class="page-header" style="border: none; ">
          <h2 class="text-center" style="background-color:rgb(217, 217, 226) ;">¿Buscas un libro en particular?</h2>
          <div class="group-material">
            <p class="text-center"> <input onchange="ocultarCampos(this)" id="ocultar" name="ocultar" type="checkbox"
                value="1" class="tooltips-general" title="no, quiero ver todos los libros">No, quiero ver todos los
              libros</p>
          </div>
        </div>
        <div class="container-fluid">
          <form class="form-inline" style="text-align:center; " id="formato-enlinea">
            <div class="row justify-content-md-center">
              <div class="row">
                            <div class="col-sm-4 col-md-3">
                <input id="cota_unica" name="cota" type="text" class="tooltips-general material-control"
                  pattern="(^([a-zA-Zá-ú0-9]{1,})(_)?([a-zA-Zá-ú0-9]{1,})$)|^([a-zA-Zá-ú0-9]{1,})$" placeholder="Cota"
                  maxlength="25" data-toggle="tooltip" data-placement="top" title="Ej. cota_1 Sin espacios">
                <label>Cota</label>
              </div>
              <div class="col-sm-4 col-md-3">
                <select  id="suscription_unico" name="suscription"
                class="tooltips-general material-control" data-toggle="tooltip" data-placement="top"
                title="Elige la categoría del libro">
                <option disabled="" selected="">Suscripción</option>
                <option>Basica</option>
                <option>Estandar</option>
                <option>Premium</option>
                </select>
              </div>
              <div class="col-sm-4 col-md-3">
                <select  id="type_unico"onclick="categorias('type_unico')" name="type"
                class="tooltips-general material-control" data-toggle="tooltip" data-placement="top"
                title="Elige la categoría del libro">
                <option disabled="" selected="">Categoría</option>
                
                </select>
              </div>
              <div class="col-sm-4 col-md-3">
                <select  id="core_unico" name="core" 
                    class="tooltips-general material-control" data-toggle="tooltip" data-placement="top"
                    title="Elige el nucleo">
                    <option disabled="" selected="">Núcleo</option>
                    <option>charallave</option>
                    <option>carora</option>
                    <option>caracas</option>

                  </select>
              </div> 
              </div>
              <div class="row">
                <div class="col-sm-4 col-md-3">
                 <select  id="format_unico" name="format" 
                    class="tooltips-general material-control" data-toggle="tooltip" data-placement="top"
                    title="Elige el nucleo">
                    <option disabled="" selected="">Formato</option>
                    <option>PDF</option>
                    <option>Solo en fisico</option>

                  </select>
              </div>
              <div class="col-sm-4 col-md-3">
                <input id="title_unico" name="title" type="text" class="tooltips-general material-control"
                placeholder="Título" pattern="[a-zA-Zá-ú ]{1,200}"
                maxlength="200" data-toggle="tooltip" data-placement="top"
                title="Título del libro">
              <label>Título</label>
              </div>

              <div class="col-sm-4 col-md-3">
                <input name="creator" type="text" id="creator_unico" class="tooltips-general material-control"
                placeholder="Autor" pattern="[a-zA-Zá-ú ]{1,100}"
                maxlength="100" data-toggle="tooltip" data-placement="top"
                title="Autor del libro">
              <label>Autor</label>
               
              </div>

              <div class="col-sm-4 col-md-3">
                <input name="contributor" type="text" id="contributor_unico" class="tooltips-general material-control"
                  placeholder="Colaboradores" pattern="[a-zA-Zá-ú ]{1,100}"
                  maxlength="100" data-toggle="tooltip" data-placement="top"
                  title="Colaboradores">
                <label>Colaborador</label>
              </div>
              </div>
              <div class="row">
                <div class="col-sm-4 col-md-3">
                  <input id="rights_unico" name="rights" type="text" class="material-control tooltips-general"
                  placeholder="Derechos" pattern="[a-zA-Zá-ú ]{1,100}"
                  maxlength="100" data-toggle="tooltip" data-placement="top" title="Derechos del material">
                <label>Derechos del material</label>
                </div>
                
              <div class="col-sm-4 col-md-3">
                <input id="publisher_unico" name="publisher" type="text" class="material-control tooltips-general"
                    placeholder="Editorial"  pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Editorial">
                  <label>Editorial</label>
              </div>
              
              <div class="col-sm-4 col-md-3">
                <input id="source_unico" name="source" type="text" class="material-control tooltips-general"
                    placeholder="Fuente"  pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Fuente del material">
                  <label>Fuente</label>
              </div>
              <div class="col-sm-4 col-md-3">
                <input id="language_unico" name="language" type="text" class="material-control tooltips-general"
                    placeholder="Lenguaje"  pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Lenguaje del material">
              
                  <label>Lenguaje</label>
              </div>
              </div>
              <div class="row">
                <div class="col-sm-4 col-md-3">
                <input id="coverage_unico" name="coverage" type="text" class="material-control tooltips-general"
                    placeholder="Ámbito"  pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Ámbito del contenido">
                  <label>Ámbito del contenido</label>
              </div>

              <div class="col-sm-4 col-md-3">
             <input id="relation_unico" name="relation" type="text" class="material-control tooltips-general"
              placeholder="Recurso relacionado"  pattern="[a-zA-Zá-ú ]{1,100}"
              maxlength="100" data-toggle="tooltip" data-placement="top" title="Referencia a otro recurso">
            <label>Referencia</label>
            </div>
              <div class="col-sm-4 col-md-3">
                <input id="subject_unico" name="subject" type="text" class="material-control tooltips-general"
                    placeholder="Palabras relaionadas"  pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Palabras relacionadas">
                  <label>Palabras relacionadas</label>
              </div>
              <div class="col-sm-4 col-md-3">
                <input id="description_unico" name="description" type="text" class="material-control tooltips-general"
                    placeholder="Descripción"  pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Descripción">
                  <label>Descripción</label>
              </div> 
              </div>
             <div class="row">
                
              <div class="col-sm-4 col-md-3">
                <input id="date_unico" name="date" type="date" class="material-control tooltips-general"
                  data-toggle="tooltip" data-placement="top" title="Fecha de publicación"  placeholder="Fecha" >
             <label>Fecha</label>
              </div>
              <div class="col-sm-4 col-md-3">

                <button id="limpiarButton" style="margin-block: 10px;" type="reset"
                  class="btn btn-light">Limpiar</button>
              </div>
              <div class="col-sm-4 col-md-3">

                <button style="margin-block: 10px;" type="submit" class="btn btn-primary">Aplicar filtros</button>
              </div>
             </div>
             
            </div>
          </form>
        </div>
      </div>
      <div class="container-fluid" id="preguntasF">
        <button class="btn btn-primary btn-block" id="opcion2" onclick="javascript:añadirPregunta(this)">Añadir
          pregunta</button>

        <div class="container-fluid" id="divContPre">
          <form autocomplete="off" enctype="multipart/form-data" id="preguntasFrecuentes">
            <div class="container-flat-form">

              <div class="title-flat-form title-flat-blue">Nueva pregunta</div>
              <div class="row">

                <div class="col-xs-12 col-sm-8 col-sm-offset-2">
                  <legend><strong>Información básica</strong></legend><br>
                  <div class="group-material">
                    <input  name="titulo" type="text" class="tooltips-general material-control"
                      placeholder="Escribe la pregunta sin signos de interrogación" required="" data-toggle="tooltip"
                      pattern="[a-zA-Zá-ú ]{1,}"  minlength=" 1" data-placement="top" title="Título de la pregunta">
                    <span class="highlight"></span>
                    <span class="bar"></span>
                    <label>Título</label>
                  </div>

                  <div class="group-material">
                    <textarea id="respuesta" name="textRespuesta" type="text"
                      class="tooltips-general material-control form-control rounded-0"
                      style="border-color: rgb(0, 0, 255);" placeholder="Escribe aquí la respuesta " required=""
                      data-toggle="tooltip" pattern="[a-zA-Zá-ú ]{1,}" minlength="1" data-placement="top"
                      title="Texto de la respuesta" cols="78" rows="5" wrap="hard" spellcheck="true"></textarea>

                  </div>


                  <p class="text-center">
                    <button id="reset2" type="reset" class="btn btn-info" style="margin-right: 20px;"><i
                        class="zmdi zmdi-roller"></i>

                      <p>&nbsp;&nbsp; Limpiar</p>
                    </button>
                    <button type="submit" class="btn btn-primary">
                      <i class="zmdi zmdi-floppy"></i>
                      <p>&nbsp;&nbsp; Guardar</p>
                    </button>
                </div>
              </div>
            </div>
          </form>
        </div>
        <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true"></div>
      </div>


      <div class="container-fluid" id="divExcel">
        <form autocomplete="off" enctype="multipart/form-data" id="nuevaBaseE">
          <div class="container-flat-form">

            <div class="title-flat-form title-flat-blue">Actualiza la base de datos estudiantil</div>
            <div class="row">

              <div class="col-xs-12 col-sm-8 col-sm-offset-2">
                <legend><strong>Información básica</strong></legend><br>


                <table class="table table-responsive " style="table-layout: fixed; border: none;">
                  <tr id="tr-excel-1" style="border: none;">
                    <td style="width: 200px;  border: none;">
                      <input onchange="comprobarFE(this)" id="excel-1" name="excel" type="file" required=""
                        class="material-control tooltips-general" data-toggle="tooltip" data-placement="top"
                        title="Excel">
                      <span class="highlight"></span>
                      <span class="bar"></span>
                      <label>Excel</label>

                    </td>
                    <td style="width: 30px;  border: none;" id="ico-1">

                    </td>
                  </tr>
                  <tr id="tr2-excel-1">
                    <td style="width: 200px; border: none;">
                      <p class="text-center" id="formato-excel-1"></p>

                    </td>
                    <td style="width: 30px;  border: none;">
                    </td>
                  </tr>
                </table>
                <p class="text-center">
                  <button id="reset3" onclick="limpiarFN()" type="reset" class="btn btn-info"
                    style="margin-right: 20px;"><i class="zmdi zmdi-roller"></i>

                    <p>&nbsp;&nbsp; Limpiar</p>
                  </button>
                  <button type="submit" class="btn btn-primary">
                    <i class="zmdi zmdi-floppy"></i>
                    <p>&nbsp;&nbsp; Guardar</p>
                  </button>
              </div>
            </div>
          </div>
        </form>
        <form autocomplete="off" enctype="multipart/form-data" id="nuevaBaseD">
          <div class="container-flat-form">

            <div class="title-flat-form title-flat-blue">Actualiza la base de datos docente</div>
            <div class="row">

              <div class="col-xs-12 col-sm-8 col-sm-offset-2">
                <legend><strong>Información básica</strong></legend><br>


                <table class="table table-responsive " style="table-layout: fixed; border: none;">
                  <tr id="tr-excel-1" style="border: none;">
                    <td style="width: 200px;  border: none;">
                      <input onchange="comprobarFE(this)" id="excel-2" name="excel" type="file" required=""
                        class="material-control tooltips-general"  data-toggle="tooltip" data-placement="top"
                        title="Excel">
                      <span class="highlight"></span>
                      <span class="bar"></span>
                      <label>Excel</label>

                    </td>
                    <td style="width: 30px;  border: none;" id="ico-2">

                    </td>
                  </tr>
                  <tr id="tr2-excel-1">
                    <td style="width: 200px; border: none;">
                      <p class="text-center" id="formato-excel-2"></p>

                    </td>
                    <td style="width: 30px;  border: none;">
                    </td>
                  </tr>
                </table>
                <p class="text-center">
                  <button id="reset4" onclick="limpiarFN()" type="reset" class="btn btn-info"
                    style="margin-right: 20px;"><i class="zmdi zmdi-roller"></i>

                    <p>&nbsp;&nbsp; Limpiar</p>
                  </button>
                  <button type="submit" class="btn btn-primary">
                    <i class="zmdi zmdi-floppy"></i>
                    <p>&nbsp;&nbsp; Guardar</p>
                  </button>
              </div>
            </div>
          </div>
        </form>
      </div>
      <div id="cargando"></div>
      <div class="container-fluid" id="container"></div>

    </div>
    <%- include ("partes/piePagina") %>
  </div>
</body>

</html>