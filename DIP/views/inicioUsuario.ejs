<!DOCTYPE html>
<html lang="es">
<%- include ("partes/cabecera") %>



<script>
    
      //animacion para la seccion de noticias
      var intervalId = false;
      var first = 0;
    var speed = 700;

    function removeFirst() {
   
       
      first = $('div#cuadronot li:first').html();
      $('div#cuadronot li:first')
        .animate({ opacity: 0 }, speed)
        .fadeOut('slow', function () {
          $(this).remove();
        });

      addLast(first);

    }
    function addLast(first) {
     
      last = '<li style="display:none;">' + first + '</li>';
      $('div#cuadronot').append(last);
      $('div#cuadronot li:last')
        .animate({ opacity: 1 }, speed)
        .fadeIn('slow')
    }
      
      
//manejo de errores para todas las solicitudes ajax
function manejoErrores(error) {
    let message;
    if (error.responseJSON) {
      if (error.responseJSON.message) {
        message = error.responseJSON.message

      }
    } else {
      message = 'Sin información'
    }

    let statusCode = error.status || 500;
    let statusText = '';
    switch (statusCode) {
      case 400:
        statusText = 'Bad Request';
        break;
      case 401:
        statusText = 'Unauthorized';
        break;
      case 403:
        statusText = 'Forbidden';
        break;
      case 500:
        statusText = 'Internal Server Error';
        break;
      case 200:
        statusText = 'OK';
        break;
    };
    if (statusCode == 500 || statusCode == 400) {
      $("div#modal-cuerpo").html(`<p class="text-center" style=" font-weight:bold; font-size:30px; "> <img src="/assets/icons/robot-error.ico"width= "180" height= "180" > ¡Error!</p>
 <br>
                
                <p class="text-center" style="font-size:20px; ">
                        ${statusText}   (Error: ${statusCode})
                        <br><p class="text-center" style="font-size:25px;"> ${message}</p> </p>`);
    } else if ( statusCode == 403 || statusCode == 401) {
      $("div#modal-cuerpo").html(`<p class="text-center" style=" font-weight:bold; font-size:30px; "> <img src="/assets/icons/peligro.ico"width= "180" height= "180" ></p>
 <br>
                
                <p class="text-center" style="font-size:20px; ">
                        ${statusText}   (Error: ${statusCode})
                        <br><p class="text-center" style="font-size:25px;"> ${message}<button id="login" class="bnt btn-link" href="#">Logeate</button> </p></p>`);
    } else {
      $("div#modal-cuerpo").html(`<p class="text-center" style=" font-weight:bold; font-size:30px; ">!UPS¡ <img src="/assets/icons/robot-roto.ico"width= "180" height= "180" ></p>
      <br>
                
                <p class="text-center" style="font-size:20px; ">
                       Recurso no encontrado  (Error: 404) </p>`);
    }
    $("div#myModal").modal("hide");
    $("div#myModalError").modal("show");

  };


//ver la noticia en una ventana modal estatica
function verUnaNoticia(id) {
    let id_n = id;
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: `/noticia?id_n=${id_n}`,
      type: "POST",
    })
      .done(function (noticia) {
        $("div#modal-body-2").html(`
         <div id="cuadro">
  <div class="container-fluid" >
  
          <img src="${noticia.url_imagen}" alt="">
          <a class="news-title" href="#">${noticia.titulo_noticia}</a>
          <span class="news-text text-center">${noticia.text_noticia}</span> </div>
        </div>
        `);
        $("div#myModal").modal("hide");
        $("div#myModal2").modal("show");

      })
      .fail(function (error) {
        manejoErrores(error);
      });
  }
 
     function min() {
        let f = new Date();

        let d = f.getDay();
        let mes, dia;
        if (d == 6) {
            f.setDate(f.getDate() + 2);
            f = new Date(f);

        } else if (d == 0) {
            f.setDate(f.getDate() + 1);
            f = new Date(f);

        } else if (d == 5 && f.getHours() > 16) {
           
            f.setDate(f.getDate() + 3);
            f = new Date(f);

        } else if (d != 5 && d != 6 && d != 0 && f.getHours() > 16) {
            
            f.setDate(f.getDate() + 1);
            f = new Date(f);

        } else {
           
            f = new Date(f);
        } 
        if ((f.getMonth() + 1) < 10) {
            let  m = f.getMonth() + 1;
             mes = "0" + m ;
        } else if ((f.getMonth() + 1) >= 10) {
            mes = f.getMonth() + 1; 
        }
        if (f.getDate() < 10) {
            let d = f.getDate();
             dia = "0" + d;
        } else if (f.getDate() >= 10) {
            dia = f.getDate();
        }
        return f.getFullYear() + "-" + mes + "-" + dia;
    };

    function sumarDias(fecha, dias) {
        fecha.setDate(fecha.getDate() + dias);
        return fecha;
    };

    function max() {
        let d, mes, dia;
        let f = min();
        f = new Date(f);
        for (var i = 1; i <= 5; i++) {
            let fecha = sumarDias(f, 1);
            fecha = new Date(fecha);
            d = fecha.getDay();
            if (d == 5) {
                if ((f.getMonth() + 1) < 10) {
                    let m = f.getMonth() + 1
                    mes = "0" + m;
                } else if (f.getMonth() + 1 >= 10 ) {
                    mes = f.getMonth() + 1;
                }
                if (f.getDate() < 10) {
                     dia = "0" + f.getDate();
                } else if (f.getDate() >= 10) {
                    dia = f.getDate();
                }

                return f.getFullYear() + "-" + mes + "-" + dia;

            }
        };
    }
    //muestra el icono de formato correcto
    function formatoCI(id1, id2) {
    $(id1).html("");
    $(id2).html(
      `<img src="/assets/img/satisfactorio.png" width= "20" height= "20">`
    );
  }
  //se muestra el icono de formato incorrecto
  function formatoII(id1, id2) {
    $(id1).html(`<p>Debe ser formato jpg, png, jpeg ó pdf</p>`);
    $(id2).html(
      `<img src="/assets/icons/notificacion-error.ico" width= "20" height= "20">`
    );
  }
  
 //se evalua el formato de la img de la noticia
 function comprobarFIS(img) {
    var i = $(img).attr("id").split("-").pop();
    var ext = $(img).val().split(".").pop().toLowerCase();

    var id1 = "p#formato-img-" + i;
    var id2 = "td#ico-" + i;
    if ($(img).val() != "") {
      if (ext === "png" || ext === "jpg" || ext === "jpeg" || ext === "pdf") {
        formatoCI(id1, id2);
      } else {
        formatoII(id1, id2);
      }
    }
  }


    function añadirAtt(query) {
        $(query).attr("disabled", true);
    };
    
    function verPDF(input) {
      let ext = $(input).attr("data_url").split(".").pop();
      let url2 = $(input).attr("data_url");
      console.log(url2)
      if (ext === 'pdf') {
          console.log('entre')
         let url = "/lib/web/viewer.html?file=" + $(input).attr("data_url") + "#zoom=50";
      let titulo = $(input).attr("data_titulo");
      $('#myModalLabel').text(titulo);
      $('#pdfdoc').attr('src', url);
      $('#myModal7').modal("show");
      } else {
       
       $("#myModal4").modal("hide");
      $("#imagenC").attr('src', url2);
      $("#imagenC").attr('data-original', url2);
      $("#myModal8").modal("show");
      }
     
    };
  
  
   
    function añadirTutor(input) {
        if ($(input).val() === 'Trabajo de grado') {

            $('div#div-contenedor').show();
        } else {
            $('div#div-contenedor').hide();
        }
    };
    function reservarLibro(ct) {
        let cota = $(ct).attr("id");
        $("#myLabel").html(`Ingresa la información`);
        $("#modal-body-4").html(`
  
  <p class="text-center">Ingresa el día que efectuaras el retiro y verifica la cota</p>
  <form id="reservarL" style="margin-left: 30%;">
      
  <div class="form-group row">
  <label for="fecha_e" class="col-sm-2 col-form-label">Día de retiro</label>
  <div class="col-sm-10">
    <input type="date" id="fecha_e"  class="fecha"  name="fecha_e" required="">
  
  </div>
  </div>
  <div class="form-group row">
  <label for="fecha_e" class="col-sm-2 col-form-label">Cota</label>
  <div class="col-sm-10">
  <input type="text" class="tooltips-general" require="" id="cota" name="cota" placeholder="Cota del libro" value="${cota}" reandoly >
  </div>
  </div>
  <div class="form-group row">
    <div id="cargando_2"  class="col-sm-2 "></div>
  <div class="col-sm-10">
  <button type="submit"  class="btn btn-primary">Reservar</button>
  </div>
  </div>
  
  </form>
  `);
        $("#myModal4").modal("show");

    };


    function tipoTrabajo(trabajo) {
        if ($(trabajo).val().toLowerCase() === "trabajo de grado") {
            $("div#tutor").html(`
             <input id="tutor" name="tutor" type="text" class="tooltips-general material-control" placeholder="Escribe aquí el tutor del libro" required="" pattern="[Áa-z- -ñ]{1,}" maxlength="70" data-toggle="tooltip" data-placement="top" title="Escribe el nombre del tutor del libro">
                         <span class="highlight"></span>
                         <span class="bar"></span>
                         <label>Autor</label>`);
        } else {
            $("div#tutor").html("");
        }
    }

 //funcion consulta de nucleos
 function nucleos(input) {
    let id=`#${input} option`;
    let id2=`#${input}`;
    let contenido = $(id).length;
   
           if (contenido<=1) {
 $.ajax({
          beforeSend: function () {
           $("#img-cargando2").attr("src", "/assets/gif/loading-22.gif");
           $("#img-cargando2").attr("width", 20);
           $("#imga-cargando2").attr("height", 20);
         
           
          },
          url: "/bibliotecario/nucleos",
          type: "GET",
        })
          .done(function (nucleos) {
            $("#img-cargando2").attr("src", "");
           $("#img-cargando2").attr("width", "");
           $("#imga-cargando2").attr("height", "");
           $(id2).html('');

           for (var i=0; i<nucleos.nucleos.length; i++) {
              $(id2).append(`<option>${nucleos.nucleos[i].nucleo}</option>`);
           }
          
          })
          .fail(function (error) {
            manejoErrores(error);
          });
    

           }
   
  }

  //funcion para la consulta de categorias
  function categorias(input) {
    let id=`#${input} option`;
    let id2=`#${input}`;
    let contenido = $(id).length;
    if (contenido<=1 ) {
       $.ajax({
          beforeSend: function () {
           $("#img-cargando").attr("src", "/assets/gif/loading-22.gif");
           $("#img-cargando").attr("width", 20);
           $("#imga-cargando").attr("height", 20);
         
           
          },
          url: "/categorias",
          type: "GET",
        })
          .done(function (categorias) {
            $("#img-cargando").attr("src", "");
           $("#img-cargando").attr("width", "");
           $("#imga-cargando").attr("height", "");
           $(id2).html('');
           $(id2).html('<option disabled="" selected="">Categoría</option>');
           for (var i=0; i<categorias.categorias.length; i++) {
              $(id2).append(`<option>${categorias.categorias[i].categoria}</option>`);
           }
          
          })
          .fail(function (error) {
            manejoErrores(error);
          });
    
    }
   

  }
 //seccion configuracion de seguridad
function seccionConfS() {
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/mis-preguntas",
      type: "GET",
    })
      .done(function (obj) {
        $("#myModal").modal("hide");
        $("div#confDias").hide();
        $("div#preguntasF").hide();
        $("#container").show();
        $("div#explicacion").show();
        $("form#nuevaBaseE").hide();
        $("div#editarLibro").hide();
        $("div#enlaces").hide();
        $("form#nuevaBaseD").hide();
        $("form#conf-nucleos").hide();
    $("form#conf-categorias").hide();
        $("div#inicio").hide();
        $("div#cargando").html('');
        $("form#ingresarLibro").hide();
        $("form#formato").hide();
        $("form#formato-enlinea").hide();
        $("form#formato-enlinea-dos").hide();
        $("div#busquedaC").hide();
        $("div#accordion").hide();
        $("div#seccion").html(` 
                <div class="page-header">
                <h1 class="all-tittles">UNEXPO SBDIP <small>Mi configuración</small></h1>
               </div>`);
       $("div#explicacion").html(`
          <div class="row">
                <div class="col-xs-12 col-sm-4 col-md-3">
                    <img src="/assets/img/candado.png" alt="seguridad" class="img-responsive center-box"
                        style="max-width: 130px;">
                </div>
                <div class="col-xs-12 col-sm-8 col-md-8 text-justify lead">
                    Bienvenido a esta sección, aquí se muestran todas tus preguntas y respuestas de seguridad, solo podrás verlas. No podrás editarlas o eliminarlas.
                </div>
          </div>`);
        $("div#container").html('');
        if (obj.length > 0) {
          $("div#container").append(`
                 
                <h2 class="text-center all-tittles">Listado de preguntas</h2>
                <div class="table-responsive">
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                            <div class="div-table-cell" style="width: 3%;">#</div>
                            <div class="div-table-cell" style="width: 15%;">Pregunta</div>
                           
                            <div class="div-table-cell" style="width: 15%;">Respuesta</div>
                        </div>
                    </div>
                </div>
                `);

          for (var i = 0; i < obj.length; i++) {
            $("div#container").append(`
                        <div class="table-responsive">
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list">
                            <div class="div-table-cell" style="width: 3%;">${1 + i
              }</div>
                            <div class="div-table-cell" style="width: 15%;">${obj[i].pregunta
              }</div>
                            
                                <div class="div-table-cell" style="width: 15%;">${obj[i].respuesta}    
                            </div>
                                                    </div>
                    </div>
                </div>
            
                        `);
          }
        } else {
          $("div#container").append(`
                            <div class="container-fluid">
                    <h3 class="text-center all-tittles">No hay preguntas registradas </h3>
                </div>
          
                            `);

        }

        $("div#myModal").modal("hide");
      })
      .fail(function (error) {
        manejoErrores(error)
      });
  }

     //seccion para solicitar una suscripcion
function solicitarSuscripcion() {
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/suscripciones",
      type: "GET",
    })
      .done(function (suscripciones) {
        $("#myModal").modal("hide");
        $("div#confDias").hide();
        $("div#accordion").hide();
        $("div#preguntasF").hide();
        $("#container").show();
        $("div#explicacion").show();
        $("form#nuevaBaseE").hide();
        $("div#editarLibro").hide();
        $("div#enlaces").hide();
        $("form#nuevaBaseD").hide();
        $("form#conf-nucleos").hide();
        $("form#conf-categorias").hide();
        $("div#inicio").hide();
        $("div#cargando").html('');
        $("form#ingresarLibro").hide();
        $("form#formato").hide();
        $("div#seccion").html(` 
                <div class="page-header">
                <h1 class="all-tittles">UNEXPO SBDIP <small>Suscripciones</small></h1>
               </div>`);
       $("div#explicacion").html(`
          <div class="row">
                <div class="col-xs-12 col-sm-4 col-md-3">
                    <img src="/assets/img/identificacion.png" alt="suscripcion" class="img-responsive center-box"
                        style="max-width: 110px;">
                </div>
                <div class="col-xs-12 col-sm-8 col-md-8 text-justify lead">
                    Bienvenido a esta sección, aquí se muestran todas las suscripciones disponibles. El costo esta expresado en dólares del BCV (tasa oficial).
                </div>
          </div>`);
        $("div#container").html('');
        if (suscripciones.suscripciones.length > 0) {
          $("div#container").append(`
                <h2 class="text-center all-tittles">Listado de categorías</h2>
                <div class="table-responsive">
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                            <div class="div-table-cell" style="width: 3%;">#</div>
                            <div class="div-table-cell" style="width: 15%;">Suscripción</div>
                            <div class="div-table-cell" style="width: 15%;">Costo ($ BCV)</div>
                            <div class="div-table-cell" style="width: 15%;">Vigencia en días</div>
                           
                            <div class="div-table-cell" style="width: 8%;">Solicitar</div>
                        </div>
                    </div>
                </div>
                `);

          for (var i = 0; i < suscripciones.suscripciones.length; i++) {
            $("div#container").append(`
                        <div class="table-responsive" id='n_${suscripciones.suscripciones[i].tipo_ts}'>
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list">
                            <div class="div-table-cell" style="width: 3%;">${1 + i
              }</div>
                            <div class="div-table-cell" style="width: 15%;">${suscripciones.suscripciones[i].tipo_ts}</div>
                            <div class="div-table-cell" style="width: 15%;">${suscripciones.suscripciones[i].costo}</div>
                            <div class="div-table-cell" style="width: 15%;">${suscripciones.suscripciones[i].vigencia}</div>
                            
                                <div class="div-table-cell" style="width: 8%;">
                                <button onclick="solicitarUnaSus('${suscripciones.suscripciones[i].tipo_ts}')" class="btn btn-info"><i class="zmdi zmdi-file-text"></i></button>
    
                            </div>
                           
                        </div>
                    </div>
                </div>
            
                        `);
          }
        } else {
          $("div#container").append(`
                            <div class="container-fluid">
                    <h3 class="text-center all-tittles">No hay suscripciones registrados </h3>
                </div>
          
                            `);

        }

        $("div#myModal").modal("hide");
      })
      .fail(function (error) {
        manejoErrores(error)
      });
  };

  ///
     //seccion para solicitar una suscripcion no registrado
function solicitarSuscripcionNoR() {
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/suscripciones/no_registrado",
      type: "GET",
    })
      .done(function (suscripciones) {
        $("#myModal").modal("hide");
        $("div#confDias").hide();
        $("div#accordion").hide();
        $("div#preguntasF").hide();
        $("#container").show();
        $("div#explicacion").show();
        $("form#nuevaBaseE").hide();
        $("div#editarLibro").hide();
        $("div#enlaces").hide();
        $("form#nuevaBaseD").hide();
        $("form#conf-nucleos").hide();
        $("form#conf-categorias").hide();
        $("div#inicio").hide();
        $("div#cargando").html('');
        $("form#ingresarLibro").hide();
        $("form#formato").hide();
        $("div#seccion").html(` 
                <div class="page-header">
                <h1 class="all-tittles">UNEXPO SBDIP <small>Suscripciones</small></h1>
               </div>`);
       $("div#explicacion").html(`
          <div class="row">
                <div class="col-xs-12 col-sm-4 col-md-3">
                    <img src="/assets/img/identificacion.png" alt="suscripcion" class="img-responsive center-box"
                        style="max-width: 110px;">
                </div>
                <div class="col-xs-12 col-sm-8 col-md-8 text-justify lead">
                    Bienvenido a esta sección, aquí se muestran todas las suscripciones disponibles. El costo esta expresado en dólares del BCV (tasa oficial).
                </div>
          </div>`);
        $("div#container").html('');
        if (suscripciones.suscripciones.length > 0) {
          $("div#container").append(`
                <h2 class="text-center all-tittles">Listado de categorías</h2>
                <div class="table-responsive">
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                            <div class="div-table-cell" style="width: 3%;">#</div>
                            <div class="div-table-cell" style="width: 15%;">Suscripción</div>
                            <div class="div-table-cell" style="width: 15%;">Costo ($ BCV)</div>
                            <div class="div-table-cell" style="width: 15%;">Vigencia en días</div>
                           
                            <div class="div-table-cell" style="width: 8%;">Solicitar</div>
                        </div>
                    </div>
                </div>
                `);

          for (var i = 0; i < suscripciones.suscripciones.length; i++) {
            $("div#container").append(`
                        <div class="table-responsive" id='n_${suscripciones.suscripciones[i].tipo_ts}'>
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list">
                            <div class="div-table-cell" style="width: 3%;">${1 + i
              }</div>
                            <div class="div-table-cell" style="width: 15%;">${suscripciones.suscripciones[i].tipo_ts}</div>
                            <div class="div-table-cell" style="width: 15%;">${suscripciones.suscripciones[i].costo}</div>
                            <div class="div-table-cell" style="width: 15%;">${suscripciones.suscripciones[i].vigencia}</div>
                            
                                <div class="div-table-cell" style="width: 8%;">
                                <button onclick="solicitarUnaSus('${suscripciones.suscripciones[i].tipo_ts}')" class="btn btn-info"><i class="zmdi zmdi-file-text"></i></button>
    
                            </div>
                           
                        </div>
                    </div>
                </div>
            
                        `);
          }
        } else {
          $("div#container").append(`
                            <div class="container-fluid">
                    <h3 class="text-center all-tittles">No hay suscripciones registrados </h3>
                </div>
          
                            `);

        }

        $("div#myModal").modal("hide");
      })
      .fail(function (error) {
        manejoErrores(error)
      });
  };

     //seccion para solicitar una suscripcion
     function miSolicitud() {
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/mi-solicitud",
      type: "GET",
    })
      .done(function (suscripciones) {
        $("#myModal").modal("hide");
        $("div#confDias").hide();
        $("div#preguntasF").hide();
        $("#container").show();
        $("div#explicacion").show();
        $("form#nuevaBaseE").hide();
        $("div#editarLibro").hide();
        $("div#enlaces").hide();
        $("form#nuevaBaseD").hide();
        $("form#conf-nucleos").hide();
        $("form#conf-categorias").hide();
        $("div#inicio").hide();
        $("div#cargando").html('');
        $("form#ingresarLibro").hide();
        $("form#formato").hide();
        $("div#accordion").hide();
        $("#formato-enlinea-dos").hide();
        $("div#seccion").html(` 
                <div class="page-header">
                <h1 class="all-tittles">UNEXPO SBDIP <small>Suscripciones</small></h1>
               </div>`);
       $("div#explicacion").html(`
          <div class="row">
                <div class="col-xs-12 col-sm-4 col-md-3">
                    <img src="/assets/img/identificacion.png" alt="suscripcion" class="img-responsive center-box"
                        style="max-width: 110px;">
                </div>
                <div class="col-xs-12 col-sm-8 col-md-8 text-justify lead">
                    Bienvenido a esta sección, aquí se muestran todas tus suscripciones, tanto vigentes como vencidas y pendientes. Si estás en la espera de aprobación la fecha de vencimiento de la suscripción se re calculara cuando está sea aprobada.
                </div>
          </div>`);
        $("div#container").html('');
        if (suscripciones.length > 0) {
          $("div#container").append(`
                <h2 class="text-center all-tittles">Suscripciones</h2>
                <div class="table-responsive">
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                            <div class="div-table-cell" style="width: 3%;">#</div>
                            <div class="div-table-cell" style="width: 15%;">Suscripción</div>
                            <div class="div-table-cell" style="width: 15%;">Estado</div>
                            <div class="div-table-cell" style="width: 15%;">Vigencia</div>
                            

                        </div>
                    </div>
                </div>
                `);

          for (var i = 0; i < suscripciones.length; i++) {
            $("div#container").append(`
                        <div class="table-responsive" id='n_${suscripciones[i].tipo_ts}'>
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list">
                            <div class="div-table-cell" style="width: 3%;">${1 + i
              }</div>
                            <div class="div-table-cell" style="width: 15%;">${suscripciones[i].tipo}</div>
                            <div class="div-table-cell" style="width: 15%;">${suscripciones[i].estado_s}</div>
                            <div class="div-table-cell" style="width: 15%;">${suscripciones[i].fecha_c}</div>
                            
                               
                           
                        </div>
                    </div>
                </div>
            
                        `);
          }
        } else {
          $("div#container").append(`
                            <div class="container-fluid">
                    <h3 class="text-center all-tittles">No hay suscripciones registradas </h3>
                </div>
          
                            `);

        }

        $("div#myModal").modal("hide");
      })
      .fail(function (error) {
        manejoErrores(error)
      });
  };


  


///  solicitar una suscripcion
function solicitarUnaSus(input) {

  $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/datosBancarios",
      type: "GET",
    })
      .done(function (res) {
        $("div#myModal").modal("hide");
        $("p#botonSolicitar").html(`<button type="submit" onclick="javascript: enviarSolicitud('${input}')" class="btn btn-primary">Solicitar</button>`);
        $("#imagenC").attr('src', res);
    $("#imagenC").attr('data-original', res);
    $("#myModal8").modal("show");
      })
      .fail(function (error) {
        manejoErrores(error);
      });
};
// enviar solicitud de una suscripcion
function enviarSolicitud(input) {
  $("#myModal8").modal("hide");
    $("#myLabel").html('');
    $("#myLabel").html('Carga de comprobante');
        $("#modal-body-4").html(`
  
        <form  method="post" id="solicitarS" autocomplete="off">

          
            <h4 class="text-center all-tittles" style="margin-bottom: 10px;">Recuerda que el comprobante debe ser formato jpg, jpeg, png ó pdf</h4>

                  <input id="suscripcion"   name="suscripcion" type="text"
                  class="material-control material-control-login"  
                    required="" maxlength="100"
                    pattern="(^([a-zA-Zá-ú]{1,})$)" value="${input}"
                    data-toggle="tooltip" data-placement="top" readonly>
                  <span class="highlight"></span>
                  <span class="bar"></span>
                  <label> </label>
                  <table class="table table-responsive " style="table-layout: fixed; border: none;">
                    <tr id="tr-img-1" style="border: none;">
                      <td style="width: 200px;  border: none;">
                   
                        <input onchange="comprobarFIS(this)"  id="img-1" name="comprobante" type="file" required=""
                          class="material-control tooltips-general" data-toggle="tooltip" data-placement="top"
                          title="Imagen">
                        <span class="highlight"></span>
                        <span class="bar"></span>
                        <label>Comprobante del pago</label>


                      </td>
                      <td style="width: 30px;  border: none;" id="ico-1">

                      </td>
                    </tr>
                    <tr id="tr2-img-1">
                      <td style="width: 200px; border: none;">
                        <p class="text-center" id="formato-img-1"></p>

                      </td>
                      <td style="width: 30px;  border: none;">
                      </td>
                    </tr>
                  </table>
                  
           <p class="text-center">
             <button type="reset" id="resetSolicitud" class="btn btn-info">Limpiar</button>
             <button type="submit" class="btn btn-primary">Enviar comprobante</button>
             
           </p>
           
               
       </form> 
  `);
        $("#myModal4").modal("show");
}


    function ver(input) {

        let cota = input;
        $.ajax({
            beforeSend: function () {
                $("p#modal-p-center").html(
                    ' <img src="/assets/gif/loading-22.gif" width="100" height="100" />'
                );
                $("div#myModal").modal({
                  backdrop: 'static',
                  keyboard: false,
                  show:true
                });

            },
            url: `/ver_libro?cota=${cota}`,
            type: 'POST'

        })
            .done(function (libro) {
                let url = libro.libro[0].url;
                let titulo = libro.libro[0].title;
                let suscripcion = libro.usuarioL.tipo_s;
                let estado = libro.usuarioL.estado_s;
                $("div#myModal").modal("hide");
                $("div#tutor").html('');
                $("#myLabel").html('Informacion del libro');
                $("div#modal-body-4").html(`
           <form>
             <div style="height:50px;">
             <div class="form-group row">
             <label for="id1" class="col-sm-2 col-form-label">Tipo de libro</label>
             <div class="col-sm-10">
             <input value="${libro.libro[0].type}"  type="text" class="tooltips-general material-control"  class="form-control " id="id1" readonly>
             </div>
             </div>
             <div class="form-group row">
             <label for="id2" class="col-sm-2 col-form-label">Tipo de suscripción</label>
             <div class="col-sm-10">
             <input value="${libro.libro[0].tipo_s}"  type="text" class="tooltips-general material-control"  class="form-control " id="id2" readonly>
             </div>
             </div>
             <div class="form-group row">
             <label for="id3" class="col-sm-2 col-form-label">Cota</label>
             <div class="col-sm-10">
             <input value="${libro.libro[0].cota}" type="text" class="tooltips-general material-control" class="form-control" id="id3" readonly>
             </div>
             </div>
             <div class="form-group row">
             <label for="id4" class="col-sm-2 col-form-label">Título</label>
             <div class="col-sm-10">
             <input value="${libro.libro[0].title}" type="text" class="tooltips-general material-control" class="form-control" id="id4" readonly>
             </div>
             </div>
             <div class="form-group row">
             <label for="id5" class="col-sm-2 col-form-label">Autor</label>
             <div class="col-sm-10">
             <input value="${libro.libro[0].creator}" type="text" class="tooltips-general material-control" class="form-control" id="id5" readonly>
             </div>
             </div>
   
             <div class="form-group row">
             <label for="id6" class="col-sm-2 col-form-label">Editorial</label>
             <div class="col-sm-10">
             <input value="${libro.libro[0].publisher}" type="text" class="tooltips-general material-control" class="form-control" id="id6" readonly>
             </div>
             </div>
             
             <div class="form-group row">
             <label for="id7" class="col-sm-2 col-form-label">Núcleo</label>
             <div class="col-sm-10">
             <input value="${libro.libro[0].core}" type="text" class="tooltips-general material-control" class="form-control" id="id7" readonly>
             </div>
             </div>
             
             <div class="form-group row">
             <label for="id8" class="col-sm-2 col-form-label">Feha relacionada</label>
             <div class="col-sm-10">
             <input value="${libro.libro[0].date}" type="text" class="tooltips-general material-control" class="form-control" id="id8" readonly>
             </div>
             </div>
             
             <div class="form-group row">
             <label for="id9" class="col-sm-2 col-form-label">Fuente</label>
             <div class="col-sm-10">
             <input value="${libro.libro[0].source}" type="text" class="tooltips-general material-control" class="form-control" id="id9" readonly>
             </div>
             </div>
             
             <div class="form-group row">
             <label for="id10" class="col-sm-2 col-form-label">Lenguaje</label>
             <div class="col-sm-10">
             <input value="${libro.libro[0].language}" type="text" class="tooltips-general material-control" class="form-control" id="id10" readonly>
             </div>
             </div>
             
             <div class="form-group row">
             <label for="id11" class="col-sm-2 col-form-label">Formato</label>
             <div class="col-sm-10">
             <input value="${libro.libro[0].format}" type="text" class="tooltips-general material-control" class="form-control" id="id11" readonly>
             </div>
             </div>
             
             <div class="form-group row">
             <label for="id12" class="col-sm-2 col-form-label">Derechos</label>
             <div class="col-sm-10">
             <input value="${libro.libro[0].rights}" type="text" class="tooltips-general material-control" class="form-control" id="id12" readonly>
             </div>
             </div>
             
             <div class="form-group row">
             <label for="id13" class="col-sm-2 col-form-label">Estado del libro</label>
             <div class="col-sm-10">
             <input value="${libro.libro[0].statusBook}" type="text" class="tooltips-general material-control" class="form-control" id="id13" readonly>
             </div>
             </div>
             
             <div class="form-group row">
             <label for="id14" class="col-sm-2 col-form-label">Ambito del contenido</label>
             <div class="col-sm-10">
             <input value="${libro.libro[0].coverage}" type="text" class="tooltips-general material-control" class="form-control" id="id14" readonly>
             </div>
             </div>
             
             <div class="form-group row">
             <label for="id15" class="col-sm-2 col-form-label">Relación con otro material</label>
             <div class="col-sm-10">
             <input value="${libro.libro[0].relation}" type="text" class="tooltips-general material-control" class="form-control" id="id15" readonly>
             </div>
             </div>
             
             <div class="form-group row">
             <label for="id16" class="col-sm-2 col-form-label">Palabras relacionadas</label>
             <div class="col-sm-10">
             <input value="${libro.libro[0].relation}" type="text" class="tooltips-general material-control" class="form-control" id="id16" readonly>
             </div>
             </div>
             
             <div class="form-group row">
             <label for="id17" class="col-sm-2 col-form-label">Descripción</label>
             <div class="col-sm-10">
             <input value="${libro.libro[0].description}" type="text" class="tooltips-general material-control" class="form-control" id="id17" readonly>
             </div>
             </div>
             <br>
   
             <p class="text-center"> <a onclick="verPDF(this)" role="button" class="btn btn-large btn-primary"  style="background:rgb(45, 101, 206);" id="${libro.libro[0].cota}" data_url="${url}" data_titulo=${titulo}">Ver Pdf del libro </a></p>
           </div>
           <br>
         
             
             </form>
   
           `);
           if (libro.libro[0].format === 'solo en fisico') {
            let q = "a#" + libro.libro[0].cota;
            añadirAtt(q);
            $(q).html('No hay archivo pdf');
        } 
         if (suscripcion === 'estandar' && estado === 'vigente') {
             if (libro.libro[0].tipo_s === 'premium') {
                  let q = "a#" + libro.libro[0].cota;
                  añadirAtt(q);
                  $(q).html('Cambia de suscripción para ver el pdf');
             }
           
         } else if (suscripcion === 'basica' && estado === 'vigente') {
             if  (libro.libro[0].tipo_s === 'premium') {
                  let q = "a#" + libro.libro[0].cota;
                  añadirAtt(q);
                  $(q).html('Cambia de suscripción para ver el pdf');
             } else if (libro.libro[0].tipo_s === 'estandar'){
                let q = "a#" + libro.libro[0].cota;
                  añadirAtt(q);
                  $(q).html('Cambia de suscripción para ver el pdf');
             }
           
         } else if (suscripcion === 'de prueba' && estado === 'vigente') {
            let q = "a#" + libro.libro[0].cota;
                  añadirAtt(q);
                  $(q).html('Paga una suscripción para ver el pdf');
         } else if (estado !== 'vigente') {
            let q = "a#" + libro.libro[0].cota;
                  añadirAtt(q);
                  $(q).html('Renueva tu suscripción para ver el pdf');
         }

                $("div#myModal4").modal('show');

            })
            .fail(function (error) {
               manejoErrores(error);
            });
    };
//eliminar ficha reservada
function eliminarFicha(input) {
    let r = confirm('¿Estas seguro que deseas eliminar esta reservación');
    if (r) {
      
                let cota = input;
                $.ajax({
                    beforeSend: function () {
                        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });

                    },
                    url: `/usuario/eliminarFicha?cota=${cota}`,
                    type: 'delete'
                })
                    .done(function (res) {
                      $("#myModal").modal("hide");
                            $("p#modal-p-center6").html(`${res}`);
                            $("#myModal6").modal("show");  
                            
                            if (res === 'Se ha eliminado con éxito') {
                            let q = "#tab_" + cota;
                            $(q).remove();
                        }
                        seccionMisR();
                    })
                    .fail(function (error) {
                       manejoErrores(error);
                    });
}
};
function sobresaltarFecha(res, i) {

        let fechaActual = new Date();
        let fecha_d = res.fichas[i].fecha_d;
        let dia = fecha_d.split('-')[2];
        let mes = fecha_d.split('-')[1] - 1;
        let año = fecha_d.split('-')[0];
        let fecha_devolucion = new Date(año, mes, dia);
        let resultado = fechaActual.getTime() > fecha_devolucion.getTime();
        if (resultado) {
            let q = "#fecha-d" + res.fichas[i].cota_f;
            $(q).css({ 'color': 'red' });
        }
    };

function actualizarFormato(t, tp, libro) {
        $(t).html(`${libro.titulo}`);
        $(tp).html(`${libro.tipo_l}`);
    };

     $(function () {
    
        seccionInicio();
 
        $("#myModal4").on('show.bs.modal', function (e) {
            $('input.fecha').attr("min", min());
            $('input.fecha').attr("max", max());
            $('form#reservarL').on("submit", function (e) {

                e.preventDefault();
                let data = $(this).serialize();
                let cota = $("input#cota").val();
                $.ajax({
                    beforeSend: function () {
                        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal4").modal("hide");
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });

                    },
                    url: '/usuario/reservar',
                    type: 'POST',
                    data: data,
                    timeout: 3000
                })
                    .done(function (res) {
                      $("#myModal").modal("hide");
                            $("p#modal-p-center6").html(`${res}`);
                            $("#myModal6").modal("show");  
                            
                            if (res === 'Se ha reservado con exito') {
                            let q = "button#" + cota;
                            añadirAtt(q);
                        }

                    })
                    .fail(function (error) {
                       manejoErrores(error);
                    });

            });

           $("form#solicitarS").on("submit", function (e) {
                e.preventDefault();
                let data = new FormData(this);

                $.ajax({
                    beforeSend: function () {
                        $("p#modal-p-center").html(
                            '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
                        );
                        $("div#myModal4").modal("hide");
                        $("div#myModal").modal({
                            backdrop: 'static',
                            keyboard: false,
                            show: true
                        });

                    },
                    url: "/usuario/solicitarS",
                    type: "POST",
                    data: data,
                    timeout: 3000,
                    processData: false,
                    contentType: false,
                })
                    .done(function (res) {
                        $("#myModal").modal("hide");

                        if (res === 'Se ha solicitado con éxito' || res === 'Ya tiene un petición en espera') {
                            $("p#modal-p-center3").html(`${res}`);
                            $("#myModal3").modal("show");
                        }
                    })
                    .fail(function (error) {
                        manejoErrores(error);
                    });
            });
        });

        $('form#formato-enlinea').on("keyup", function (e) {
            e.preventDefault();
            let data = $(this).serialize();

            $.ajax({
                beforeSend: function () {
                    $("div#cargando").html(
                        '<p class="text-center"><img src="/assets/gif/loading-22.gif"width= "20" height= "20"></p>'
                    );

                },
                url: '/busqueda-especifica',
                type: 'POST',
                data: data
            })
                .done(function (libros) {
                    let resultados = libros.libros[0].length;
                    if (resultados > 0) {
                        cargando.innerHTML = `<h3 class="text-center">Se obtuvieron ${resultados} resultados de tu busqueda</h3>`;
                        container.innerHTML = ` 
              <h2 class="text-center all-tittles">Resultados</h2>
              <div class="table-responsive">
                  <div class="div-table" style="margin:0 !important;">
                      <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                          <div class="div-table-cell" style="width: 6%;">#</div>
                          <div class="div-table-cell" style="width: 10%;">Titulo</div>
                          <div class="div-table-cell" style="width: 8%;">Autor</div>
                          
                          <div class="div-table-cell" style="width: 6%;">Ver</div>
                          <div class="div-table-cell" style="width: 6%;"> 
                          Reservar</div>
                      </div>
              </div>`;
                        for (var i = 0; i < libros.libros[0].length; i++) {

                            container.insertAdjacentHTML('beforeend', `
          <div class="table-responsive" id="${libros.libros[0][i].cota}0">
                  <div class="div-table" style="margin:0 !important;">
                      <div class="div-table-row div-table-row-list">
                          <div  class="div-table-cell" style="width: 6%;">${i + 1}</div>
                          <div  class="div-table-cell" style="width: 10%;">${libros.libros[0][i].title}</div>
                          
                          <div class="div-table-cell" style="width: 8%;">${libros.libros[0][i].creator}</div>
                          
                         
                          <div class="div-table-cell" style="width: 6%;">
                              
                              <button class="btn btn-info"  onclick="javascript:ver('${libros.libros[0][i].cota}')" if ><i class="zmdi zmdi-file-text"></i></button>
                          
                          </div>
                          <div class="div-table-cell" style="width: 6%;">
                              
                            <button class="btn btn-success" id="${libros.libros[0][i].cota}" onclick="javascript:reservarLibro(this)"><i class="zmdi zmdi-timer"></i></button>
  
                           
                          </div>
                      </div>
                  </div>
              </div>`);
                            if (libros.libros[0][i].estado_l === 'no disponible') {
                                let q = "button#" + libros.libros[0][i].cota;
                                añadirAtt(q);
                            };
                        }

                        document.getElementsByTagName("button")[1].focus({ preventScroll: true });
                    } else {
                        cargando.innerHTML = '<h3 class="text-center">No se obtuvieron resultados</h3>';
                        container.innerHTML = '';


                    }
                })
                .fail(function (error) {
                    limpiarButton.click();
                    manejoErrores(error);
                });
        });
        $('form#formato-enlinea').on("change", function (e) {
            e.preventDefault();
            let data = $(this).serialize();

            $.ajax({
                beforeSend: function () {
                    $("div#cargando").html(
                        '<p class="text-center"><img src="/assets/gif/loading-22.gif"width= "20" height= "20"></p>'
                    );

                },
                url: '/busqueda-especifica',
                type: 'POST',
                data: data
            })
                .done(function (libros) {
                    let resultados = libros.libros[0].length;
                    if (resultados > 0) {
                        cargando.innerHTML = `<h3 class="text-center">Se obtuvieron ${resultados} resultados de tu busqueda</h3>`;
                        container.innerHTML = ` 
              <h2 class="text-center all-tittles">Resultados</h2>
              <div class="table-responsive">
                  <div class="div-table" style="margin:0 !important;">
                      <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                          <div class="div-table-cell" style="width: 6%;">#</div>
                          <div class="div-table-cell" style="width: 10%;">Titulo</div>
                          <div class="div-table-cell" style="width: 8%;">Autor</div>
                          
                          <div class="div-table-cell" style="width: 6%;">Ver</div>
                          <div class="div-table-cell" style="width: 6%;"> 
                          Reservar</div>
                      </div>
              </div>`;
                        for (var i = 0; i < libros.libros[0].length; i++) {

                            container.insertAdjacentHTML('beforeend', `
          <div class="table-responsive" id="${libros.libros[0][i].cota}0">
                  <div class="div-table" style="margin:0 !important;">
                      <div class="div-table-row div-table-row-list">
                          <div  class="div-table-cell" style="width: 6%;">${i + 1}</div>
                          <div  class="div-table-cell" style="width: 10%;">${libros.libros[0][i].title}</div>
                          
                          <div class="div-table-cell" style="width: 8%;">${libros.libros[0][i].creator}</div>
                          
                         
                          <div class="div-table-cell" style="width: 6%;">
                              
                              <button class="btn btn-info"  onclick="javascript:ver('${libros.libros[0][i].cota}')" if ><i class="zmdi zmdi-file-text"></i></button>
                          
                          </div>
                          <div class="div-table-cell" style="width: 6%;">
                              
                            <button class="btn btn-success" id="${libros.libros[0][i].cota}" onclick="javascript:reservarLibro(this)"><i class="zmdi zmdi-timer"></i></button>
  
                           
                          </div>
                      </div>
                  </div>
              </div>`);
                            if (libros.libros[0][i].estado_l === 'no disponible') {
                                let q = "button#" + libros.libros[0][i].cota;
                                añadirAtt(q);
                            };
                        }

                        document.getElementsByTagName("button")[1].focus({ preventScroll: true });
                    } else {
                        cargando.innerHTML = '<h3 class="text-center">No se obtuvieron resultados</h3>';
                        container.innerHTML = '';


                    }
                })
                .fail(function (error) {
                    limpiarButton.click();
                    manejoErrores(error);
                });
        });

        $('form#formato-enlinea-dos').on("keyup", function (e) {
            e.preventDefault();
            let data = $(this).serialize();

            $.ajax({
                beforeSend: function () {
                    $("div#cargando").html(
                        '<p class="text-center"><img src="/assets/gif/loading-22.gif"width= "20" height= "20"></p>'
                    );

                },
                url: '/busqueda-especifica',
                type: 'POST',
                data: data
            })
                .done(function (libros) {
                    let resultados = libros.libros[0].length;
                    cargando.innerHTML = `<h3 class="text-center">Se obtuvieron ${resultados} resultados de tu busqueda</h3>`;
                    if (resultados > 0) {
                        $("div#container").html(`
         
         <h2 class="text-center all-tittles">Libros</h2>
         <div class="table-responsive">
             <div class="div-table" style="margin:0 !important;">
                 <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                     <div class="div-table-cell" style="width: 3%;">#</div>
                     <div class="div-table-cell" style="width: 15%;">Título</div>
                     <div class="div-table-cell" style="width: 8%;">Autor</div>
                     <div class="div-table-cell" style="width: 8%;">Info. Libro</div>
                 </div>
             </div>
         </div>
         `);
 
                     for (var i = 0; i < libros.libros[0].length; i++) {
                         var cota = libros.libros[0][i].cota;
                         $("div#container").append(`
                 <div class="table-responsive" >
             <div class="div-table" style="margin:0 !important;">
                 <div class="div-table-row div-table-row-list">
                     <div class="div-table-cell" style="width: 3%;">${1 + i
                             }</div>
                     <div class="div-table-cell" style="width: 15%;">${libros.libros[0][i].title
                             }</div> 
                     <div class="div-table-cell" style="width: 8%;">${libros.libros[0][i].creator
                             }</div>
                     <div class="div-table-cell" style="width: 8%;">
                         <button class="btn btn-info" onclick="ver('${libros.libros[0][i].cota
                             },'${libros.usuarioL}')"><i class="zmdi zmdi-file-text"></i></button>
                     </div>
                 </div>
             </div>
         </div> `);
 
                     }
                    } else {
                        cargando.innerHTML = '<h3 class="text-center">No se obtuvieron resultados</h3>';
                        container.innerHTML = '';


                    }
                })
                .fail(function (error) {
                    limpiarButton.click();
                    manejoErrores(error);
                });
        });
        $('form#formato-enlinea-dos').on("change", function (e) {
            e.preventDefault();
            let data = $(this).serialize();

            $.ajax({
                beforeSend: function () {
                    $("div#cargando").html(
                        '<p class="text-center"><img src="/assets/gif/loading-22.gif"width= "20" height= "20"></p>'
                    );

                },
                url: '/busqueda-especifica',
                type: 'POST',
                data: data
            })
                .done(function (libros) {
                    let resultados = libros.libros[0].length;
                    cargando.innerHTML = `<h3 class="text-center">Se obtuvieron ${resultados} resultados de tu busqueda</h3>`;
                    if (resultados > 0) {
                        $("div#container").html(`
         
         <h2 class="text-center all-tittles">Libros</h2>
         <div class="table-responsive">
             <div class="div-table" style="margin:0 !important;">
                 <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                     <div class="div-table-cell" style="width: 3%;">#</div>
                     <div class="div-table-cell" style="width: 15%;">Título</div>
                     <div class="div-table-cell" style="width: 8%;">Autor</div>
                     <div class="div-table-cell" style="width: 8%;">Info. Libro</div>
                 </div>
             </div>
         </div>
         `);
 
                     for (var i = 0; i < libros.libros[0].length; i++) {
                         var cota = libros.libros[0][i].cota;
                         $("div#container").append(`
                 <div class="table-responsive" >
             <div class="div-table" style="margin:0 !important;">
                 <div class="div-table-row div-table-row-list">
                     <div class="div-table-cell" style="width: 3%;">${1 + i
                             }</div>
                     <div class="div-table-cell" style="width: 15%;">${libros.libros[0][i].title
                             }</div> 
                     <div class="div-table-cell" style="width: 8%;">${libros.libros[0][i].creator
                             }</div>
                       <div class="div-table-cell" style="width: 8%;">
                         <button class="btn btn-info" onclick="ver('${libros.libros[0][i].cota
                             }')"><i class="zmdi zmdi-file-text"></i></button>
                     </div>
                 </div>
             </div>
         </div> `);
 
                     }
                    } else {
                        cargando.innerHTML = '<h3 class="text-center">No se obtuvieron resultados</h3>';
                        container.innerHTML = '';


                    }
                })
                .fail(function (error) {
                    limpiarButton.click();
                    manejoErrores(error);
                });
        });



    });

 //solicitas y muestras las noticias
 function mostrarNoticias() {
  
  $.ajax({
    beforeSend: function () {
      $("p#modal-p-center").html(
        '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
      );
      $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
    },
    url: "/noticias",
    type: "GET",
  })
    .done(function (noticias) {

      $("div#cuadronot").html('');

      if (noticias.length > 0) {
        
        for (var i = 0; i < noticias.length; i++) {

          $('div#cuadronot').append(`<li>
<div class="container-fluid" style="background-color: rgb(223, 231, 253);"   >
 <div onclick="javascript: verUnaNoticia('${noticias[i].id_n}')">   
       
       <img src="${noticias[i].url_imagen}" alt="">
       <a class="news-title" href="#">${noticias[i].titulo_noticia}</a>
       <span class="news-text text-center">${noticias[i].text_noticia}</span> </div>
      </div>
   </li>
   `);
  }
if (noticias.length == 1) {
    if (!intervalId) {
 
 $("div#myModal").modal("hide");
} else {
clearInterval(intervalId)
intervalId = false;
$("div#myModal").modal("hide"); 
}
   
} else if (noticias.length > 1) {


    $("div#myModal").modal("hide");
    let bandera = 2;
     $("div#myModal").on("hidden.bs.modal", function () {
              if (bandera == 2) {
               
                bandera = 0;
                intervalId = true;
                intervalId = setInterval(removeFirst, 7500);
              }
            });
  
}
        


      } else {
        $("div#cuadronot").append(`
                          <div class="container-fluid">
                  <h3 class="text-center all-tittles">No hay noticias recientes </h3>
              </div>
        
                          `);
                          if (!intervalId) {
 
 $("div#myModal").modal("hide");
} else {
clearInterval(intervalId)
intervalId = false;
$("div#myModal").modal("hide"); 
}
      }

     
     
    })
    .fail(function (error) {
      manejoErrores(error);
    });

};

 //solicitas y muestras las noticias
 function mostrarPreguntas() {
    $.ajax({
      beforeSend: function () {
        $("p#modal-p-center").html(
          '<img src="/assets/gif/loading-22.gif"width= "100" height= "100">'
        );
        $("div#myModal").modal({
          backdrop: 'static',
          keyboard: false,
          show:true
        });
      },
      url: "/preguntas-frecuentes",
      type: "GET",
    })
      .done(function (preguntas) {
        $("div#accordion").html('');

        if (preguntas.length > 0) {
          var j = 0;
          for (var i = 0; i < preguntas.length; i++) {

            $('div#accordion').append(`
        <div class="panel panel-default">
        
          <div class="panel-heading p-3 mb-3"  role="tab" id="heading${i}">
            <h3 class="panel-title">
              <a class="collapsed" role="button" title="" data-toggle="collapse" data-parent="#accordion" href="#collapse${i}" aria-expanded="true" aria-controls="collapse${i}">
                ${preguntas[i].titulo_pregunta} 
              </a>
            </h3> 
          </div> 
          <div id="collapse${i}" class="panel-collapse collapse" role="tabpanel" aria-labelledby="heading0">
            <div class="panel-body px-3 mb-4">
              ${preguntas[i].text_respuesta}
             </div> 
          </div> 
        </div>
        
     `);


          }


        } else {
          $("div#accordion").append(`
                            <div class="container-fluid">
                    <h3 class="text-center all-tittles">No hay preguntas frecuentes guardadas </h3>
                </div>
          
                            `);
        }

        $("div#myModal").modal("hide");
      })
      .fail(function (error) {
        manejoErrores(error);
      });

  };
  $(document).on('click', '.modal', function () {
     $("button#login").on("click", function(e) {
       e.preventDefault();
      window.location = "/login"
     });
    });
    function ocultarCampos(check) {
    var limpiarButton = document.getElementById("limpiarButton");
    limpiarButton.click();
    var isChecked = document.getElementById("ocultar").checked;
    if (isChecked) {
      $('form#formato-enlinea').hide();
      $.ajax({
        beforeSend: function () {
          $("div#cargando").html(
            '<p class="text-center"><img src="/assets/gif/loading-22.gif"width= "20" height= "20"></p>'
          );

        },
        url: '/todos-libros',
        type: 'POST'
      })
      .done(function (libros) {
          limpiarButton.click();
          let resultados = libros.libros.length;
          if (resultados > 0) {
            cargando.innerHTML = `<h3 class="text-center">Se obtuvieron ${resultados} resultados de tu busqueda</h3>`;
            container.innerHTML = ` 
              <h2 class="text-center all-tittles">Resultados</h2>
              <div class="table-responsive">
                  <div class="div-table" style="margin:0 !important;">
                      <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                        <div class="div-table-cell" style="width: 6%;">#</div>
                        <div class="div-table-cell" style="width: 10%;">Título</div>
                        
                        <div class="div-table-cell" style="width: 8%;">Autor</div>
                        
                        <div class="div-table-cell" style="width: 6%;">Ver</div>
                        <div class="div-table-cell" style="width: 6%;"> 
                        Reservar</div>
                      </div>
              </div>`;


            for (var i = 0; i < libros.libros.length; i++) {

              container.insertAdjacentHTML('beforeend', `
          <div class="table-responsive" id="${libros.libros[i].cota}0">
                  <div class="div-table" style="margin:0 !important;">
                      <div class="div-table-row div-table-row-list">
                          <div  class="div-table-cell" style="width: 6%;">${i + 1}</div>
                          <div  class="div-table-cell" id="${libros.libros[i].cota}_cota" style="width: 10%;">${libros.libros[i].cota}</div>
                         
                          
                          <div class="div-table-cell" id="${libros.libros[i].cota}_titulo" style="width: 8%;">${libros.libros[i].title}</div>
                          
                         
                          <div class="div-table-cell" style="width: 6%;">
                              
                              <button class="btn btn-info"  onclick="javascript:ver('${libros.libros[i].cota}')" if ><i class="zmdi zmdi-file-text"></i></button>
                          
                          </div>
                          <div class="div-table-cell" style="width: 6%;">
                              
                            <button class="btn btn-success" id="${libros.libros[i].cota}" onclick="javascript:reservarLibro(this)"><i class="zmdi zmdi-timer"></i></button>
  
                           
                          </div>
                      </div>
                  </div>
              </div>`);

              if (libros.libros[i].statusBook === 'no disponible') {
                                let q = "button#" + libros.libros[i].cota;
                                añadirAtt(q);
                            };
                        
            }

            document.getElementsByTagName("button")[1].focus({ preventScroll: true });
          } else {
            cargando.innerHTML = '<h3 class="text-center">No se obtuvieron resultados</h3>';
            container.innerHTML = '';


          }
        })
        .fail(function (error) {
          limpiarButton.click();
          cargando.innerHTML = '<img src="/assets/icons/notificacion-error.ico"width= "20" height= "20">';
        });
  

    } else {

      $('form#formato-enlinea').show();
      $("div#container").html('');
      $("div#cargando").html('');
    }
  };
 
    function seccionReservar() {
        var ocultar = document.getElementById("ocultar");
        var seccion = document.getElementById("seccion");
        var explicacion = document.getElementById("explicacion");
        var tabla = document.getElementById("tabla");
        var inicio = document.getElementById("inicio");
        var container = document.getElementById("container");
        var cargando = document.getElementById("cargando");
        var formatoEnLinea = document.getElementById("formato-enlinea");
        var busquedaC = document.getElementById("busquedaC");
        var accordion = document.getElementById("accordion");
        var formatoEnLineaDos = document.getElementById("formato-enlinea-dos");
        formatoEnLineaDos.style.display = 'none';
        accordion.style.display = 'none';
        var isChecked = ocultar.checked;
        if (isChecked) {
            ocultar.click();
        }

        seccion.innerHTML = `<div class="page-header">
        <h1 class="all-tittles">UNEXPO SBDIP <small>Reservar</small></h1>
      </div>`;
        explicacion.innerHTML = `
        <div class="row">

<div class="col-xs-12 col-sm-4 col-md-3">
  <img src="/assets/icons/busqueda.ico" alt="pdf" class="img-responsive center-box" style="max-width: 110px;">
</div>
<div class="col-xs-12 col-sm-8 col-md-8 text-justify lead">
  Bienvenido en esta sección podrás reservar uno o varios libros. Solo estan habilitados los que se encuentran
  disponibles físicamente.
</div>
</div>`;
        busquedaC.style.display = 'block';
        formatoEnLinea.style.display = 'block';
        inicio.style.display = 'none';
        cargando.innerHTML = '';
        container.innerHTML = '';
        explicacion.style.display = 'block';
    
        $("div#enlaces").html(`
            <ul class="nav nav-tabs nav-justified" style="font-size: 17px;">
                <li id="rreservar" class="active"><a href="javascript:seccionReservar()">Reservar</a></li>
                <li id="misR"><a href="javascript:seccionMisR()">Mis reservaciones</a></li>
                <li id="misP"><a href="javascript:seccionMisP()">Mis préstamos</a></li>
            </ul>`);
            $("li#rreservar").addClass("active");
        $("li#misP").removeClass("active");
        $("li#misR").removeClass("active");
        $("#enlaces").show();

    };
    function seccionInicio() {
    var seccion = document.getElementById("seccion");
    var explicacion = document.getElementById("explicacion");
    var enlaces = document.getElementById("enlaces");
    var container = document.getElementById("container");
    var cargando = document.getElementById("cargando");
    var busquedaC = document.getElementById("busquedaC");
    var formatoEnLinea = document.getElementById("formato-enlinea");
    var accordion = document.getElementById("accordion");
    var inicio = document.getElementById("inicio");
    var formatoEnLineaDos = document.getElementById("formato-enlinea-dos");
    var cuadronot = document.getElementById("cuadronot");
    cuadronot.style.display = 'block';
    formatoEnLineaDos.style.display = 'none';
    inicio.style.display = 'block'
 
    accordion.style.display = 'none';
    formatoEnLinea.style.display = 'none';
    busquedaC.style.display = 'none'
    enlaces.style.display = 'none';
    seccion.innerHTML = ` <div class="page-header">
                <h1 class="all-tittles">
                    UNEXPO SBDIP <small>Inicio</small>
                </h1>
            </div>`;
    explicacion.style.display = 'none';
   
    cargando.innerHTML = '';
    container.innerHTML = '';
    mostrarNoticias();

  };


    function seccionMisR() {
        $.ajax({
            beforeSend: function () {
                $("#modal-p-center").html(` <img src="/assets/gif/loading-22.gif" width="100" height="100" />`);
                $("div#myModal").modal({
                 backdrop: 'static',
                 keyboard: false,
                 show:true
                });
            },
            url: '/usuario/mis-reservas',
            type: 'GET'
        })
            .done(function (res) {
                let fechaActual = new Date();
                $("div#cargando").html('');
                $("div#seccion").html(` 
            <div class="page-header">
        <h1 class="all-tittles">UNEXPO SBDIP <small>Mis reservaciones</small></h1>
      </div>`);
                $("div#explicacion").html(`<div class="row">

<div class="col-xs-12 col-sm-4 col-md-3">
  <img src="/assets/img/calendar.png" alt="pdf" class="img-responsive center-box" style="max-width: 110px;">
</div>
<div class="col-xs-12 col-sm-8 col-md-8 text-justify lead">
    Bienvenido en esta sección podrás ver las reservaciones que tienes activas.
  Si hiciste una reservacion y nunca la concretaste, esta será eliminada automaticamente.
</div>
</div>`);
                $("form#formato-enlinea").hide();
                $("div#busquedaC").hide();
                $("#explicacion").show();
                $("#accordion").hide();
                $("form#formato-enlinea-dos").hide();
                $("#cuadronot").hide();
                $("div#inicio").hide();
             $("div#enlaces").show();
    
      
            $("div#enlaces").html(`
            <ul class="nav nav-tabs nav-justified" style="font-size: 17px;">
                <li id="rreservar" ><a href="javascript:seccionReservar()">Reservar</a></li>
                <li id="misR" class="active" ><a href="javascript:seccionMisR()">Mis reservaciones</a></li>
                <li id="misP"><a href="javascript:seccionMisP()">Mis préstamos</a></li>
            </ul>`);
            $("li#misP").removeClass("active");
        $("li#misR").addClass("active");
        $("li#rreservar").removeClass("active");
        $("#container").show();
         
     
                $("#myModal").modal("hide");
                if (res.fichas.length > 0) {

                    $("div#container").html(`
                 
                <h2 class="text-center all-tittles">Mis reservaciones</h2>
                <div class="table-responsive">
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                            <div class="div-table-cell" style="width: 3%;">#</div>
                            <div class="div-table-cell" style="width: 15%;">Cota</div>
                           <div class="div-table-cell" style="width: 10%;">F. Retiro</div>
                            <div class="div-table-cell" style="width: 10%;">F. Devolución</div>
                            
                            <div class="div-table-cell" style="width: 8%;">Info. Libro</div>
                            <div class="div-table-cell" style="width: 10%;">Eliminar</div>
                            
                            
                        </div>
                    </div>
                </div>
                `);

                    for (var i = 0; i < res.fichas.length; i++) {
                        $("div#container").append(`
                        <div class="table-responsive" id="tab_${res.fichas[i].cota_f
                            }">
                    <div class="div-table" style="margin:0 !important;">
                        <div class="div-table-row div-table-row-list">
                            <div class="div-table-cell" style="width: 3%;">${1 + i
                            }</div>
                            <div class="div-table-cell" style="width: 15%;">${res.fichas[i].cota_f
                            }</div> 
                            <div class="div-table-cell"  style="width: 10%;">${res.fichas[i].fecha_e
                            } </div>
                            <div class="div-table-cell"  style="width: 10%;" id="fecha-d${res.fichas[i].cota_f}">${res.fichas[i].fecha_d
                            } </div>
                            
                            <div class="div-table-cell" style="width: 8%;">
                                <button class="btn btn-info" onclick="ver('${res.fichas[i].cota_f}')"><i class="zmdi zmdi-file-text"></i></button>
                            </div>
                            <div class="div-table-cell"  style="width: 10%;">
                                <button class="btn btn-danger" onclick="eliminarFicha('${res.fichas[i].cota_f}')"><i class="zmdi zmdi-delete"></i></button></div>
                            
                            
                        </div>
                    </div>
                </div> `);
                        

                    }
                } else {

                    $("div#container").html(`
                            <div class="container-fluid">
                    <h3 class="text-center all-tittles">No hay reservaciones </h3>
                </div>
          
                            `);
                }
            })
            .fail(function (error) {

               manejoErrores(error);

            });


    };

    function seccionMisP() {
        $.ajax({
            beforeSend: function () {
                $("#modal-p-center").html(` <img src="/assets/gif/loading-22.gif" width="100" height="100" />`);
                $("div#myModal").modal({
                 backdrop: 'static',
                 keyboard: false,
                 show:true
                });
            },
            url: '/usuario/mis-prestamos',
            type: 'GET'
        })
            .done(function (res) {
                $("div#cargando").html('');
                
                $("form#formato-enlinea-dos").hide();
                $("div#seccion").html(` 
            <div class="page-header">
        <h1 class="all-tittles">UNEXPO SBDIP <small>Mis préstamos</small></h1>
      </div>`);
                $("div#explicacion").html(`<div class="row">

<div class="col-xs-12 col-sm-4 col-md-3">
  <img src="/assets/img/calendar_book.png" alt="pdf" class="img-responsive center-box" style="max-width: 110px;">
</div>
<div class="col-xs-12 col-sm-8 col-md-8 text-justify lead">
    Bienvenido en esta sección podrás ver los préstamos que tienes activos hasta la fecha actual.
</div>
</div>`);
                $("form#formato-enlinea").hide();
                $("div#busquedaC").hide();
                $("div#inicio").hide();
                $("#explicacion").show();
                $("#accordion").hide();
                $("#cuadronot").hide();
                $("div#enlaces").html(`
            <ul class="nav nav-tabs nav-justified" style="font-size: 17px;">
                <li id="rreservar" class="active"><a href="javascript:seccionReservar()">Reservar</a></li>
                <li id="misR"><a href="javascript:seccionMisR()">Mis reservaciones</a></li>
                <li id="misP"><a href="javascript:seccionMisP()">Mis préstamos</a></li>
            </ul>`);
            $("li#misP").addClass("active");
        $("li#misR").removeClass("active");
        $("li#rreservar").removeClass("active");
$("#enlaces").show();
$("#container").show();

                $("#myModal").modal("hide");
                if (res.fichas.length > 0) {
                    $("div#container").html(`
         
        <h2 class="text-center all-tittles">Mis préstamos</h2>
        <div class="table-responsive">
            <div class="div-table" style="margin:0 !important;">
                <div class="div-table-row div-table-row-list" style="background-color:#DFF0D8; font-weight:bold;">
                    <div class="div-table-cell" style="width: 3%;">#</div>
                    <div class="div-table-cell" style="width: 15%;">Cota</div>
                    <div class="div-table-cell" style="width: 8%;">Título</div>
                    <div class="div-table-cell" style="width: 8%;">Autor</div>
                    <div class="div-table-cell" style="width: 10%;">F. Solicitud</div>
                    <div class="div-table-cell" style="width: 10%;">F. Entrega</div>
                    
                    <div class="div-table-cell" style="width: 8%;">Info. Libro</div>
                </div>
            </div>
        </div>
        `);

                    for (var i = 0; i < res.fichas.length; i++) {
                        var cota = res.fichas[i].cota_f;
                        $("div#container").append(`
                <div class="table-responsive" >
            <div class="div-table" style="margin:0 !important;">
                <div class="div-table-row div-table-row-list">
                    <div class="div-table-cell" style="width: 3%;">${1 + i
                            }</div>
                    <div class="div-table-cell" style="width: 15%;">${res.fichas[i].cota_f
                            }</div> 
                    <div class="div-table-cell" style="width: 8%;">${res.titulo[i]
                            }</div>
                    <div class="div-table-cell" style="width: 8%;">${res.autor[i]
                            }</div>
                             <div class="div-table-cell"  style="width: 10%;">${res.fichas[i].fecha_e
                            } </div>
                    <div class="div-table-cell" id="fecha-d${res.fichas[i].cota_f}" style="width: 10%;">${res.fichas[i].fecha_d
                            }</div>
                    <div class="div-table-cell" style="width: 8%;">
                        <button class="btn btn-info" onclick="ver('${res.fichas[i].cota_f
                            }')"><i class="zmdi zmdi-file-text"></i></button>
                    </div>
                </div>
            </div>
        </div> `);
        if ( res.fichas[i].fecha_d > new Date()) {
             sobresaltarFecha(res, i);
        }
                       
                    }
                } else {
                    $("div#container").html(`
                    <div class="container-fluid">
            <h3 class="text-center all-tittles">No hay préstamos </h3>
        </div>
  
                    `);
                }
            })
            .fail(function (error) {

              manejoErrores(error);

            });


    };
     function seccionCatalogo() {
        var ocultar = document.getElementById("ocultar");
        var seccion = document.getElementById("seccion");
        var explicacion = document.getElementById("explicacion");
        var tabla = document.getElementById("tabla");
        var inicio = document.getElementById("inicio");
        var container = document.getElementById("container");
        var cargando = document.getElementById("cargando");
        var formatoEnLinea = document.getElementById("formato-enlinea");
        var busquedaC = document.getElementById("busquedaC");
        var accordion = document.getElementById("accordion");
        var formatoEnLineaDos = document.getElementById("formato-enlinea-dos");
    
        $("#limpiarButton2").click();
        formatoEnLineaDos.style.display = 'block';
        
        accordion.style.display = 'none';
        var isChecked = ocultar.checked;
        if (isChecked) {
            ocultar.click();
        }

        seccion.innerHTML = `<div class="page-header">
        <h1 class="all-tittles">UNEXPO SBDIP <small>Catálogo</small></h1>
      </div>`;
        explicacion.innerHTML = `
        <div class="row">

<div class="col-xs-12 col-sm-4 col-md-3">
  <img src="/assets/icons/busqueda.ico" alt="pdf" class="img-responsive center-box" style="max-width: 110px;">
</div>
<div class="col-xs-12 col-sm-8 col-md-8 text-justify lead">
  Bienvenido en esta sección podrás ver y leer dependiendo del tipo de suscripción que tengas activa.
</div>
</div>`;
        busquedaC.style.display = 'none';
        formatoEnLinea.style.display = 'none';
        inicio.style.display = 'none';
        cargando.innerHTML = '';
        container.innerHTML = '';
        explicacion.style.display = 'block';
    
       
    }
  
    function seccionPreguntas() {
        $("div#cargando").html('');
        $("form#formato-enlinea-dos").hide();
        $("div#enlaces").hide();
        $("div#seccion").html(` 
            <div class="page-header">
        <h1 class="all-tittles">UNEXPO SBDIP <small>Preguntas frecuentes</small></h1>
      </div>`);
        $("div#explicacion").hide();
        $("form#formato-enlinea").hide();
        $("div#busquedaC").hide();
        $("div#inicio").hide();
        $("div#accordion").show();
        $("div#container").hide();
        mostrarPreguntas();
    }

</script>
<body>
    <div id="myModal" class="modal fade">
        <div class="modal-dialog modal-sm modal-recarga">
          <div class="modal-content" style="background-color: transparent">
            <div id="modal-contenido">
              <br />
              <p class="text-center" id="modal-p-center">
                <img src="/assets/gif/loading-22.gif" width="100" height="100" />
              </p>
            </div>
          </div>
        </div>
      </div>
      <div id="myModal2" class="modal fade">
        <div class="modal-dialog">
          <div class="modal-content">
            <div class="modal-header">
              <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
            </div>
            <div id="modal-body-2" class="modal-body">
    
            </div>
          </div>
        </div>
      </div>
    <div id="myModal4" class="modal fade">
        <div class="modal-dialog">
            <div class="container-fluid">
                <div class="modal-content">
                    <div class="modal-header-sm" style="background:rgb(45, 101, 206);">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                        <h4 class="modal-title" id="myLabel"
                            style="font-size: 25px; font-weight:900; text-align: center; color: white;">Modal title</h4>
                    </div>
                    <div class="modal-body" id="modal-body-4">






                    </div>

                </div>



            </div>

        </div>
    </div>
    <div id="myModal6" class="modal fade">
        <div class="modal-dialog">
            <div class="container-fluid">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    </div>
                    <div>
                        <p class="text-center" id="modal-p-center6">Se ha reservado exitosamente</p>

                        


                    </div>

                </div>



            </div>

        </div>
    </div>
    <div id="myModal3" class="modal fade">
        <div class="modal-dialog">
            <div class="container-fluid">
                <div class="modal-content">
                    <div class="modal-header">
                        <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    </div>
                    <div>
                        <p id="modal-p-center3" class="text-center">Has llegado al límite de libros permitidos para reservar</p>




                    </div>

                </div>



            </div>

        </div>
    </div>
    <div id="myModal7" class="modal fade">
        <div class="modal-dialog">
            <div class="container-fluid">
                <div class="modal-content">
                    <div>
                        <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                                aria-hidden="true">&times;</span></button>
                        <!--  <h4 class="modal-title" id="myModalLabel">Modal title</h4>-->
                    </div>
                    <div>
                        <iframe id="pdfdoc" height="400" width="100%" src='' ></iframe>


                    </div>

                </div>



            </div>

        </div>
    </div>
   <div id="myModal5" class="modal fade">
    <div class="modal-dialog">
      <div class="container-fluid">
        <div class="modal-content">
          <div>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                aria-hidden="true">&times;</span></button>
             </div>
          <div>
            <iframe id="pdfdoc" height="400" width="100%" src=''></iframe>


          </div>

        </div>



      </div>

    </div>
  </div>
  <div id="myModal8" class="modal fullscreen-modal fade">
    <div class="modal-dialog">
      <div class="container-fluid">
        <div class="modal-content">
          <div>
            <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span
                aria-hidden="true">&times;</span></button>
             </div>
          <div class="modal-body">
            <br>
            <br>
            <br>
            <h4 class="modal-title" 
                            style="font-size: 25px; font-weight:900; text-align: center; color: rgb(48, 35, 231);">Datos bancarios para el pago</h4>
            <p class="text-center">Pulsa en la imagen para verla mejor</p>
            <ul id="jqhtml" >
            
    <li><img id="imagenC"  data-original="/assets/img/tibet-1.jpg" src="/assets/img/tibet-1.jpg" alt="Datos de pago"></li>
  </ul>
  <br>
 <p class="text-center" id="botonSolicitar"></p>
            <br>
            <br><br>
            <br>
            <br><br>
            <br>
            <br><br>
            <br>
            <br>
          </div>
          
 
          
          
          

        </div>



      </div>

    </div>
  </div>
    <div id="myModalError" class="modal fade">
        <div class="modal-dialog">
          <div class="container-fluid">
            <div class="modal-content">
              <div class="modal-header">
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">
                  &times;
                </button>
              </div>
              <div id="modal-cuerpo">
    
    
    
    
              </div>
            </div>
    
          </div>
        </div>
      </div>
     
    <%- include ("partes/navegacionUsuario") %>
   

    <div class="content-page-container full-reset custom-scroll-containers">
        <%- include ("partes/navegacionSuperiorUsuario") %>

        <script src="/js/viewer.min.js"></script>
        <script>
        var viewer = new Viewer(document.getElementById('jqhtml'), {
          url: 'data-original'
        });
       
       </script>

        <div class="container" id="seccion" style="margin: 0%;">
            <div class="page-header">
                <h1 class="all-tittles">
                    UNEXPO DIP <small>Inicio</small>
                </h1>
            </div>
        </div>
        <div class="container-fluid" id="enlaces">
        </div>
        <div class="container-fluid" id="explicacion" style="margin: 0%;">
        </div>
    

     <div class="container-fluid" id="tabla">    
        <div class="container-fluid" id="inicio">
          
            
    
            <div id="cuadronot">
    
    
    
            </div>
    
          </div>


            <div class="page-header" style="border: none; margin: 0%;" id="busquedaC">
                <h2 class="text-center" style="background-color:rgb(217, 217, 226) ;">¿Buscas un libro en particular?
                </h2>
                <div class="group-material">
                    <p class="text-center"> <input onchange="ocultarCampos(this)" id="ocultar" name="ocultar"
                            type="checkbox" value="1" class="tooltips-general"
                            title="no, quiero ver todos los libros">No, quiero ver todos los libros
                    </p>
                </div>
            </div>
            <br>
            <div class="container-fluid">
                <form class="form-inline" style="text-align:center; " id="formato-enlinea" autocomplete="off">
                  <div class="row justify-content-md-center">
                    <div class="row">
                                  <div class="col-sm-4 col-md-3">
                      <input id="cota_unica" name="cota" type="text" class="tooltips-general material-control"
                        pattern="(^([a-zA-Zá-ú0-9]{1,})(_)?([a-zA-Zá-ú0-9]{1,})$)|^([a-zA-Zá-ú0-9]{1,})$" placeholder="Cota"
                        maxlength="25" data-toggle="tooltip" data-placement="top" title="Ej. cota_1 Sin espacios">
                      <label>Cota</label>
                    </div>
                    <div class="col-sm-4 col-md-3">
                      <select  id="suscription_unico" name="suscription"
                      class="tooltips-general material-control" data-toggle="tooltip" data-placement="top"
                      title="Elige la categoría del libro">
                      <option disabled="" selected="">Suscripción</option>
                      <option>Basica</option>
                      <option>Estandar</option>
                      <option>Premium</option>
                      </select>
                    </div>
                    <div class="col-sm-4 col-md-3">
                      <select  id="type_unico" name="type"
                      class="tooltips-general material-control" data-toggle="tooltip" data-placement="top"
                      title="Elige la categoría del libro">
                      <option disabled="" selected="">Categoría</option>
                      <option>Ciencia</option>
                      <option>Humanidades</option>
                      <option>Investigación</option>
                      </select>
                    </div>
                    <div class="col-sm-4 col-md-3">
                      <select  id="core_unico" name="core" 
                          class="tooltips-general material-control" data-toggle="tooltip" data-placement="top"
                          title="Elige el nucleo">
                          <option disabled="" selected="">Núcleo</option>
                          <option>charallave</option>
                          <option>carora</option>
                          <option>caracas</option>
      
                        </select>
                    </div> 
                    </div>
                    <div class="row">
                      <div class="col-sm-4 col-md-3">
                       <select  id="format_unico" name="format" 
                          class="tooltips-general material-control" data-toggle="tooltip" data-placement="top"
                          title="Elige el nucleo">
                          <option disabled="" selected="">Formato</option>
                          <option>PDF</option>
                          <option>Solo en fisico</option>
      
                        </select>
                    </div>
                    <div class="col-sm-4 col-md-3">
                      <input id="title_unico" name="title" type="text" class="tooltips-general material-control"
                      placeholder="Título" pattern="[a-zA-Zá-ú ]{1,200}"
                      maxlength="200" data-toggle="tooltip" data-placement="top"
                      title="Título del libro">
                    <label>Título</label>
                    </div>
      
                    <div class="col-sm-4 col-md-3">
                      <input name="creator" type="text" id="creator_unico" class="tooltips-general material-control"
                      placeholder="Autor" pattern="[a-zA-Zá-ú ]{1,100}"
                      maxlength="100" data-toggle="tooltip" data-placement="top"
                      title="Autor del libro">
                    <label>Autor</label>
                     
                    </div>
      
                    <div class="col-sm-4 col-md-3">
                      <input name="contributor" type="text" id="contributor_unico" class="tooltips-general material-control"
                        placeholder="Colaboradores" pattern="[a-zA-Zá-ú ]{1,100}"
                        maxlength="100" data-toggle="tooltip" data-placement="top"
                        title="Colaboradores">
                      <label>Colaborador</label>
                    </div>
                    </div>
                    <div class="row">
                      <div class="col-sm-4 col-md-3">
                        <input id="rights_unico" name="rights" type="text" class="material-control tooltips-general"
                        placeholder="Derechos" pattern="[a-zA-Zá-ú ]{1,100}"
                        maxlength="100" data-toggle="tooltip" data-placement="top" title="Derechos del material">
                      <label>Derechos del material</label>
                      </div>
                      
                    <div class="col-sm-4 col-md-3">
                      <input id="publisher_unico" name="publisher" type="text" class="material-control tooltips-general"
                          placeholder="Editorial"  pattern="[a-zA-Zá-ú ]{1,100}"
                          maxlength="100" data-toggle="tooltip" data-placement="top" title="Editorial">
                        <label>Editorial</label>
                    </div>
                    
                    <div class="col-sm-4 col-md-3">
                      <input id="source_unico" name="source" type="text" class="material-control tooltips-general"
                          placeholder="Fuente"  pattern="[a-zA-Zá-ú ]{1,100}"
                          maxlength="100" data-toggle="tooltip" data-placement="top" title="Fuente del material">
                        <label>Fuente</label>
                    </div>
                    <div class="col-sm-4 col-md-3">
                      <input id="language_unico" name="language" type="text" class="material-control tooltips-general"
                          placeholder="Lenguaje"  pattern="[a-zA-Zá-ú ]{1,100}"
                          maxlength="100" data-toggle="tooltip" data-placement="top" title="Lenguaje del material">
                    
                        <label>Lenguaje</label>
                    </div>
                    </div>
                    <div class="row">
                      <div class="col-sm-4 col-md-3">
                      <input id="coverage_unico" name="coverage" type="text" class="material-control tooltips-general"
                          placeholder="Ámbito"  pattern="[a-zA-Zá-ú ]{1,100}"
                          maxlength="100" data-toggle="tooltip" data-placement="top" title="Ámbito del contenido">
                        <label>Ámbito del contenido</label>
                    </div>
      
                    <div class="col-sm-4 col-md-3">
                   <input id="relation_unico" name="relation" type="text" class="material-control tooltips-general"
                    placeholder="Recurso relacionado"  pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Referencia a otro recurso">
                  <label>Referencia</label>
                  </div>
                    <div class="col-sm-4 col-md-3">
                      <input id="subject_unico" name="subject" type="text" class="material-control tooltips-general"
                          placeholder="Palabras relaionadas"  pattern="[a-zA-Zá-ú ]{1,100}"
                          maxlength="100" data-toggle="tooltip" data-placement="top" title="Palabras relacionadas">
                        <label>Palabras relacionadas</label>
                    </div>
                    <div class="col-sm-4 col-md-3">
                      <input id="description_unico" name="description" type="text" class="material-control tooltips-general"
                          placeholder="Descripción"  pattern="[a-zA-Zá-ú ]{1,100}"
                          maxlength="100" data-toggle="tooltip" data-placement="top" title="Descripción">
                        <label>Descripción</label>
                    </div> 
                    </div>
                   <div class="row">
                      
                    <div class="col-sm-4 col-md-3">
                      <input id="date_unico" name="date" type="date" class="material-control tooltips-general"
                        data-toggle="tooltip" data-placement="top" title="Fecha de publicación"  placeholder="Fecha" >
                   <label>Fecha</label>
                    </div>
                    <div class="col-sm-4 col-md-3">
      
                      <button id="limpiarButton" style="margin-block: 10px;" type="reset"
                        class="btn btn-light">Limpiar</button>
                    </div>
                   
                   </div>
                   
                  </div>
                </form>
              </div>
              <div class="container-fluid">
                <form class="form-inline" style="text-align:center; " id="formato-enlinea-dos" autocomplete="off">
                  <div class="row justify-content-md-center">
                    <div class="row">
                                  <div class="col-sm-4 col-md-3">
                      <input id="cota" name="cota" type="text" class="tooltips-general material-control"
                        pattern="(^([a-zA-Zá-ú0-9]{1,})(_)?([a-zA-Zá-ú0-9]{1,})$)|^([a-zA-Zá-ú0-9]{1,})$" placeholder="Cota"
                        maxlength="25" data-toggle="tooltip" data-placement="top" title="Ej. cota_1 Sin espacios">
                      <label>Cota</label>
                    </div>
                    <div class="col-sm-4 col-md-3">
                      <select  id="suscription" name="suscription"
                      class="tooltips-general material-control" data-toggle="tooltip" data-placement="top"
                      title="Elige la categoría del libro">
                      <option disabled="" selected="">Suscripción</option>
                      <option>Basica</option>
                      <option>Estandar</option>
                      <option>Premium</option>
                      </select>
                    </div>
                    <div class="col-sm-4 col-md-3">
                      <select  id="type" name="type"
                      class="tooltips-general material-control" data-toggle="tooltip" data-placement="top"
                      title="Elige la categoría del libro" onclick="categorias('type')" >
                      <option disabled="" selected="">Categoría</option>
                      </select>
                    </div>
                    <div class="col-sm-4 col-md-3">
                      <select  id="core" name="core" 
                          class="tooltips-general material-control" data-toggle="tooltip" data-placement="top"
                          title="Elige el nucleo">
                          <option disabled="" selected="">Núcleo</option>
                          <option>charallave</option>
                          <option>carora</option>
                          <option>caracas</option>
      
                        </select>
                    </div> 
                    </div>
                    <div class="row">
                      <div class="col-sm-4 col-md-3">
                       <select  id="format" name="format" 
                          class="tooltips-general material-control" data-toggle="tooltip" data-placement="top"
                          title="Elige el nucleo">
                          <option disabled="" selected="">Formato</option>
                          <option>PDF</option>
                          <option>Solo en fisico</option>
      
                        </select>
                    </div>
                    <div class="col-sm-4 col-md-3">
                      <input id="title" name="title" type="text" class="tooltips-general material-control"
                      placeholder="Título" pattern="[a-zA-Zá-ú ]{1,200}"
                      maxlength="200" data-toggle="tooltip" data-placement="top"
                      title="Título del libro">
                    <label>Título</label>
                    </div>
      
                    <div class="col-sm-4 col-md-3">
                      <input name="creator" type="text" id="creator" class="tooltips-general material-control"
                      placeholder="Autor" pattern="[a-zA-Zá-ú ]{1,100}"
                      maxlength="100" data-toggle="tooltip" data-placement="top"
                      title="Autor del libro">
                    <label>Autor</label>
                     
                    </div>
      
                    <div class="col-sm-4 col-md-3">
                      <input name="contributor" type="text" id="contributor" class="tooltips-general material-control"
                        placeholder="Colaboradores" pattern="[a-zA-Zá-ú ]{1,100}"
                        maxlength="100" data-toggle="tooltip" data-placement="top"
                        title="Colaboradores">
                      <label>Colaborador</label>
                    </div>
                    </div>
                    <div class="row">
                      <div class="col-sm-4 col-md-3">
                        <input id="rights" name="rights" type="text" class="material-control tooltips-general"
                        placeholder="Derechos" pattern="[a-zA-Zá-ú ]{1,100}"
                        maxlength="100" data-toggle="tooltip" data-placement="top" title="Derechos del material">
                      <label>Derechos del material</label>
                      </div>
                      
                    <div class="col-sm-4 col-md-3">
                      <input id="publisher" name="publisher" type="text" class="material-control tooltips-general"
                          placeholder="Editorial"  pattern="[a-zA-Zá-ú ]{1,100}"
                          maxlength="100" data-toggle="tooltip" data-placement="top" title="Editorial">
                        <label>Editorial</label>
                    </div>
                    
                    <div class="col-sm-4 col-md-3">
                      <input id="source" name="source" type="text" class="material-control tooltips-general"
                          placeholder="Fuente"  pattern="[a-zA-Zá-ú ]{1,100}"
                          maxlength="100" data-toggle="tooltip" data-placement="top" title="Fuente del material">
                        <label>Fuente</label>
                    </div>
                    <div class="col-sm-4 col-md-3">
                      <input id="language" name="language" type="text" class="material-control tooltips-general"
                          placeholder="Lenguaje"  pattern="[a-zA-Zá-ú ]{1,100}"
                          maxlength="100" data-toggle="tooltip" data-placement="top" title="Lenguaje del material">
                    
                        <label>Lenguaje</label>
                    </div>
                    </div>
                    <div class="row">
                      <div class="col-sm-4 col-md-3">
                      <input id="coverage" name="coverage" type="text" class="material-control tooltips-general"
                          placeholder="Ámbito"  pattern="[a-zA-Zá-ú ]{1,100}"
                          maxlength="100" data-toggle="tooltip" data-placement="top" title="Ámbito del contenido">
                        <label>Ámbito del contenido</label>
                    </div>
      
                    <div class="col-sm-4 col-md-3">
                   <input id="relation" name="relation" type="text" class="material-control tooltips-general"
                    placeholder="Recurso relacionado"  pattern="[a-zA-Zá-ú ]{1,100}"
                    maxlength="100" data-toggle="tooltip" data-placement="top" title="Referencia a otro recurso">
                  <label>Referencia</label>
                  </div>
                    <div class="col-sm-4 col-md-3">
                      <input id="subject" name="subject" type="text" class="material-control tooltips-general"
                          placeholder="Palabras relaionadas"  pattern="[a-zA-Zá-ú ]{1,100}"
                          maxlength="100" data-toggle="tooltip" data-placement="top" title="Palabras relacionadas">
                        <label>Palabras relacionadas</label>
                    </div>
                    <div class="col-sm-4 col-md-3">
                      <input id="description" name="description" type="text" class="material-control tooltips-general"
                          placeholder="Descripción"  pattern="[a-zA-Zá-ú ]{1,100}"
                          maxlength="100" data-toggle="tooltip" data-placement="top" title="Descripción">
                        <label>Descripción</label>
                    </div> 
                    </div>
                   <div class="row">
                      
                    <div class="col-sm-4 col-md-3">
                      <input id="date" name="date" type="date" class="material-control tooltips-general"
                        data-toggle="tooltip" data-placement="top" title="Fecha de publicación"  placeholder="Fecha" >
                   <label>Fecha</label>
                    </div>
                    <div class="col-sm-4 col-md-3">
      
                      <button id="limpiarButton2" style="margin-block: 10px;" type="reset"
                        class="btn btn-light">Limpiar</button>
                    </div>
                   
                   </div>
                   
                  </div>
                </form>
              </div>
        
            <div class="container-fluid">
                <div class="panel-group" id="accordion" role="tablist" aria-multiselectable="true">

                </div>
            </div>
           <div id="cargando"></div>
            <div class="container-fluid" id="container"> </div> 
    </div>
        <%- include ("partes/piePagina") %>
    </div>


</body>

</html>